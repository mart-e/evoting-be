/* Filename            : MKCONTEN.P                                     */

{chklevel.i 1}

/************************************************************************/
/*                                                                      */
/*   LOCAL VARIABLES                                                    */
/*                                                                      */
/************************************************************************/
DEF VAR filename AS C FORMAT "x(15)" NO-UNDO.
DEF VAR name     AS C FORMAT "x(50)" NO-UNDO.
DEF VAR i        AS i                NO-UNDO.

/************************************************************************/
/*                                                                      */
/*   START PROCEDURE                                                    */
/*                                                                      */
/************************************************************************/
IF PDBNAME(1) BEGINS "D:\"
THEN filename = "D:\CONTENTS".
ELSE filename = "C:\CONTENTS".
filename = filename + "," + ramdrive + "CONTENTS".

FIND FIRST setup NO-LOCK NO-ERROR.
IF AVAILABLE setup
THEN DO:
    name = setup.sys-type +
           setup.org-type +
           setup.areaname +
           STRING(setup.orginator,"999").

    DO i = 1 TO NUM-ENTRIES(filename):
        call C_ATTRIB VALUE(ENTRY(i,filename)) 0.
        OUTPUT TO VALUE(ENTRY(i,filename)).
        PUT UNFORMATTED name.
        OUTPUT CLOSE.
        call C_ATTRIB VALUE(ENTRY(i,filename)) 3.
    END.    
    call ADDTOLOG PROGRAM-NAME(1) VALUE(name + (IF CAPS(DBNAME)          <> "ELECT" AND
                                                SUBSTRING(DBNAME,1,3) <> "C:\"
                                                THEN "(" + SUBSTRING(DBNAME,1,2) + ")"
                                                ELSE " ")) 0.
END.
ELSE DO:
    CALL C_DEL VALUE(filename).
END.

{return.i}
/* eof */