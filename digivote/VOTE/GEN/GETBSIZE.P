/************************************************************************/
/*                                                                      */
/* Filename            : GETBSIZE.P                                     */
/*                                                                      */
/* Get size (nbr of records) of a file                                  */
/*                                                                      */
/************************************************************************/

{chklevel.i 1}

/************************************************************************/
/*                                                                      */
/*        INPUT PARAMETERS                                              */
/*                                                                      */
/************************************************************************/
DEF INPUT PARAM fileName          AS C FORMAT "x(50)"             NO-UNDO.

/************************************************************************/
/*                                                                      */
/*        OUTPUT PARAMETERS                                             */
/*                                                                      */
/************************************************************************/
DEF OUTPUT PARAM records          AS I                            NO-UNDO.

/************************************************************************/
/*                                                                      */
/*        LOCAL VARIABLES                                               */
/*                                                                      */
/************************************************************************/
DEF VAR contents                  AS C FORMAT "x(78)"             NO-UNDO.

/************************************************************************/
/*                                                                      */
/*        START PROCEDURE                                               */
/*                                                                      */
/************************************************************************/
records = -1.

call C_TSTFN fileName.
IF fileok = 0 
THEN DO:
    call ADDTOLOG PROGRAM-NAME(1) VALUE(fileName + " not found !") 1.
    {return.i}
END.
INPUT FROM VALUE(fileName) NO-ECHO.
records = 0.
REPEAT:
    SET contents.
    records = records + 1.
END.
INPUT CLOSE.

{return.i}
/* eof */