.head 0 +  Application Description: SQLWindows version 5.0 starter application
.head 1 -  Outline Version - 4.0.31
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000D50000 002C000000020000 0003000000FFFFFF FFFFFFFFFFFCFFFF
0040: FFE9FFFFFF000000 00000000008C0200 00B9020000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000
.enddata
.head 2 -  Outline Window State: Maximized
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600020000001B00 0000000084003200 0000AE2C282A0500 1D00FFFF4D61696E
0020: 0020000000040007 00A12C1500264B3D 2A00003400FFFF43 6F6E7374616E7473
0040: 00
.enddata
.data VIEWSIZE
0000: 4100
.enddata
.head 3 -  Left: -0.013"
.head 3 -  Top: 0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: D4180909B80B1A00
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left: 4.15"
.head 3 -  Top: 1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left: 0.575"
.head 3 -  Top: 0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left: 6.4"
.head 3 -  Top: 0.729"
.head 2 -  Fully Qualified External References? No
.head 2 -  Reject Multiple Window Instances? Yes
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  File Include: registry.APL
.head 2 -  ! File Include: cstste.apl
.head 2 -  ! File Include: cstwim.apl
.head 2 -  ! File Include: vtstr.apl
.head 2 -  File Include: shell.apl
.head 2 -  ! File Include: vtwin.apl
.head 2 -  ! File Include: vtmisc.apl
.head 2 -  ! File Include: cstruct.apl
.head 2 -  ! File Include: cstste.apl
.head 2 -  ! File Include: cstwim.apl
.head 2 -  ! File Include: vtwin.apl
.head 2 -  ! File Include: vtmisc.apl
.head 2 -  ! File Include: cstructl.apl
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: System Default
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: System Default
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: System Default
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: System Default
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 2 +  External Functions
.head 3 +  Library name: DllDph32.dll
.head 4 -  ThreadSafe: No
.head 4 +  ! Function: FindWindowDph
.head 5 -  Description: 
.head 5 -  Export Ordinal: 1
.head 5 +  Returns 
.head 6 -  Window Handle: HWND
.head 5 +  Parameters 
.head 6 -  String: LPSTR
.head 4 +  Function: FindWin
.head 5 -  Description:
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Window Handle: HWND
.head 5 +  Parameters
.head 6 -  String: LPSTR
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 4 -  String: cWinWordPrgmName			= 'OpusApp'
.head 4 -  String: cExcelPrgmName			= 'XLMain'
.head 4 -  String: csWinWordExe			= "Applications\\WINWORD.EXE\\shell\\New\\command"
.head 4 -  ! /##### LS : 17/04/2003
.head 4 -  String: csWWWordDocument			= 'Word.Document'
.head 4 -  String: csWWCurVer			= '\\CurVer'
.head 4 -  String: csWWShellOpenCommand		= '\\Shell\\Open\\command'
.head 4 -  String: csWWShellOpenDdeexecApplication	= '\\Shell\\Open\\ddeexec\\Application'
.head 4 -  String: csWWShellOpenDdeexecTopic		= '\\Shell\\Open\\ddeexec\\Topic'
.head 4 -  String: csWWWinWordApplication		= 'WinWord'
.head 4 -  String: csWWWinWordTopic			= 'System'
.head 4 -  ! \##### LS : 17/04/2003
.head 3 +  User
.head 3 -  Enumerations
.head 2 -  Resources
.head 2 +  Variables
.data RESOURCE 0 0 1 629177905
0000: 5E0000002C000000 0000000000000000 020000030000004A 0000001004000000
0020: 020000FE00FF834E 00000004B5000200 FFFF605200000004 00ED0200FF3F
.enddata
.head 3 -  String: gsWinWordApplication
.head 3 -  String: gsWinWordTopic
.head 2 +  Internal Functions
.head 3 +  Function: VerifPresenceWord
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return FindWindowDph( cWinWordPrgmName ) != hWndNULL
.head 3 +  Function: HandleWinWord
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Window Handle:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return FindWindowDph( cWinWordPrgmName ) 
.head 3 +  Function: LoadWinword
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: lnKey
.head 5 -  Number: i
.head 5 -  String: s1
.head 5 -  String: s
.head 4 +  Actions
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, csWinWordExe, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  Set s = SalStrTrimX( s )
.head 5 +  If SalStrLeftX( s, 1 ) = '"'
.head 6 -  Set s = SalStrMidX( s, 1, SalStrLength( s ) )
.head 6 +  While SalStrRightX( s, 1 ) != '"' 
.head 7 -  Set s = SalStrLeftX( s, SalStrLength( s ) - 1 )
.head 6 -  Set s = SalStrLeftX( s, SalStrLength( s ) - 1 )
.head 5 -  Call ShellExecuteOpen( hWndNULL, s, cRegVide, cRegVide, SW_MINIMIZE )
.head 5 -  ! Call ShellExecuteOpen( hWndNULL, "command.com /c ", "start " || s, cRegVide, 1 )
.head 3 +  Function: VerifPresenceExcel
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return FindWindowDph( cExcelPrgmName ) != hWndNULL
.head 3 +  ! Function: WinWordViewRTF
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Window Handle: pwhDDE
.head 5 -  String: psFileName
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: s
.head 5 -  Number: lnKey
.head 5 -  Number: i
.head 5 -  String: sBase
.head 5 -  String: sPrgmPath
.head 5 -  String: sApplication
.head 5 -  String: sTopic
.head 5 -  String: sPrgmOpen
.head 5 -  String: sPrgmClose
.head 5 -  String: sRequete
.head 4 +  Actions 
.head 5 -  Set s = '.rtf'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  ! Set s = '\\' || s || '\\CLSID'
.head 5 -  Set s = s || '\\CLSID'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  Set s = 'CLSID\\' || s || '\\VersionIndependentProgId'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  Set s = s || '\\CurVer'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  Set sBase = s || '\\'
.head 5 -  Set s = sBase || 'protocol\\stdfileediting\\server'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 6 -  Set sPrgmPath = s
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  Set sBase = sBase || 'shell\\open\\'
.head 5 -  Set s = sBase || 'ddeexec'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 6 -  Set sPrgmOpen = s
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  Set sBase = sBase || 'ddeexec\\'
.head 5 -  Set s = sBase || 'Application'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 6 -  Set sApplication = s
.head 6 -  Set gsWinWordApplication = sApplication
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  Set s = sBase || 'Topic'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 6 -  Set sTopic = s
.head 6 -  Set gsWinWordTopic = sTopic
.head 5 -  Call RegCloseKey( lnKey )
.head 5 +  If not VerifPresenceWord(  )
.head 6 -  Call SalLoadApp ( sPrgmPath, '' )
.head 5 -  Set s = VisStrSubstitute( sPrgmOpen, '\%1', psFileName )
.head 5 -  Set s = VisStrSubstitute( s, '("', '( "' )
.head 5 -  Set s = VisStrSubstitute( s, '")', '" )' )
.head 5 -  ! Set s = VisStrSubstitute( s, "''", '"' )
.head 5 +  ! If SalStrLeftX( s, 5 ) = '[REM '
.head 6 +  While SalStrLeftX( s, 1 ) != ']'
.head 7 -  Set s = SalStrRightX( s, SalStrLength( s ) - 1 )
.head 6 -  Set s = SalStrRightX( s, SalStrLength( s ) - 1 )
.head 5 -  ! Set s = SalStrRightX( s, SalStrLength( s ) - 17 )
.head 5 -  Call SalDDESendExecute ( pwhDDE, sApplication, sTopic, '', 1000, s )
.head 5 -  ! Call SalDDESendExecute ( pwhDDE, sApplication, sTopic, '', 1000, '[FileOpen( "' || psFileName || '")]'  )
.head 3 +  Function: WinWordPrintRTF
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: pwhDDE
.head 5 -  String: psFileName
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: s
.head 5 -  Number: lnKey
.head 5 -  Number: i
.head 5 -  String: sBase
.head 5 -  String: sPrgmPath
.head 5 -  String: sApplication
.head 5 -  String: sTopic
.head 5 -  String: sPrgmOpen
.head 5 -  String: sPrgmClose
.head 5 -  String: sRequete
.head 5 -  String: sPrgm
.head 4 +  Actions
.head 5 -  ! Recherche de la version du RTF
.head 5 -  Set s = '.RTF'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 6 -  Set sPrgm = s || '\\'
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  !
.head 5 -  !
.head 5 -  ! Recherche du programme
.head 5 -  Set s = sPrgm || 'CLSID'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  Set s = 'CLSID\\' || s || '\\ProgID'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  Set sBase = s || '\\'
.head 5 -  Set s = sBase || 'protocol\\stdfileediting\\server'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 6 -  Set sPrgmPath = s
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  !
.head 5 -  !
.head 5 -  ! Recherche des commandes DDE
.head 5 -  Set sBase = sPrgm || 'shell\\print\\'
.head 5 -  Set s = sBase || 'ddeexec'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 6 -  Set sPrgmOpen = s
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  Set sBase = sBase || 'ddeexec\\'
.head 5 -  Set s = sBase || 'Application'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 6 -  Set sApplication = s
.head 6 -  Set gsWinWordApplication = sApplication
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  Set s = sBase || 'Topic'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 6 -  Set sTopic = s
.head 6 -  Set gsWinWordApplication = sApplication
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  Set s = sBase || 'ifexec'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 6 -  Set sPrgmClose = s
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  Set sRequete = '[FileOpen( "%1" )][FilePrint 0]'
.head 5 +  If VerifPresenceWord(  )
.head 6 -  Set sRequete = sRequete || '[DocClose 2]'
.head 6 -  Set sRequete = sPrgmOpen
.head 5 +  Else
.head 6 -  Call SalLoadApp ( sPrgmPath, '' )
.head 6 -  Set sRequete = sRequete || '[FileExit 2]'
.head 6 -  Set sRequete = sPrgmClose
.head 5 -  Set s = sRequete
.head 5 -  Set s = VisStrSubstitute( s, '\%1', psFileName )
.head 5 +  ! If SalStrLeftX( s, 5 ) = '[REM '
.head 6 +  While SalStrLeftX( s, 1 ) != ']'
.head 7 -  Set s = SalStrRightX( s, SalStrLength( s ) - 1 )
.head 6 -  Set s = SalStrRightX( s, SalStrLength( s ) - 1 )
.head 5 -  ! Set s = VisStrSubstitute( s, "''", '"' )
.head 5 -  ! Set s = SalStrRightX( s, SalStrLength( s ) - 17 )
.head 5 -  Call SalDDESendExecute ( pwhDDE, sApplication, sTopic, '', 1000, s )
.head 5 -  ! Call SalDDESendExecute ( pwhDDE, sApplication, sTopic, '', 1000, sRequete  )
.head 3 +  Function: WinWordViewRTF
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: pwhDDE
.head 5 -  String: psFileName
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: s
.head 5 -  Number: lnKey
.head 5 -  Number: i
.head 5 -  String: sBase
.head 5 -  String: sPrgmPath
.head 5 -  String: sApplication
.head 5 -  String: sTopic
.head 5 -  String: sPrgmOpen
.head 5 -  String: sPrgmClose
.head 5 -  String: sRequete
.head 5 -  String: sPrgm
.head 4 +  Actions
.head 5 -  ! Recherche de la version du RTF
.head 5 -  Set s = '.RTF'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 6 -  Set sPrgm = s || '\\'
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  !
.head 5 -  !
.head 5 -  ! Recherche du programme
.head 5 -  Set s = sPrgm || 'CLSID'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  Set s = 'CLSID\\' || s || '\\ProgID'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  Set sBase = s || '\\'
.head 5 -  Set s = sBase || 'protocol\\stdfileediting\\server'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 6 -  Set sPrgmPath = s
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  !
.head 5 -  !
.head 5 -  ! Recherche des commandes DDE
.head 5 -  Set sBase = sPrgm || 'shell\\open\\'
.head 5 -  Set s = sBase || 'ddeexec'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 6 -  Set sPrgmOpen = s
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  Set sBase = sBase || 'ddeexec\\'
.head 5 -  Set s = sBase || 'Application'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 6 -  Set sApplication = s
.head 6 -  Set gsWinWordApplication = sApplication
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  Set s = sBase || 'Topic'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 6 -  Set sTopic = s
.head 6 -  Set gsWinWordApplication = sApplication
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  ! Set s = sBase || 'ifexec'
.head 5 -  ! Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  ! Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  ! If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 6 -  Set sPrgmClose = s
.head 5 -  ! Call RegCloseKey( lnKey )
.head 5 -  Set sRequete = sPrgmOpen
.head 5 +  If VerifPresenceWord(  )
.head 6 -  Set sRequete = sRequete || '[DocClose 2]'
.head 6 -  Set sRequete = sPrgmOpen
.head 5 +  Else
.head 6 -  Call SalLoadApp ( sPrgmPath, '' )
.head 6 -  Set sRequete = sRequete || '[FileExit 2]'
.head 6 -  Set sRequete = sPrgmOpen
.head 5 -  Set s = sRequete
.head 5 -  Set s = VisStrSubstitute( s, '\%1', psFileName )
.head 5 +  ! If SalStrLeftX( s, 5 ) = '[REM '
.head 6 +  While SalStrLeftX( s, 1 ) != ']'
.head 7 -  Set s = SalStrRightX( s, SalStrLength( s ) - 1 )
.head 6 -  Set s = SalStrRightX( s, SalStrLength( s ) - 1 )
.head 5 -  ! Set s = VisStrSubstitute( s, "''", '"' )
.head 5 -  ! Set s = SalStrRightX( s, SalStrLength( s ) - 17 )
.head 5 -  Call SalDDESendExecute ( pwhDDE, sApplication, sTopic, '', 1000, s )
.head 5 -  ! Call SalDDESendExecute ( pwhDDE, sApplication, sTopic, '', 1000, sRequete  )
.head 3 +  Function: ExcelViewSLK
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: pwhDDE
.head 5 -  String: psFileName
.head 5 -  String: psTopic
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: s
.head 5 -  Number: lnKey
.head 5 -  Number: i
.head 5 -  String: sBase
.head 5 -  String: sPrgmPath
.head 5 -  String: sApplication
.head 5 -  String: sTopic
.head 5 -  String: sPrgmOpen
.head 5 -  String: sPrgmClose
.head 5 -  String: sRequete
.head 5 -  String: sPrgm
.head 4 +  Actions
.head 5 -  ! Recherche de la version du RTF
.head 5 -  Set s = '.SLK'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 6 -  Set sPrgm = s || '\\'
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  !
.head 5 -  !
.head 5 -  ! Recherche du programme
.head 5 -  Set s = sPrgm || 'CLSID'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  Set s = 'CLSID\\' || s || '\\ProgID'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  Set sBase = s || '\\'
.head 5 -  Set s = sBase || 'protocol\\stdfileediting\\server'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 6 -  Set sPrgmPath = s
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  !
.head 5 -  !
.head 5 -  ! Recherche des commandes DDE
.head 5 -  Set sBase = sPrgm || 'shell\\open\\'
.head 5 -  Set s = sBase || 'ddeexec'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 6 -  Set sPrgmOpen = s
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  Set sBase = sBase || 'ddeexec\\'
.head 5 -  Set s = sBase || 'Application'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 6 -  Set sApplication = s
.head 6 -  Set gsWinWordApplication = sApplication
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  Set s = sBase || 'Topic'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 6 -  Set sTopic = s
.head 6 -  ! Set sTopic = 'Classeur1'
.head 6 -  Set sTopic = psTopic
.head 6 -  Set gsWinWordApplication = sApplication
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  ! Set s = sBase || 'ifexec'
.head 5 -  ! Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  ! Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  ! If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 6 -  Set sPrgmClose = s
.head 5 -  ! Call RegCloseKey( lnKey )
.head 5 -  Set sRequete = sPrgmOpen
.head 5 +  If VerifPresenceExcel(  )
.head 6 -  Set sRequete = sRequete || '[DocClose 2]'
.head 6 -  Set sRequete = sPrgmOpen
.head 5 +  Else
.head 6 -  Call SalLoadApp ( sPrgmPath, ' /e' )
.head 6 -  Set sRequete = sRequete || '[FileExit 2]'
.head 6 -  Set sRequete = sPrgmOpen
.head 5 -  Set s = sRequete
.head 5 -  Set s = VisStrSubstitute( s, '\%1', psFileName )
.head 5 +  ! If SalStrLeftX( s, 5 ) = '[REM '
.head 6 +  While SalStrLeftX( s, 1 ) != ']'
.head 7 -  Set s = SalStrRightX( s, SalStrLength( s ) - 1 )
.head 6 -  Set s = SalStrRightX( s, SalStrLength( s ) - 1 )
.head 5 -  ! Set s = VisStrSubstitute( s, "''", '"' )
.head 5 -  ! Set s = SalStrRightX( s, SalStrLength( s ) - 17 )
.head 5 -  Call SalDDESendExecute ( pwhDDE, sApplication, sTopic, '', 1000, s )
.head 5 -  ! Call SalDDESendExecute ( pwhDDE, sApplication, sTopic, '', 1000, sRequete  )
.head 3 +  Function: ExcelViewXLS
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: pwhDDE
.head 5 -  String: psFileName
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: s
.head 5 -  Number: lnKey
.head 5 -  Number: i
.head 5 -  String: sBase
.head 5 -  String: sPrgmPath
.head 5 -  String: sApplication
.head 5 -  String: sTopic
.head 5 -  String: sPrgmOpen
.head 5 -  String: sPrgmClose
.head 5 -  String: sRequete
.head 5 -  String: sPrgm
.head 4 +  Actions
.head 5 -  ! Recherche de la version du RTF
.head 5 -  Set s = '.XLS'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 6 -  Set sPrgm = s || '\\'
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  !
.head 5 -  !
.head 5 -  ! Recherche du programme
.head 5 -  Set s = sPrgm || 'CLSID'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  Set s = 'CLSID\\' || s || '\\ProgID'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  Set sBase = s || '\\'
.head 5 -  Set s = sBase || 'protocol\\stdfileediting\\server'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 6 -  Set sPrgmPath = s
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  !
.head 5 -  !
.head 5 -  ! Recherche des commandes DDE
.head 5 -  Set sBase = sPrgm || 'shell\\open\\'
.head 5 -  Set s = sBase || 'ddeexec'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 6 -  Set sPrgmOpen = s
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  Set sBase = sBase || 'ddeexec\\'
.head 5 -  Set s = sBase || 'Application'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 6 -  Set sApplication = s
.head 6 -  Set gsWinWordApplication = sApplication
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  Set s = sBase || 'Topic'
.head 5 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 6 -  Set sTopic = s
.head 6 -  Set gsWinWordApplication = sApplication
.head 5 -  Call RegCloseKey( lnKey )
.head 5 -  ! Set s = sBase || 'ifexec'
.head 5 -  ! Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s, lnKey )
.head 5 -  ! Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 5 +  ! If i = 0
.head 6 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 6 -  Set i = SalStrLength( s )
.head 6 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 6 -  Set sPrgmClose = s
.head 5 -  ! Call RegCloseKey( lnKey )
.head 5 -  Set sRequete = sPrgmOpen
.head 5 +  If VerifPresenceExcel(  )
.head 6 -  Set sRequete = sRequete || '[DocClose 2]'
.head 6 -  Set sRequete = sPrgmOpen
.head 5 +  Else
.head 6 -  Call SalLoadApp ( sPrgmPath, '' )
.head 6 -  Set sRequete = sRequete || '[FileExit 2]'
.head 6 -  Set sRequete = sPrgmOpen
.head 5 -  Set s = sRequete
.head 5 -  Set s = VisStrSubstitute( s, '\%1', psFileName )
.head 5 +  ! If SalStrLeftX( s, 5 ) = '[REM '
.head 6 +  While SalStrLeftX( s, 1 ) != ']'
.head 7 -  Set s = SalStrRightX( s, SalStrLength( s ) - 1 )
.head 6 -  Set s = SalStrRightX( s, SalStrLength( s ) - 1 )
.head 5 -  ! Set s = VisStrSubstitute( s, "''", '"' )
.head 5 -  ! Set s = SalStrRightX( s, SalStrLength( s ) - 17 )
.head 5 -  Call SalDDESendExecute ( pwhDDE, sApplication, sTopic, '', 1000, s )
.head 5 -  ! Call SalDDESendExecute ( pwhDDE, sApplication, sTopic, '', 1000, sRequete  )
.head 3 -  ! /##### LS : 17/04/2003
.head 3 +  Function: FindAndLoadWinword
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: psDefaut
.head 5 -  Number: pnEtat
.head 4 +  Static Variables
.head 5 -  String: ssPrgm
.head 4 +  Local variables
.head 5 -  Number: lnKey
.head 5 -  Number: i
.head 5 -  String: s1
.head 5 -  String: s
.head 5 -  Window Handle: wh
.head 4 +  Actions
.head 5 -  Set wh = FindWindowDph( cWinWordPrgmName )
.head 5 +  If wh = hWndNULL
.head 6 +  If SalStrLength( ssPrgm ) = 0
.head 7 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, csWWWordDocument || csWWCurVer, lnKey )
.head 7 +  If i = 0
.head 8 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 8 +  If i = 0
.head 9 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 9 -  Set i = SalStrLength( s )
.head 9 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 8 -  Call RegCloseKey( lnKey )
.head 8 -  Set s = SalStrTrimX( s )
.head 8 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s || csWWShellOpenCommand, lnKey )
.head 8 +  If i = 0
.head 9 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 9 +  If i = 0
.head 10 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 10 -  Set i = SalStrLength( s )
.head 10 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 9 -  Call RegCloseKey( lnKey )
.head 9 -  Set s = SalStrTrimX( s )
.head 9 +  If SalStrLeftX( s, 1 ) = '"'
.head 10 -  Set s = SalStrMidX( s, 1, SalStrLength( s ) )
.head 10 +  While SalStrRightX( s, 1 ) != '"' 
.head 11 -  Set s = SalStrLeftX( s, SalStrLength( s ) - 1 )
.head 10 -  Set s = SalStrLeftX( s, SalStrLength( s ) - 1 )
.head 9 -  Set i = SalStrScan( s, '/' )
.head 9 +  If i >= 0 
.head 10 -  Set s = SalStrLeftX( s, i )
.head 8 +  Else
.head 9 -  Set s = psDefaut
.head 8 -  !
.head 8 -  !
.head 7 +  Else
.head 8 -  Set s = psDefaut
.head 7 -  Set ssPrgm = s
.head 6 -  Call ShellExecuteOpen( hWndNULL, ssPrgm, cRegVide, cRegVide, pnEtat )
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  If pnEtat = SW_MAXIMIZE
.head 6 +  Select Case pnEtat
.head 7 +  Case SW_MAXIMIZE
.head 8 -  Call SalBringWindowToTop( wh )
.head 8 -  Call VisWinShow( wh, SHOW_Maximized )
.head 8 -  Break
.head 7 +  Case SW_HIDE
.head 8 -  ! Call SalBringWindowToTop( wh )
.head 8 -  ! Call VisWinShow( wh, SHOW_Hidden )
.head 8 -  ! Break
.head 7 +  Case SW_MINIMIZE
.head 8 -  ! Call SalBringWindowToTop( wh )
.head 8 -  Call VisWinShow( wh, SHOW_Minimized )
.head 8 -  Break
.head 7 +  Default
.head 8 -  Call VisWinShow( wh, SHOW_Normal )
.head 6 -  Return FALSE
.head 5 -  ! Call ShellExecuteOpen( hWndNULL, "command.com /c ", "start " || s, cRegVide, 1 )
.head 3 +  Function: WinwordApplication
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 -  Parameters
.head 4 +  Static Variables
.head 5 -  String: ssVal
.head 4 +  Local variables
.head 5 -  Number: lnKey
.head 5 -  Number: i
.head 5 -  String: s1
.head 5 -  String: s
.head 4 +  Actions
.head 5 +  If SalStrLength( ssVal ) = 0
.head 6 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, csWWWordDocument || csWWCurVer, lnKey )
.head 6 +  If i = 0
.head 7 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 7 +  If i = 0
.head 8 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 8 -  Set i = SalStrLength( s )
.head 8 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 7 -  Call RegCloseKey( lnKey )
.head 7 -  Set s = SalStrTrimX( s )
.head 7 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s || csWWShellOpenDdeexecApplication, lnKey )
.head 7 +  If i = 0
.head 8 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 8 +  If i = 0
.head 9 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 9 -  Set i = SalStrLength( s )
.head 9 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 8 -  Call RegCloseKey( lnKey )
.head 8 -  Set s = SalStrTrimX( s )
.head 8 +  If SalStrLeftX( s, 1 ) = '"'
.head 9 -  Set s = SalStrMidX( s, 1, SalStrLength( s ) )
.head 9 +  While SalStrRightX( s, 1 ) != '"' 
.head 10 -  Set s = SalStrLeftX( s, SalStrLength( s ) - 1 )
.head 9 -  Set s = SalStrLeftX( s, SalStrLength( s ) - 1 )
.head 7 +  Else
.head 8 -  Set s = csWWWinWordApplication
.head 7 -  !
.head 7 -  !
.head 6 +  Else
.head 7 -  Set s = csWWWinWordApplication
.head 6 -  Set ssVal = s
.head 5 -  Return ssVal
.head 3 +  Function: WinwordTopic
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 -  Parameters
.head 4 +  Static Variables
.head 5 -  String: ssVal
.head 4 +  Local variables
.head 5 -  Number: lnKey
.head 5 -  Number: i
.head 5 -  String: s1
.head 5 -  String: s
.head 4 +  Actions
.head 5 +  If SalStrLength( ssVal ) = 0
.head 6 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, csWWWordDocument || csWWCurVer, lnKey )
.head 6 +  If i = 0
.head 7 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 7 +  If i = 0
.head 8 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 8 -  Set i = SalStrLength( s )
.head 8 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 7 -  Call RegCloseKey( lnKey )
.head 7 -  Set s = SalStrTrimX( s )
.head 7 -  Set i = RegOpenKeyA( HKEY_CLASSES_ROOT, s || csWWShellOpenDdeexecTopic, lnKey )
.head 7 +  If i = 0
.head 8 -  Set s = SalStrLeftX( SalStrRepeatX( cRegSpace, 250 ), 250 )
.head 8 +  If i = 0
.head 9 -  ! Set s = SalStrRepeatX( ' ', 250 )
.head 9 -  Set i = SalStrLength( s )
.head 9 -  Set i = RegQueryValueA( lnKey, cRegVide, s, i )
.head 8 -  Call RegCloseKey( lnKey )
.head 8 -  Set s = SalStrTrimX( s )
.head 8 +  If SalStrLeftX( s, 1 ) = '"'
.head 9 -  Set s = SalStrMidX( s, 1, SalStrLength( s ) )
.head 9 +  While SalStrRightX( s, 1 ) != '"' 
.head 10 -  Set s = SalStrLeftX( s, SalStrLength( s ) - 1 )
.head 9 -  Set s = SalStrLeftX( s, SalStrLength( s ) - 1 )
.head 7 +  Else
.head 8 -  Set s = csWWWinWordTopic
.head 7 -  !
.head 7 -  !
.head 6 +  Else
.head 7 -  Set s = csWWWinWordTopic
.head 6 -  Set ssVal = s
.head 5 -  Return ssVal
.head 3 -  ! \##### LS : 17/04/2003
.head 3 -  !
.head 3 -  !
.head 3 -  !
.head 3 +  Function: FindWindowDph
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Window Handle:
.head 4 +  Parameters
.head 5 -  String: ps
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Return FindWin( ps )
.head 5 -  Return FindWindowA( ps, STRING_Null )
.head 2 -  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 3760730002
0000: 41040000E1010000 0000000000000000 0200000500FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F13013800 00000F6300446573
0040: 6B746F704C006973 74426F784E01C200 0B00000043190000 0001FA0000FF6F19
0060: 00D6190001FE00FF 833200000019B500 0100FFFF604B0000 001900ED0100FF3F
0080: 6400580000190001 FB00FF0F7D000000 D6190001FE00FF83 9600000019B50001
00A0: 00FFFF60AF000000 1900ED0100FF3FC8 00580000190001FB 00FF0FE1000000D6
00C0: 190001FE00FF83FA 00000019B5000100 FFFF100180640000 010001000B634469
00E0: 724C3E697C00C000 00040000005B1900 01FB00FF6F1900D6 190001FE00FF9B32
0100: 0019B5000100FFFF 664B001900ED0100 FF3F0180044B0000 020000001E0F5472
0120: 65F8654C69005E00 0000030000006F19 00E9010000FFBF19 5900190001FB00FF
0140: 6F3200D6190001FE 00FF430180AF0000 0603000C634669F8 6C654C01D6000000
0160: 070000DE0019D200 010000FF7F19B300 1900F60100FFDF32 AC00190001FD00FF
0180: 374B00196B000100 FFFFCD640019DA00 0100FF7F7DB30019 00F60100FFDF96AC
01A0: 00190001FD00FF87 01807D000C000400 0D6352C06164696F 4C69079A00000005
01C0: 790000194B000100 00FFFFCD190019DA 000100FF7F32B300 1900F60100FFDF4B
01E0: AC00190001FD00FF 376400196B000100 FFFF01
.enddata
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field: cQuickMLField
.head 3 -  Pushbutton: cQuickCommander
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  ActiveX:
.head 3 -  Check Box:
.head 3 -  Child Table: cQuickTable
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture: cQuickPicture
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control: cQuickGraph
.head 2 -  Application Actions
