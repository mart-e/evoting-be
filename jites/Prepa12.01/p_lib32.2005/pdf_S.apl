.head 0 +  Application Description: Gupta SQLWindows Standard Application Template

Librairie pour l'impression des rapports en PDF via l'imprimante Win2PDF
.head 1 -  Outline Version - 4.0.32
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000A50000 002C000000020000 0003000000FFFFFF FFFFFFFFFFFCFFFF
0040: FFE2FFFFFFFFFFFF FF000000007C0200 004D010000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left: -0.013"
.head 3 -  Top: 0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: D4180909B80B1A00
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left: 4.15"
.head 3 -  Top: 1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left: 0.575"
.head 3 -  Top: 0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left: 6.388"
.head 3 -  Top: 0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  File Include: registry2.apl
.head 2 -  ! File Include: vtdos.apl
.head 2 -  File Include: cstste.apl
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 3 -  Enumerations
.head 2 +  Resources
.head 2 +  Variables
.data RESOURCE 0 0 1 2239919657
0000: 220000001F000000 0000000000000000 020000010000006F 0000001019000000
0020: 01C601F04F000000 4073000000010000 03
.enddata
.head 3 -  String: __PrnPdfDriver
.head 3 -  String: __PrnPdfDevice
.head 3 -  String: __PrnPdfPort
.head 3 -  String: __SavedPrn[*,3]
.head 3 -  Number: __nSavedPrn
.head 3 -  FunctionalVar: PdfPrinter
.head 4 -  Class: tPdfPrinter
.head 2 +  Internal Functions
.head 3 +  Function: PdfPrtSetDefault
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set __PrnPdfDriver = 'Win2PDF'
.head 5 -  Set __PrnPdfDevice = 'Win2PDF'
.head 5 -  Set __PrnPdfPort = 'PDFFILE:'
.head 5 -  Call SalPrtSetDefault( __PrnPdfDriver, __PrnPdfDevice, __PrnPdfPort )
.head 3 -  !
.head 3 +  Function: PdfSetFileName
.head 4 -  Description: Définit le nom du fichier PDF de sortie
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: psFileName
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  FunctionalVar: reg
.head 6 -  Class: cBTRegistry
.head 4 +  Actions
.head 5 +  If PdfIsInstalled(  )
.head 6 +  If reg.OpenKey( '/Software/Dane Prairie Systems/Win2PDF', FALSE )
.head 7 -  Call reg.WriteString( 'PDFFileName', psFileName )
.head 7 -  Call reg.CloseKey(  )
.head 3 +  Function: PdfSetPrepend
.head 4 -  Description: Définit le nom du fichier PDF à ajouter avant le fichier à générer
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: psFileName
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  FunctionalVar: reg
.head 6 -  Class: cBTRegistry
.head 4 +  Actions
.head 5 +  If PdfIsInstalled(  )
.head 6 +  If reg.OpenKey( '/Software/Dane Prairie Systems/Win2PDF', FALSE )
.head 7 -  Call reg.WriteString( 'PDFPrependFile', psFileName )
.head 7 -  Call reg.CloseKey(  )
.head 3 +  Function: PdfSetAppend
.head 4 -  Description: Définit le nom du fichier PDF à ajouter à la fin du fichier générer
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: psFileName
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  FunctionalVar: reg
.head 6 -  Class: cBTRegistry
.head 4 +  Actions
.head 5 +  If PdfIsInstalled(  )
.head 6 +  If reg.OpenKey( '/Software/Dane Prairie Systems/Win2PDF', FALSE )
.head 7 -  Call reg.WriteString( 'PDFAppendFile', psFileName )
.head 7 -  Call reg.CloseKey(  )
.head 3 +  Function: PdfSetOptions
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Boolean: pbViewFile
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  FunctionalVar: reg
.head 6 -  Class: cBTRegistry
.head 5 -  Number: n
.head 4 +  Actions
.head 5 +  If PdfIsInstalled(  )
.head 6 +  If reg.OpenKey( '/Software/Dane Prairie Systems/Win2PDF', FALSE )
.head 7 -  Set n = 0
.head 7 +  If pbViewFile
.head 8 -  Set n = n + 0x02
.head 7 -  Call reg.WriteInteger( 'file options', n )
.head 7 -  Call reg.CloseKey(  )
.head 3 -  !
.head 3 +  Function: PdfIsInstalled
.head 4 -  Description: Vérifie la présence de l'imprimante PDF Win2PDF
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 +  Static Variables
.head 5 -  Boolean: bOk
.head 4 +  Local variables
.head 5 -  ! cBTRegistry: reg
.winattr class FunctionalVar:
.head 6 -  Class: cBTRegistry
.end
.head 5 -  Number: nCount
.head 5 -  String: PrinterName[*]
.head 5 -  String: PrinterDevice[*]
.head 5 -  String: PrinterPort[*]
.head 5 -  Number: i
.head 4 +  Actions
.head 5 +  If not bOk
.head 6 -  Set nCount = SalPrtGetPrinters( PrinterName, PrinterDevice, PrinterPort )
.head 6 -  Set i = 0
.head 6 +  While not bOk and ( i < nCount )
.head 7 -  Set bOk = SalStrUpperX( PrinterName[i] ) = 'WIN2PDF'
.head 7 -  Set i = i + 1
.head 6 -  ! Set reg.m_RootKey = HKEY_CURRENT_USER
.head 6 +  ! If reg.OpenKey( '/Software/Dane Prairie Systems/Win2PDF', FALSE )
.head 7 -  Set bOk = TRUE
.head 7 -  Call reg.CloseKey(  )
.head 5 -  Return bOk
.head 3 -  !
.head 3 +  Function: PdfSetInformation
.head 4 -  Description: Met les information du fichier PDF
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: psTitle
.head 5 -  String: psAuthor
.head 5 -  String: psSubject
.head 5 -  String: psKeywords
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  FunctionalVar: reg
.head 6 -  Class: cBTRegistry
.head 4 +  Actions
.head 5 +  If PdfIsInstalled(  )
.head 6 +  If reg.OpenKey( '/Software/Dane Prairie Systems/Win2PDF', FALSE )
.head 7 -  Call reg.WriteString( 'PDFTitle', psTitle )
.head 7 -  Call reg.WriteString( 'PDFAuthor', psAuthor )
.head 7 -  Call reg.WriteString( 'PDFSubject', psSubject )
.head 7 -  Call reg.WriteString( 'PDFKeywords', psKeywords )
.head 7 -  Call reg.CloseKey(  )
.head 3 -  !
.head 3 +  Function: PdfDlgSaveFile
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: psPath
.head 5 -  Receive String: rpsFileName
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: wsSavedPath
.head 5 -  String: wsPath
.head 5 -  String: wsFileName
.head 5 -  String: wsFullFileName
.head 5 -  String: strPath
.head 5 -  String: strFile
.head 5 -  String: strFilter[*]
.head 5 -  Number: nFilter
.head 5 -  Number: nIndex
.head 5 -  Boolean: bOk
.head 4 +  Actions
.head 5 -  Set strPath = psPath
.head 5 -  Set strFile = STRING_Null
.head 5 -  Set strFilter[0] = 'PDF File'
.head 5 -  Set strFilter[1] = '*.pdf'
.head 5 -  Set nFilter = 2
.head 5 -  Set nIndex = 1
.head 5 -  Set bOk = FALSE
.head 5 -  Set wsSavedPath = VisDosGetCurDir( SalFileGetDrive(  ) )
.head 5 -  Set wsPath = GetUserDirDef( cPathStesud )
.head 5 -  Set wsFullFileName = wsPath || '\\' || wsFileName
.head 5 -  Set wsFullFileName = GetWindowDir( cDirPersonal )  || strPath
.head 5 -  Set wsFileName = wsFullFileName
.head 5 -  Set strFile = wsFullFileName
.head 5 -  Set strPath = wsFullFileName
.head 5 +  If SalDlgSaveFile( hWndForm, "Choix d'un répertoire", strFilter, nFilter, nIndex, strFile, strPath )
.head 6 -  Set rpsFileName = strPath
.head 6 -  Set bOk = TRUE
.head 5 -  Return bOk
.head 3 -  !
.head 3 -  !
.head 3 -  !
.head 3 -  !
.head 3 +  Function: PrnSavePrinter
.head 4 -  Description: Sauvegarde les valeurs de l'imprimante par défaut
.head 4 +  Returns
.head 5 -  Number:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: s1
.head 5 -  String: s2
.head 5 -  String: s3
.head 5 -  Number: i
.head 4 +  Actions
.head 5 -  Call SalPrtGetDefault( s1, s2, s3 )
.head 5 -  Set __nSavedPrn = __nSavedPrn + 1
.head 5 -  Set i = __nSavedPrn
.head 5 -  Set __SavedPrn[ i, 0 ] = s1
.head 5 -  Set __SavedPrn[ i, 1 ] = s2
.head 5 -  Set __SavedPrn[ i, 2 ] = s3
.head 5 -  Return __nSavedPrn
.head 3 -  !
.head 3 +  Function: PrnRestorePrinter
.head 4 -  Description: Sauvegarde les valeurs de l'imprimante par défaut
.head 4 +  Returns
.head 5 -  Number:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: s1
.head 5 -  String: s2
.head 5 -  String: s3
.head 5 -  Number: i
.head 4 +  Actions
.head 5 +  If __nSavedPrn > 0
.head 6 -  Set i = __nSavedPrn
.head 6 -  Set __nSavedPrn = __nSavedPrn - 1
.head 6 -  Set s1 = __SavedPrn[ i, 0 ] 
.head 6 -  Set s2 = __SavedPrn[ i, 1 ]
.head 6 -  Set s3 = __SavedPrn[ i, 2 ]
.head 6 -  Call SalPrtSetDefault( s1, s2, s3 )
.head 5 -  Return __nSavedPrn
.head 3 +  Function: SalPrtGetPrinters
.head 4 -  Description: 
author: 	newsgroupcode, tl
date:	2002
version:	1.00

desc:

example:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Receive String: rsPrinterName[*]
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Receive String: rsPrinterDriver[*]
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Receive String: rsPrinterPort[*]
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: lnCount
.head 5 -  Number: lnIdx
.head 5 -  String: lsPrinterNames[*]
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions
.head 5 -  Call VisProfileEnumStrings( 'WIN.INI', 'Devices', lsPrinterNames )
.head 5 +  If SalArrayIsEmpty( lsPrinterNames )
.head 6 -  Return NUMBER_Null
.head 5 -  Call SalArrayGetUpperBound( lsPrinterNames,1,lnCount)
.head 5 +  While lnIdx < (lnCount+1)
.head 6 -  Set rsPrinterName[lnIdx] = lsPrinterNames[lnIdx]
.head 6 -  Call SalPrtGetPrinterSettings( rsPrinterName[lnIdx],rsPrinterDriver[lnIdx],rsPrinterPort[lnIdx])
.head 6 -  Set lnIdx = lnIdx + 1
.head 5 -  Return lnCount
.head 3 +  Function: SalPrtGetPrinterSettings
.head 4 -  Description: 
author: 	newsgroupcode, tl
date:	2002
version:	1.00

desc:

example:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sPrinterName
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Receive String: sPrinterDriver
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Receive String: sPrinterPort
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: lsProfiles[*]
.head 5 -  String: sPrinterProfile
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions
.head 5 -  Call SalGetProfileString('Devices',sPrinterName,'',sPrinterProfile, 'WIN.INI' )
.head 5 -  Call SalStrTokenize(sPrinterProfile,'',',', lsProfiles )
.head 5 -  Set sPrinterDriver = lsProfiles[0]
.head 5 -  Set sPrinterPort = lsProfiles[1]
.head 2 -  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 2446007512
0000: 7D04000002030000 0000000000000000 0200000600FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F19003C00 000B740050646650
0040: 72696E7400657222 00000001003C0000 1900050001C40158 003C00007300D000
0060: 0001000020018013 0100010001000F63 4465736B00746F70 4C69737442206F78
0080: 4E01000B00BC0000 19250001C407000C 000082017300D100 0100006619001900
00A0: 0901C4080000007B 8200340100003200 580000190001C2C4 090000001E820001
00C0: 000D004B00000096 190001C4B00A0000 0082470001000083 6400000019250001
00E0: C40B00ED0082D100 010000607D000000 19000901C40C0000 007B820034010000
0100: 9600580000190001 C2C40D0000001E82 0001000D00AF0000 0096190001C4B00E
0120: 0000008247000100 0083C80000001925 0001C40F00EC0000 82D10001000060E1
0140: 00000019000901C4 100000007B820034 010000FA00580000 190001C2C4110000
0160: 001E820001000D00 0180640001000200 00000B63E0446972 4C69037C00000004
0180: 00BC000019A50001 C4078D00940173D1 0001000066190019 006901C408007B94
01A0: 00B4010000325900 190001DAC409001E 940001006D004B00 96190001C4B60A00
01C0: 9447000100004301 804B0000E0030000 000F81547265654C 690F5E000000F603
01E0: 0096190001C43607 00A6014673000100 009B190019A50001 C408ED00A6D10001
0200: 0000663200190069 01C409007BA60034 010000018064AF00 000400800C634669
0220: 6C654C1FD60000E8 000700002D190001 C46106000000CA8C 0173000100360019
0240: 00194B0001C407DB 00CAA300010000CD 320019D20001C408 F600CA6800010000
0260: 4BB3001900B401C4 09003DCA0001DA00 00642C00190001C4 6D0A00CA8F000100
0280: 36007D00194B0001 C40BDB00CAA30001 0000CD960019D200 01C40CF600CA6800
02A0: 0100000108807D00 0005000000000D63 526164696F7C4C69 9AB00000000500B7
02C0: 1900B401C4060021 960273000001DA00 00192C00190001C4 6D0700968F000100
02E0: 36003200194B0001 C408DB0096A30001 0000CD4B0019D200 01C409F600966800
0300: 01000064B3001900 B401C40A003D9600 011A0000
.enddata
.head 3 +  Functional Class: tPdfPrinter
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: __PrnPdfDriver
.head 5 -  String: __PrnPdfDevice
.head 5 -  String: __PrnPdfPort
.head 5 -  String: __SavedPrn[*,3]
.head 5 -  Number: __nSavedPrn
.head 4 +  Functions
.head 5 +  Function: ObjectDestructor
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  While __nSavedPrn
.head 8 -  Call RestorePrinter(  )
.head 5 +  Function: SetDefault
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set __PrnPdfDriver = 'Win2PDF'
.head 7 -  Set __PrnPdfDevice = 'Win2PDF'
.head 7 -  Set __PrnPdfPort = 'PDFFILE:'
.head 7 -  Call SalPrtSetDefault( __PrnPdfDriver, __PrnPdfDevice, __PrnPdfPort )
.head 5 +  Function: SetFileName
.head 6 -  Description: Définit le nom du fichier PDF de sortie
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: psFileName
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  FunctionalVar: reg
.head 8 -  Class: cBTRegistry
.head 6 +  Actions
.head 7 +  If IsInstalled(  )
.head 8 +  If reg.OpenKey( '/Software/Dane Prairie Systems/Win2PDF', FALSE )
.head 9 -  Call reg.WriteString( 'PDFFileName', psFileName )
.head 9 -  Call reg.CloseKey(  )
.head 5 +  Function: SetPrepend
.head 6 -  Description: Définit le nom du fichier PDF à ajouter avant le fichier à générer
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: psFileName
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  FunctionalVar: reg
.head 8 -  Class: cBTRegistry
.head 6 +  Actions
.head 7 +  If IsInstalled(  )
.head 8 +  If reg.OpenKey( '/Software/Dane Prairie Systems/Win2PDF', FALSE )
.head 9 -  Call reg.WriteString( 'PDFPrependFile', psFileName )
.head 9 -  Call reg.CloseKey(  )
.head 5 +  Function: SetAppend
.head 6 -  Description: Définit le nom du fichier PDF à ajouter à la fin du fichier générer
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: psFileName
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  FunctionalVar: reg
.head 8 -  Class: cBTRegistry
.head 6 +  Actions
.head 7 +  If IsInstalled(  )
.head 8 +  If reg.OpenKey( '/Software/Dane Prairie Systems/Win2PDF', FALSE )
.head 9 -  Call reg.WriteString( 'PDFAppendFile', psFileName )
.head 9 -  Call reg.CloseKey(  )
.head 5 +  Function: SetOptions
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: pbViewFile
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  FunctionalVar: reg
.head 8 -  Class: cBTRegistry
.head 7 -  Number: n
.head 6 +  Actions
.head 7 +  If IsInstalled(  )
.head 8 +  If reg.OpenKey( '/Software/Dane Prairie Systems/Win2PDF', FALSE )
.head 9 -  Set n = 0
.head 9 +  If pbViewFile
.head 10 -  Set n = n + 0x02
.head 9 -  Call reg.WriteInteger( 'file options', n )
.head 9 -  Call reg.CloseKey(  )
.head 5 -  !
.head 5 +  Function: IsInstalled
.head 6 -  Description: Vérifie la présence de l'imprimante PDF Win2PDF
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 +  Static Variables
.head 7 -  Boolean: bOk
.head 6 +  Local variables
.head 7 -  FunctionalVar: reg
.head 8 -  Class: cBTRegistry
.head 6 +  Actions
.head 7 +  If not bOk
.head 8 -  Set reg.m_RootKey = HKEY_CURRENT_USER
.head 8 +  If reg.OpenKey( '/Software/Dane Prairie Systems/Win2PDF', FALSE )
.head 9 -  Set bOk = TRUE
.head 9 -  Call reg.CloseKey(  )
.head 7 -  Return bOk
.head 5 -  !
.head 5 +  Function: SetInformation
.head 6 -  Description: Met les information du fichier PDF
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: psTitle
.head 7 -  String: psAuthor
.head 7 -  String: psSubject
.head 7 -  String: psKeywords
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  FunctionalVar: reg
.head 8 -  Class: cBTRegistry
.head 6 +  Actions
.head 7 +  If IsInstalled(  )
.head 8 +  If reg.OpenKey( '/Software/Dane Prairie Systems/Win2PDF', FALSE )
.head 9 -  Call reg.WriteString( 'PDFTitle', psTitle )
.head 9 -  Call reg.WriteString( 'PDFAuthor', psAuthor )
.head 9 -  Call reg.WriteString( 'PDFSubject', psSubject )
.head 9 -  Call reg.WriteString( 'PDFKeywords', psKeywords )
.head 9 -  Call reg.CloseKey(  )
.head 5 -  !
.head 5 +  Function: DlgSaveFile
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: psPath
.head 7 -  Receive String: rpsFileName
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: strPath
.head 7 -  String: strFile
.head 7 -  String: strFilter[*]
.head 7 -  Number: nFilter
.head 7 -  Number: nIndex
.head 7 -  Boolean: bOk
.head 6 +  Actions
.head 7 -  Set strPath = psPath
.head 7 -  Set strFile = STRING_Null
.head 7 -  Set strFilter[0] = 'PDF File'
.head 7 -  Set strFilter[1] = '*.pdf'
.head 7 -  Set nFilter = 2
.head 7 -  Set nIndex = 1
.head 7 -  Set bOk = FALSE
.head 7 +  If SalDlgSaveFile( hWndForm, "Choix d'un répertoire", strFilter, nFilter, nIndex, strFile, strPath )
.head 8 -  Set rpsFileName = strPath
.head 8 -  Set bOk = TRUE
.head 7 -  Return bOk
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 +  Function: SavePrinter
.head 6 -  Description: Sauvegarde les valeurs de l'imprimante par défaut
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: s1
.head 7 -  String: s2
.head 7 -  String: s3
.head 7 -  Number: i
.head 6 +  Actions
.head 7 -  Call SalPrtGetDefault( s1, s2, s3 )
.head 7 -  Set __nSavedPrn = __nSavedPrn + 1
.head 7 -  Set i = __nSavedPrn
.head 7 -  Set __SavedPrn[ i, 0 ] = s1
.head 7 -  Set __SavedPrn[ i, 1 ] = s2
.head 7 -  Set __SavedPrn[ i, 2 ] = s3
.head 7 -  Return __nSavedPrn
.head 5 -  !
.head 5 +  Function: RestorePrinter
.head 6 -  Description: Sauvegarde les valeurs de l'imprimante par défaut
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: s1
.head 7 -  String: s2
.head 7 -  String: s3
.head 7 -  Number: i
.head 6 +  Actions
.head 7 +  If __nSavedPrn > 0
.head 8 -  Set i = __nSavedPrn
.head 8 -  Set __nSavedPrn = __nSavedPrn - 1
.head 8 -  Set s1 = __SavedPrn[ i, 0 ] 
.head 8 -  Set s2 = __SavedPrn[ i, 1 ]
.head 8 -  Set s3 = __SavedPrn[ i, 2 ]
.head 8 -  Call SalPrtSetDefault( s1, s2, s3 )
.head 7 -  Return __nSavedPrn
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton:
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control:
.head 3 -  ActiveX:
.head 2 -  Application Actions
