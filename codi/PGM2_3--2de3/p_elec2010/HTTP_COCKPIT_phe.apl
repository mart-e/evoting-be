.head 0 +  Application Description: Gupta SQLWindows Standard Application Template
.data CLASSPROPSSIZE
0000: 4500
.enddata
.data CLASSPROPS
0000: 557365476C6F6261 6C50617468000400 0100000000417070 506174684C656E00
0020: 04000D0000000041 707050617468000D 00433A5C505F4C69 6233322E34320000
0040: 0000000000
.enddata
.head 1 -  Outline Version - 4.0.35
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000A50000 002C000000020000 0003000000FFFFFF FFFFFFFFFFFCFFFF
0040: FFE9FFFFFFFFFFFF FF000000007C0200 004D010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left: -0.013"
.head 3 -  Top: 0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: D4180909B80B1A00
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? No
.head 3 -  Left: 4.15"
.head 3 -  Top: 1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left: 0.575"
.head 3 -  Top: 0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left: 6.388"
.head 3 -  Top: 0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 2 -  Edit Fields Read Only On Disable? No
.head 1 +  Libraries
.head 2 -  File Include: Clever Internet Suite.apl
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 2 -  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 -  User
.head 3 -  Enumerations
.head 2 -  Resources
.head 2 +  Variables
.head 3 -  ! ! ! http, https, proxy
.head 3 -  ! ! ! gsHttpType = 0 -> http, 1 -> https
.head 3 -  String: gsHttpType
.head 3 -  ! ! ! http
.head 3 -  String: gsHttpCockpit
.head 3 -  String: gsHttpUp
.head 3 -  String: gsHttpDown
.head 3 -  ! ! ! https
.head 3 -  String: gsHttpsCockpit
.head 3 -  String: gsHttpsUp
.head 3 -  String: gsHttpsDown
.head 3 -  String: gsHttpsLogin
.head 3 -  String: gsHttpsPwd
.head 3 -  ! ! ! proxy
.head 3 -  String: gsProxyServeur
.head 3 -  Number: gnProxyPort
.head 3 -  String: gsProxyUser
.head 3 -  String: gsProxyPass
.head 3 -  Number: gnHttpNbrEssais
.head 3 -  Number: gnHttpTimeout
.head 3 -  String: gsHTTPMessage[*]
.head 2 +  Internal Functions
.head 3 -  ! fichier .ini
.head 3 +  Function: PalHttpIniRead
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sPathINI
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: lsMsg
.head 5 -  File Handle: lhFile
.head 5 -  Boolean: lbContinue
.head 5 -  String: lsPath
.head 5 -  Number: lnMsgNo
.head 5 -  Number: lnI
.head 4 +  Actions
.head 5 -  !
.head 5 -  Call VisWaitCursor( TRUE )
.head 5 -  Set lbContinue = TRUE
.head 5 +  If TRUE
.head 6 -  Set gnHttpNbrEssais =3
.head 6 -  Set gnHttpTimeout =3000
.head 6 -  ! HTTP
.head 6 -  Set gsHttpCockpit = ''
.head 6 -  Set gsHttpUp = ''
.head 6 -  Set gsHttpDown = ''
.head 6 -  ! HTTPS
.head 6 -  Set gsHttpsCockpit = ''
.head 6 -  Set gsHttpsUp = ''
.head 6 -  Set gsHttpsDown = ''
.head 6 -  Set gsHttpsLogin = ''
.head 6 -  Set gsHttpsPwd = ''
.head 6 -  ! PROXY
.head 6 -  Set gsProxyServeur = ''
.head 6 -  Set gnProxyPort = 0
.head 6 -  Set gsProxyUser = ''
.head 6 -  Set gsProxyPass = ''
.head 5 -  !
.head 5 -  ! Http, https
.head 5 -  Call SalGetProfileString( 'HTTP_TYPE', 'HTTP_TYPE',  '-1', gsHttpType, sPathINI )
.head 5 -  !
.head 5 +  If NOT SalFileOpen( lhFile, sPathINI, OF_Exist )
.head 6 -  Set lsMsg = "Aucun fichier INI reprenantant les paramètres HTTP n'a été trouvé ("|| sPathINI ||")"
.head 6 -  Set lbContinue =  FALSE
.head 5 +  If gsHttpType != '-1'
.head 6 +  If lbContinue
.head 7 -  ! HTTP
.head 7 -  Call SalGetProfileString( 'HTTP', 'HTTP_COCKPIT', gsHttpCockpit, gsHttpCockpit, sPathINI  )
.head 7 -  Call SalGetProfileString( 'HTTP', 'HTTP_UP', gsHttpUp, gsHttpUp, sPathINI )
.head 7 -  Call SalGetProfileString( 'HTTP', 'HTTP_DOWN', gsHttpDown,  gsHttpDown,  sPathINI  )
.head 7 -  ! HTTPS
.head 7 -  Call SalGetProfileString( 'HTTPS', 'HTTPS_COCKPIT', gsHttpsCockpit, gsHttpsCockpit, sPathINI )
.head 7 -  Call SalGetProfileString( 'HTTPS', 'HTTPS_UP', gsHttpsUp, gsHttpsUp, sPathINI  )
.head 7 -  Call SalGetProfileString( 'HTTPS', 'HTTPS_DOWN', gsHttpsDown,  gsHttpsDown,  sPathINI )
.head 7 -  Call SalGetProfileString( 'HTTPS', 'HTTPS_LOGIN', gsHttpsLogin, gsHttpsLogin, sPathINI  )
.head 7 -  Call SalGetProfileString( 'HTTPS', 'HTTPS_PWD', gsHttpsPwd,  gsHttpsPwd,  sPathINI )
.head 7 -  ! PROXY
.head 7 -  Call SalGetProfileString( 'PROXY', 'PROXY_NOM', gsProxyServeur, gsProxyServeur, sPathINI  )
.head 7 -  Set gnProxyPort = SalGetProfileInt( 'PROXY', 'PROXY_PORT', gnProxyPort, sPathINI )
.head 7 -  Call SalGetProfileString( 'PROXY', 'PROXY_LOGIN', gsProxyUser,  gsProxyUser,  sPathINI  )
.head 7 -  Call SalGetProfileString( 'PROXY', 'PROXY_PWD', gsProxyPass, gsProxyPass, sPathINI )
.head 7 -  ! TIME OUT
.head 7 -  Set gnHttpNbrEssais = SalGetProfileInt( 'TIMEOUT', 'ESSAI', gnHttpNbrEssais, sPathINI )
.head 7 -  Set gnHttpTimeout = SalGetProfileInt( 'TIMEOUT', 'TIMEOUT', gnHttpTimeout, sPathINI )
.head 6 -  ! Chargement Array des messages pour l'application
.head 6 +  If lbContinue
.head 7 -  Set lnMsgNo = SalGetProfileInt( 'HTTP_MSG', 'MSG_NO', 0, sPathINI )
.head 7 -  Set lnI = lnMsgNo
.head 7 +  While lnI <= lnMsgNo+99
.head 8 -  Call SalGetProfileString( 'HTTP_MSG', 'MSG_'|| SalNumberToStrX( lnI,0), '', gsHTTPMessage[lnI], sPathINI  )
.head 8 -  Set lnI = lnI + 1
.head 5 +  Else
.head 6 -  Call SalSetProfileString( 'HTTP_TYPE', 'HTTP_TYPE',  gsHttpType, sPathINI )
.head 6 -  Set lsMsg = "Aucune connexion vers des serveurs HTTP ("|| sPathINI ||")"
.head 6 -  Set lbContinue =  FALSE
.head 5 -  !
.head 5 -  ! Display SalMsgBox
.head 5 +  If NOT lbContinue
.head 6 -  Call SalMessageBox( lsMsg, 'Information', 0 )
.head 5 -  !
.head 5 -  Call VisWaitCursor( FALSE )
.head 3 +  Function: PalHttpIniSave
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sPathINI
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: lsMsg
.head 5 -  File Handle: lhFile
.head 5 -  Boolean: lbContinue
.head 4 +  Actions
.head 5 -  !
.head 5 -  Call VisWaitCursor( TRUE )
.head 5 -  Set lbContinue = TRUE
.head 5 -  !
.head 5 +  If lbContinue
.head 6 -  Call SalSetProfileString( 'HTTP', 'HTTP_TYPE',  gsHttpType, sPathINI )
.head 6 -  ! HTTP
.head 6 -  Call SalSetProfileString( 'HTTP', 'HTTP_COCKPIT', gsHttpCockpit, sPathINI )
.head 6 -  Call SalSetProfileString( 'HTTP', 'HTTP_UP', gsHttpUp, sPathINI )
.head 6 -  Call SalSetProfileString( 'HTTP', 'HTTP_DOWN', gsHttpDown,  sPathINI )
.head 6 -  ! HTTPS
.head 6 -  Call SalSetProfileString( 'HTTPS', 'HTTPS_COCKPIT', gsHttpsCockpit, sPathINI )
.head 6 -  Call SalSetProfileString( 'HTTPS', 'HTTPS_UP', gsHttpsUp, sPathINI )
.head 6 -  Call SalSetProfileString( 'HTTPS', 'HTTPS_DOWN', gsHttpsDown, sPathINI )
.head 6 -  Call SalSetProfileString( 'HTTPS', 'HTTPS_LOGIN', gsHttpsLogin, sPathINI )
.head 6 -  Call SalSetProfileString( 'HTTPS', 'HTTPS_PWD', gsHttpsPwd, sPathINI )
.head 6 -  ! PROXY
.head 6 -  Call SalSetProfileString( 'PROXY', 'PROXY_NOM', gsProxyServeur, sPathINI )
.head 6 -  ! Call SalSetProfileInt( 'PROXY', 'PROXY_PORT', gnProxyPort, sPathINI )
.head 6 -  Call SalSetProfileString( 'PROXY', 'PROXY_PORT', SalNumberToStrX(gnProxyPort, 0), sPathINI )
.head 6 -  Call SalSetProfileString( 'PROXY', 'PROXY_LOGIN', gsProxyUser, sPathINI )
.head 6 -  Call SalSetProfileString( 'PROXY', 'PROXY_PWD', gsProxyPass, sPathINI )
.head 5 -  !
.head 5 -  !
.head 5 -  Call VisWaitCursor( FALSE )
.head 3 -  ! fichier .ini
.head 3 +  Function: PalHttpCockpit
.head 4 -  Description: Communication avec cockpit ...

pnTypeCom
psWarning
psErreur
psInfo
psElec (Election)
psModule (Logiciel)
psLieu (Ligne, INS, ...)
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: pnTypeCom
.head 5 -  String: psWarning
.head 5 -  String: psErreur
.head 5 -  String: psInfo
.head 5 -  !
.head 5 -  String: psElec
.head 5 -  String: psModule
.head 5 -  String: psLieu
.head 5 -  String: psFichier
.head 5 -  Receive String: psMsgErreur
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  !
.head 5 -  Boolean: lbMessageBox
.head 5 -  String: lsMessageBox
.head 5 -  Date/Time: ldtDateTime
.head 5 -  String: lsDateTime
.head 5 -  !
.head 5 -  String: lsReponse
.head 5 -  Number: lnReturn
.head 5 -  !
.head 5 -  String: lsUrl
.head 5 -  Boolean: lbAuto
.head 5 -  String: lsQui
.head 5 -  String: lsElec
.head 5 -  String: lsLieu
.head 5 -  String: lsQuand
.head 5 -  String: lsFichier
.head 5 -  String: lsTraitement
.head 5 -  String: lsErreur
.head 5 -  String: lsWarning
.head 5 -  String: lsInfo
.head 5 -  String: lsUser
.head 5 -  String: lsPassword
.head 5 -  String: lsMsgErreur
.head 5 -  !
.head 5 -  String: lsPathname
.head 5 -  !
.head 5 -  String: lsProxyServeur
.head 5 -  Number: lnProxyPort
.head 5 -  String: lsProxyUser
.head 5 -  String: lsProxyPass
.head 4 +  Actions
.head 5 +  If gsHttpType != '-1'
.head 6 -  ! Initialisation des variables
.head 6 +  If 1
.head 7 -  ! Automatique ?
.head 7 -  Set lbAuto = TRUE
.head 7 -  ! Quelque soit le pnTypeCom
.head 7 +  If 1
.head 8 +  If gsHttpType = '0'
.head 9 -  Set lsUrl = gsHttpCockpit
.head 8 +  Else If gsHttpType = '1'
.head 9 -  Set lsUrl = gsHttpsCockpit
.head 8 -  Set lsQui = psModule
.head 8 -  Set lsElec = psElec
.head 8 -  Set lsLieu = psLieu
.head 8 -  ! date aaaammddhhmmsscc
.head 8 -  Set ldtDateTime = SalDateCurrent(  )
.head 8 -  Call SalDateToStr( ldtDateTime, lsQuand )
.head 8 -  ! Set lsQuand = SalFmtFormatDateTime( ldtDateTime, 'yyyyMMddhhhhmmss' )
.head 8 -  ! Set lsDateTime = SalFmtFormatDateTime( ldtDateTime, '' )
.head 8 -  Set lsQuand = SalStrLeftX( lsQuand, 22 )
.head 8 -  Set lsQuand = VisStrSubstitute( lsQuand, '-', '')
.head 8 -  Set lsQuand = VisStrSubstitute( lsQuand, '.', '')
.head 8 -  Set lsQuand = VisStrSubstitute( lsQuand, ':', '')
.head 8 -  Set lsTraitement = SalNumberToStrX( pnTypeCom, 0 )
.head 8 -  Set lsFichier = psFichier
.head 8 -  Set lsWarning = psWarning
.head 8 -  Set lsErreur = psErreur
.head 8 -  ! Proxy
.head 8 -  Set lsProxyServeur = gsProxyServeur
.head 8 -  Set lnProxyPort = gnProxyPort
.head 8 -  Set lsProxyUser = gsProxyUser
.head 8 -  Set lsProxyPass = gsProxyPass
.head 8 -  !
.head 8 -  Set lsUser = gsHttpsLogin
.head 8 -  Set lsPassword = gsHttpsPwd
.head 7 -  ! Spécifique au pnTypeCom
.head 7 +  If gsHTTPMessage[pnTypeCom] != ''
.head 8 -  Set lsInfo =  psModule || ' - '|| gsHTTPMessage[pnTypeCom]
.head 7 +  Else
.head 8 -  Set lsInfo = psModule || ' - '|| 'Msg Inconnu : '|| SalNumberToStrX( pnTypeCom, 0)
.head 7 +  If psInfo != ''
.head 8 -  Set lsInfo = lsInfo || ' - '|| psInfo
.head 6 -  ! Com
.head 6 +  If 1
.head 7 -  Set lsReponse =''
.head 7 -  Set lnReturn =  SalModalDialog( dlgSendCockpit, hWndForm,
lsUrl,
lbAuto,
lsQui,
lsElec,
lsLieu,
lsQuand,
lsFichier,
lsTraitement,
lsWarning,
lsErreur,
lsInfo,
lsUser,
lsPassword,
lsProxyServeur,
lnProxyPort,
lsProxyUser,
lsProxyPass,
lsMsgErreur )
.head 7 +  If lnReturn = 0
.head 8 -  Set lsReponse = ' Communication avec le serveur cockpit ok ! '
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 -  ! Erreurs
.head 8 -  ! wnErreur = -1 : Mauvaise réponse du serveur : wsReponse  (Réponse != INSERT INTO ActivityLog)
.head 8 -  ! wnErreur =  1 : erreur 404 page inconnue   ('404' in Réponse)
.head 8 -  ! wnErreur =  2 : Hôte inconnu  ( 'Hôte' in Réponse)
.head 8 -  ! wnErreur =  3 : Connection refusée par le seveur ( 'accès' in Réponse)
.head 8 -  ! wnErreur =  9 : autres erreurs
.head 8 -  Set lsReponse =  SalNumberToStrX( lnReturn, 0 ) || ' : ' || lsMsgErreur
.head 8 -  Call SalMessageBox( lsReponse, 'Information', MB_Ok )
.head 8 -  Set psMsgErreur = lsReponse
.head 8 -  Return FALSE
.head 5 -  !
.head 5 -  Return TRUE
.head 3 +  Function: PalUploadFile
.head 4 -  Description: upload d'un fichier en mode http ou https (dépendant de gsHttpType)

psPathnameFichierUp
psFilenameFichierUp
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: psPathnameFichierUp
.head 5 -  String: psFilenameFichierUp
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: lnReturn
.head 5 -  String: lsUrlUp
.head 5 -  String: lsUser
.head 5 -  String: lsPassword
.head 5 -  String: lsMsgErreur
.head 5 -  String: lsProxyServeur
.head 5 -  Number: lnProxyPort
.head 5 -  String: lsProxyUser
.head 5 -  String: lsProxyPass
.head 5 -  !
.head 5 -  String: lsMsgDlgBox
.head 5 -  !
.head 5 -  String: lsFilename
.head 4 +  Actions
.head 5 -  ! Initialisation
.head 5 -  ! http
.head 5 +  If gsHttpType = '0'
.head 6 -  Set lsUrlUp = gsHttpUp
.head 5 -  ! https
.head 5 +  Else
.head 6 -  Set lsUrlUp = gsHttpsUp
.head 6 -  Set lsUser = gsHttpsLogin
.head 6 -  Set lsPassword = gsHttpsPwd
.head 5 -  !
.head 5 -  ! Proxy
.head 5 -  Set lsProxyServeur = gsProxyServeur
.head 5 -  Set lnProxyPort = gnProxyPort
.head 5 -  Set lsProxyUser = gsProxyUser
.head 5 -  Set lsProxyPass = gsProxyPass
.head 5 -  !
.head 5 -  Set lnReturn =  SalModalDialog( dlgUpload, hWndForm,
lsUrlUp,
TRUE,
psPathnameFichierUp,
lsUser,
lsPassword,
lsProxyServeur,
lnProxyPort,
lsProxyUser,
lsProxyPass,
lsMsgErreur)
.head 5 +  If lnReturn = 0
.head 6 -  ! Set lsMsgDlgBox = ' Fichier transféré !  ' ||  lsMsgErreur
.head 6 -  Set lsMsgDlgBox = ' Fichier transféré !  '
.head 6 -  ! Call PalHttpCockpit( lnTraitementCockpit, '0', '1', lsMsgDlgBox, psFilenameFichierUp )
.head 6 -  Call SalMessageBox( lsMsgDlgBox, 'Upload', 0 )
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  ! Erreurs du Start
.head 6 -  ! wnErreur =  -1 : opération stoppée
.head 6 -  ! wnErreur =  -2 : nom du fichier à transférer incorect ( 'open file in Réponse)
.head 6 -  ! wnErreur =  -9 : autres erreurs du Start
.head 6 -  !
.head 6 -  ! Autres erreurs gestion interne à la classe
.head 6 -  ! wnErreur =  404 : page incorrecte
.head 6 -  ! wnErreur =  12007 : Hôte inconnu
.head 6 -  ! Set lsMsgDlgBox = 'Erreur :' || SalNumberToStrX( wnReturn, 0 )  || ' '  || lsMsgErreur
.head 6 -  Set lsMsgDlgBox = 'Erreur :' || SalNumberToStrX( lnReturn, 0 ) || '
' || PalGetIIsErrorX( lnReturn )
.head 6 -  ! Call PalHttpCockpit( lnTraitementCockpit, '0', '1', lsMsgDlgBox, psFilenameFichierUp )
.head 6 -  Call SalMessageBox( lsMsgDlgBox, 'Upload', 0 )
.head 6 -  Return FALSE
.head 3 -  ! msg erreurs
.head 3 +  Function: PalGetIIsErrorX
.head 4 -  Description: Retourne le libellé correspondant au code erreur internet
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Number: pnCodeErreur
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: lsLibelleErreur
.head 4 +  Actions
.head 5 -  Set lsLibelleErreur = 'Undefined'
.head 5 +  Select Case pnCodeErreur
.head 6 +  Case 401
.head 7 -  Set lsLibelleErreur = 'You are not authorized to view this page'
.head 7 -  Break
.head 6 +  Case 12038
.head 7 -  Set lsLibelleErreur = 'ERROR_INTERNET_SEC_CERT_CN_INVALID
Le nom commun du certificat SSL (champ de nom d\'hôte) est incorrect.'
.head 7 -  Break
.head 6 +  Case 12045
.head 7 -  Set lsLibelleErreur = 'Certificate authority is invalid.'
.head 7 -  Break
.head 5 -  Return lsLibelleErreur
.head 2 -  Named Menus
.head 2 +  Class Definitions
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton:
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control:
.head 3 -  ActiveX:
.head 2 -  Application Actions
.head 1 +  Dialog Box: dlgSendCockpit
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Communication avec le serveur cockpit
.head 2 -  Accessories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: 2.713"
.head 4 -  Top: 1.635"
.head 4 -  Width:  13.983"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.06"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  Resizable? No
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  ActiveX: axHttp
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 4C69634B65794C65 6E00040000000000 000000
.enddata
.data CLASSPROPSSIZE
0000: 1300
.enddata
.data RESOURCE 5 0 1 3604892284
0000: 000A000031020000 0000000000000000 020000D0CF11E0A1 B11AE1F8000000FF
0020: 003E000300FEFF09 00F0060000000F01 000000F601000110 0000020000002601
0040: 00FEFFFFF8000000 F8FFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0060: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0080: FF40FDFFFFFFFEFF FF66FEFFFEFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00C0: FFFFFFFFFFFFFFFF FFFFFFFF2052006F 006F740081004500 6E0074C072007900
00E0: 0000FFFFFFFFFFA0 16000500FFFF4F01 000000282C01F093 C6CB4E00B163D3CB
0100: 5E1B5C36F8000000 0F2026869A000673 C80103000000F280 0000284A00454550
0120: 000853007243004F 00C24F4C000000FF FFFFFFFF82160201 FFFFFFFFFA0000FF
0140: FFFFFFF04E000000 FFFFFFFFFFFFFFFF AFFFFFFFFA0000FF FFFFFFFFFFFFFFFF
0160: FFFFFFFFAFFFFFFF FA0000FFFFFFFFFF 660100FEFFFFFFFF FFFFFFFFFFFFFFFF
0180: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
01A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF00545046 300754636C004874
01C0: 7470000955730065 724167656E740600 334D6F7A696C6C61 102F342E3028636F
01E0: 006D70617469626C 65023B436C657665 720020496E746572 6E65027453756974
0200: 652080362E322900 0000F92036FE00FF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0220: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0240: FFFFFF
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: AX_clInetSuiteX6_clHttp
.head 4 -  Property Template:
.head 4 -  License Key:
.head 4 -  Display Settings
.head 5 -  GUID:
.head 5 -  Type:
.head 5 -  Activation: Class Default
.head 5 -  Host Name:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.2"
.head 6 -  Top: 0.167"
.head 6 -  Width:  0.383"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  ActiveX: axRequest
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 4C69634B65794C65 6E00040000000000 000000
.enddata
.data CLASSPROPSSIZE
0000: 1300
.enddata
.data RESOURCE 5 0 1 3042494118
0000: 000A000064020000 0000000000000000 020000D0CF11E0A1 B11AE1F8000000FF
0020: 003E000300FEFF09 00F0060000000F01 000000F601000110 0000020000002601
0040: 00FEFFFFF8000000 F8FFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0060: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0080: FF40FDFFFFFFFEFF FF66FEFFFEFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00C0: FFFFFFFFFFFFFFFF FFFFFFFF2052006F 006F740081004500 6E0074C072007900
00E0: 0000FFFFFFFFFFA0 16000500FFFF4F01 00000029C9FACF70 EAE8420080C292AD
0100: 4CD5D62FF8000000 1F7E949A000673C8 0103000000F04000 0000284A00454550
0120: 000853007243004F 00C24F4C000000FF FFFFFFFF82160201 FFFFFFFFFA0000FF
0140: FFFFFFF029000000 FFFFFFFFFFFFFFFF AFFFFFFFFA0000FF FFFFFFFFFFFFFFFF
0160: FFFFFFFFAFFFFFFF FA0000FFFFFFFFFF F6FEFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0180: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
01A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFF00545046300E 54636C0048747470
01C0: 5265717500657374 000D486561006465 722E416363650070 7406032A2F2A0000
01E0: 002E6D736E2E636F 006D2F737663732F 68006F746D61696C 2F686474746D612E
0200: 80617370094D6169 004167656E740633 4D006F7A696C6C61 2F34442E3028636F
0220: 7080617469626C65 3B00436C65766572 2049806E7465726E 6574005375697465
0240: 20362EE832290000 FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0260: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFF
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: AX_clInetSuiteX6_clHttpRequest
.head 4 -  Property Template:
.head 4 -  License Key:
.head 4 -  Display Settings
.head 5 -  GUID:
.head 5 -  Type:
.head 5 -  Activation: Class Default
.head 5 -  Host Name:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.9"
.head 6 -  Top: 0.167"
.head 6 -  Width:  0.383"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Url :
.head 4 -  Resource Id: 29178
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 1.583"
.head 5 -  Top: 0.262"
.head 5 -  Width:  0.833"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfUrl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 2.083"
.head 6 -  Top: 0.238"
.head 6 -  Width:  11.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Pushbutton: pbSend
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: send
.head 4 -  Window Location and Size
.head 5 -  Left: 0.9"
.head 5 -  Top: 0.667"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! Set wbOk =  axHttp.Reset(  )
.head 6 -  ! Set wbOk =  axRequest.Reset(  )
.head 6 -  Set wbOk =  axRequest.AddFormField( 'Qui',psQui, lcItem)
.head 6 -  Set wbOk =  axRequest.AddFormField( 'Elec',psElec, lcItem)
.head 6 -  Set wbOk =  axRequest.AddFormField( 'Lieu',psLieu, lcItem)
.head 6 -  Set wbOk =  axRequest.AddFormField( 'Quand',psQuand, lcItem)
.head 6 -  Set wbOk =  axRequest.AddFormField( 'Fichier',psFichier, lcItem)
.head 6 -  Set wbOk =  axRequest.AddFormField( 'Traitement',psTraitement, lcItem)
.head 6 -  Set wbOk =  axRequest.AddFormField( 'Warning',psWarning,lcItem)
.head 6 -  Set wbOk = axRequest.AddFormField( 'Erreur',psErreur, lcItem)
.head 6 -  Set wbOk =  axRequest.AddFormField( 'Info',psInfo, lcItem)
.head 6 -  Set wbOk = SalActiveXGetObject( axRequest, lcRequest )
.head 6 -  Set wbOk =  axHttp.PropSetPassword(psPass )
.head 6 -  Set wbOk =  axHttp.PropSetUserName( psUser)
.head 6 -  Set wbOk =  axHttp.PropSetRequest( lcRequest)
.head 6 -  ! << phe 12
.head 6 -  ! Proxy
.head 6 +  If pnProxyPort != 0
.head 7 -  Set wbOk =  axHttp.PropGetProxySettings( lcProxySettings )
.head 7 -  Set wbOk =  lcProxySettings.PropSetServer( psProxyServeur)
.head 7 -  Set wbOk =  lcProxySettings.PropSetPort( pnProxyPort )
.head 7 -  Set wbOk =  lcProxySettings.PropSetUserName( psProxyUser)
.head 7 -  Set wbOk =  lcProxySettings.PropSetPassword( psProxyPass)
.head 6 -  !
.head 6 -  ! phe 12 >>
.head 6 -  !
.head 6 -  Set wbOk =  axHttp.Post( psUrl, lcReponse )
.head 6 +  If wbOk = 0
.head 7 -  Set wbOk =  axHttp.GetLastError( oleErreur )
.head 7 -  Set psMsgErreur=oleErreur.description
.head 7 +  If SalStrScan( psMsgErreur, '404' ) != -1
.head 8 -  Set wnErreur = 1
.head 7 +  Else If SalStrScan( psMsgErreur, 'Hôte' ) != -1
.head 8 -  Set wnErreur = 2
.head 7 +  Else If SalStrScan( psMsgErreur, 'accès' ) != -1
.head 8 -  Set wnErreur = 3
.head 7 +  Else
.head 8 -  Set wnErreur = 9
.head 7 -  ! Set wnErreur=oleErreur.wcode
.head 6 +  Else
.head 7 -  Call SalStrSetBufferLength( wsReponse,500)
.head 7 -  Set wbOk  =lcReponse.PropGetText( wsReponse )
.head 7 +  If SalStrUpperX(SalStrLeftX( wsReponse,23 )) != SalStrUpperX('INSERT INTO ActivityLog')
.head 8 -  Set psMsgErreur= ' Mauvaise réponse du serveur : ' || wsReponse
.head 8 -  Set wnErreur = -1
.head 7 +  Else
.head 8 -  Set wnErreur = 0
.head 6 -  Call SalEndDialog( dlgSendCockpit, wnErreur )
.head 6 -  !
.head 3 -  !
.head 3 -  Background Text: Qui :
.head 4 -  Resource Id: 29179
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.483"
.head 5 -  Top: 1.262"
.head 5 -  Width:  0.833"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfQui
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.283"
.head 6 -  Top: 1.238"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Elec:
.head 4 -  Resource Id: 29180
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.483"
.head 5 -  Top: 1.762"
.head 5 -  Width:  0.833"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfElec
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.283"
.head 6 -  Top: 1.738"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Lieu :
.head 4 -  Resource Id: 29181
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.483"
.head 5 -  Top: 2.262"
.head 5 -  Width:  0.833"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfLieu
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.283"
.head 6 -  Top: 2.238"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Quand :
.head 4 -  Resource Id: 29182
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.483"
.head 5 -  Top: 2.762"
.head 5 -  Width:  0.833"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfQuand
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.283"
.head 6 -  Top: 2.738"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Fichier :
.head 4 -  Resource Id: 29183
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.483"
.head 5 -  Top: 3.262"
.head 5 -  Width:  0.833"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfFichier
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.283"
.head 6 -  Top: 3.238"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Traitement :
.head 4 -  Resource Id: 29184
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.483"
.head 5 -  Top: 3.762"
.head 5 -  Width:  0.833"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfTraitement
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.283"
.head 6 -  Top: 3.738"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Warning :
.head 4 -  Resource Id: 29185
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.483"
.head 5 -  Top: 4.262"
.head 5 -  Width:  0.833"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfWarning
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.283"
.head 6 -  Top: 4.238"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Erreur :
.head 4 -  Resource Id: 29186
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.483"
.head 5 -  Top: 4.762"
.head 5 -  Width:  0.833"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfErreur
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.283"
.head 6 -  Top: 4.738"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: info :
.head 4 -  Resource Id: 29187
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.483"
.head 5 -  Top: 5.262"
.head 5 -  Width:  0.833"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfInfo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.283"
.head 6 -  Top: 5.238"
.head 6 -  Width:  10.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: psUrl
.head 3 -  Boolean: pbAuto
.head 3 -  String: psQui
.head 3 -  String: psElec
.head 3 -  String: psLieu
.head 3 -  String: psQuand
.head 3 -  String: psFichier
.head 3 -  String: psTraitement
.head 3 -  String: psWarning
.head 3 -  String: psErreur
.head 3 -  String: psInfo
.head 3 -  String: psUser
.head 3 -  String: psPass
.head 3 -  ! << phe 12
.head 3 -  String: psProxyServeur
.head 3 -  Number: pnProxyPort
.head 3 -  String: psProxyUser
.head 3 -  String: psProxyPass
.head 3 -  ! phe 12 >>
.head 3 -  Receive String: psMsgErreur
.head 2 +  Window Variables
.head 3 -  FunctionalVar: lcItem
.head 4 -  Class: clInetSuiteX6_IclFormFieldRequestItem
.head 3 -  FunctionalVar: lcReponse
.head 4 -  Class: clInetSuiteX6_IclReadonlyStrings
.head 3 -  ComProxyVar: lcRequest
.head 4 -  Class: clInetSuiteX6_clHttpRequest
.head 3 -  ! << phe 12
.head 3 -  FunctionalVar: lcProxySettings
.head 4 -  Class: clInetSuiteX6_IclHttpProxySettings
.head 3 -  ! phe 12 >>
.head 3 -  String: wsReponse
.head 3 -  String: wsErreur
.head 3 -  Number: wnErreur
.head 3 -  FunctionalVar: oleErreur
.head 4 -  Class: OleErrorInfo
.head 3 -  Boolean: wbOk
.head 3 -  FunctionalVar: lcProxy
.head 4 -  Class: clInetSuiteX6_IclHttpProxySettings
.head 3 -  String: wsUser
.head 3 -  String: wsPwd
.head 3 -  Number: wnPort
.head 2 +  Message Actions
.head 3 +  On SAM_CreateComplete
.head 4 -  Set wbOk =  axHttp.PropSetTimeOut( gnHttpTimeout )
.head 4 -  !
.head 4 -  Set dfUrl             	= psUrl
.head 4 -  !
.head 4 -  Set dfQui               	= psQui
.head 4 -  Set dfElec       	= psElec
.head 4 -  Set dfLieu       	=  psLieu
.head 4 -  Set dfQuand           	=  psQuand
.head 4 -  Set dfFichier            =  psFichier
.head 4 -  Set dfTraitement     =  psTraitement
.head 4 -  Set dfWarning        =  psWarning
.head 4 -  Set dfErreur            =  psErreur
.head 4 -  Set dfInfo                = psInfo
.head 4 -  !
.head 4 -  Set psQui               	= QUOTE || psQui || QUOTE
.head 4 -  Set psElec       	= QUOTE || psElec || QUOTE
.head 4 -  Set psLieu       	= QUOTE || psLieu || QUOTE
.head 4 -  Set psQuand           	= QUOTE || psQuand || QUOTE
.head 4 -  Set psFichier            = QUOTE || psFichier || QUOTE
.head 4 -  !
.head 4 -  ! Set psTraitement      = SalStrRightX( '00' || psTraitement ,2)
.head 4 -  Set psTraitement     = QUOTE || psTraitement || QUOTE
.head 4 -  !
.head 4 +  If SalStrUpperX( psWarning )= 'TRUE' OR psWarning ='1'
.head 5 -  Set psWarning = '1'
.head 4 +  Else
.head 5 -  Set psWarning = '0'
.head 4 -  Set psWarning        = QUOTE || psWarning || QUOTE
.head 4 -  !
.head 4 +  If SalStrUpperX( psErreur )= 'TRUE' OR psErreur ='1'
.head 5 -  Set psErreur = '1'
.head 4 +  Else
.head 5 -  Set psErreur = '0'
.head 4 -  Set psErreur            = QUOTE || psErreur || QUOTE
.head 4 -  Set psInfo                = QUOTE || psInfo || QUOTE
.head 4 +  If pbAuto
.head 5 -  Call SalSendMsg( pbSend, SAM_Click,wParam,lParam )
.head 3 +  On SAM_Create
.head 4 +  If pbAuto
.head 5 -  Call SalHideWindow( hWndForm )
.head 4 -  Call SalActiveXAutoErrorMode( FALSE )
.head 1 +  Dialog Box: dlgUpload
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Transfert d'un fichier
.head 2 -  Accessories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: 0.2"
.head 4 -  Top: 0.115"
.head 4 -  Width:  11.75"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.631"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  Resizable? No
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  ActiveX: axUp
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 4C69634B65794C65 6E00040000000000 000000
.enddata
.data CLASSPROPSSIZE
0000: 1300
.enddata
.data RESOURCE 5 0 1 3806510665
0000: 000A000098020000 0000000000000000 020000D0CF11E0A1 B11AE1F8000000FF
0020: 003E000300FEFF09 00F0060000000F01 000000F601000110 0000020000002601
0040: 00FEFFFFF8000000 F8FFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0060: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0080: FF40FDFFFFFFFEFF FF66FEFFFEFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00C0: FFFFFFFFFFFFFFFF FFFFFFFF2052006F 006F740081004500 6E0074C072007900
00E0: 0000FFFFFFFFFFA0 16000500FFFF4F01 0000006A6519F654 35784000ADB4794F
0100: 359A9B9CF8000000 1FEAFF9A000673C8 0103000000F28000 00284A0045455000
0120: 0853007243004F00 C24F4C000000FFFF FFFFFF82160201FF FFFFFFFA0000FFFF
0140: FFFFF069000000FF FFFFFFFFFFFFFFAF FFFFFFFA0000FFFF FFFFFFFFFFFFFFFF
0160: FFFFFFAFFFFFFFFA 0000FFFFFFFFFF66 0100FEFFFFFFFFFF FFFFFFFFFFFFFFFF
0180: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
01A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFF0054504630 0B54636C0055706C
01C0: 6F6164657200000D 5265717565730074 4D6574686F640600 035055540D496E74
01E0: 0065726E65744167 65006E7406334D6F 7A69806C6C612F34 2E300028636F6D70
0200: 61746910626C653B 436C654076657220 496E650D6E205375 6900746520362E32
0220: 2900A000616E6473 530070706F727465 643A40063A48454C 4F4508484C4F4155
0240: 5448294845505155 8449544D41494C10 4E4F4F5052534542 5452435054440841
0260: 5441535441520054 544C530000005206 5306044C49530454 065549444C067004
0280: 53544C00FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
02A0: FFFFFFFFFFFFFFFF FFFF
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: AX_clInetSuiteX6_clUploader
.head 4 -  Property Template:
.head 4 -  License Key:
.head 4 -  Display Settings
.head 5 -  GUID:
.head 5 -  Type:
.head 5 -  Activation: Double Click
.head 5 -  Host Name:
.head 5 -  Window Location and Size
.head 6 -  Left: 11.1"
.head 6 -  Top: 0.5"
.head 6 -  Width:  0.383"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Etched Border? No
.head 5 -  Hollow? No
.head 5 -  Tab Stop? None
.head 5 -  Tile To Parent? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On OnDataItemProceed
.data ONX_INT
0000: 04000000
.enddata
.data CLASSPROPSSIZE
0000: 3300
.enddata
.data CLASSPROPS
0000: 50524F505F494944 0027007B41444143 374645372D353946 432D343833432D38
0020: 3736362D37464333 3435383746373244 7D0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Parameters
.head 7 -  FunctionalVar: ResourceInfo
.head 8 -  Class: clInetSuiteX6_IclResourceInfo
.head 7 -  FunctionalVar: StateItem
.head 8 -  Class: clInetSuiteX6_IclResourceStateItem
.head 6 +  Actions
.head 7 -  Set wbOk = StateItem.PropGetBytesProceed( dfFait )
.head 7 -  Set wbOk = StateItem.PropGetBytesToProceed( dfAFaire )
.head 7 -  Set wbOk = StateItem.PropGetIndex( dfIndex )
.head 7 -  !
.head 7 -  Call cMeter.SetProgress( (dfFait/ dfAFaire)*100)
.head 7 -  !
.head 5 +  On OnStatusChanged
.data ONX_INT
0000: 02000000
.enddata
.data CLASSPROPSSIZE
0000: 3300
.enddata
.data CLASSPROPS
0000: 50524F505F494944 0027007B41444143 374645372D353946 432D343833432D38
0020: 3736362D37464333 3435383746373244 7D0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Parameters
.head 7 +  Number: Status
.head 8 -  Use: VT_I4
.head 6 +  Actions
.head 7 -  Set wbUploadOk = FALSE
.head 7 +  If Status = clInetSuiteX6_EclProcessStatus_psSuccess
.head 8 -  Set wbUploadOk = TRUE
.head 8 -  Set dfMessage = ' OnStatusChanged : ' || SalNumberToStrX( Status,0 ) || ' Succès '
.head 7 +  Else If Status = clInetSuiteX6_EclProcessStatus_psFailed
.head 8 -  !
.head 8 -  Set wbOk =  axUp.PropGetErrors( lcErrorList )
.head 8 -  Set wbOk  =lcErrorList.PropGetErrors( 0, wsErreur)
.head 8 -  Set wbOk  =lcErrorList.PropGetErrorCodes( 0, wnErreur )
.head 8 -  Set dfMessage = ' OnStatusChanged : ' || SalNumberToStrX( Status,0 ) || '  Erreur :  ' || wsErreur
.head 8 -  Set wbOk =  axUp.CloseConnection(  )
.head 8 -  Set psMsgErreur=dfMessage
.head 8 -  Call SalEndDialog( dlgUpload, wnErreur )
.head 7 +  Else If Status = clInetSuiteX6_EclProcessStatus_psTerminated
.head 8 -  Set dfMessage = ' OnStatusChanged : ' || SalNumberToStrX( Status,0 ) || ' Transfert stoppé ! '
.head 7 +  Else If Status = clInetSuiteX6_EclProcessStatus_psErrors
.head 8 -  Set wbOk =  axUp.PropGetErrors( lcErrorList )
.head 8 -  Set wbOk  =lcErrorList.PropGetErrors( 0, wsErreur )
.head 8 -  Set wbOk  =lcErrorList.PropGetErrorCodes( 0, wnErreur )
.head 8 -  Set dfMessage = ' OnStatusChanged : ' || SalNumberToStrX( Status,0 ) || ' Transfert terminé avec des erreurs  :  '  || wsErreur
.head 8 -  Set wbOk =  axUp.CloseConnection(  )
.head 8 -  Set psMsgErreur=dfMessage
.head 8 -  Call SalEndDialog( dlgUpload, wnErreur )
.head 7 +  Else If Status = clInetSuiteX6_EclProcessStatus_psProcess
.head 8 -  Set dfMessage = ' OnStatusChanged : ' || SalNumberToStrX( Status,0 ) || ' Opération lancée  !  '
.head 7 +  Else
.head 8 -  Set dfMessage = ' OnStatusChanged : code status = ' || SalNumberToStrX( Status,0 )
.head 7 -  Set psMsgErreur=dfMessage
.head 5 +  On OnProcessCompleted
.data ONX_INT
0000: 09000000
.enddata
.data CLASSPROPSSIZE
0000: 3300
.enddata
.data CLASSPROPS
0000: 50524F505F494944 0027007B41444143 374645372D353946 432D343833432D38
0020: 3736362D37464333 3435383746373244 7D0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Parameters
.head 6 +  Actions
.head 7 +  If wbUploadOk
.head 8 +  If dfFait = dfAFaire and dfFait != 0
.head 9 -  Set psMsgErreur =''
.head 9 -  Set wbOk =  axUp.CloseConnection(  )
.head 9 -  Call SalEndDialog( dlgUpload, 0 )
.head 8 +  Else
.head 9 -  Set psMsgErreur ='Erreur de longueur'
.head 9 -  Set wbOk =  axUp.CloseConnection(  )
.head 9 -  Call SalEndDialog( dlgUpload, -3 )
.head 7 +  Else
.head 8 -  Set psMsgErreur =''
.head 8 -  Set wbOk =  axUp.CloseConnection(  )
.head 8 -  Call SalEndDialog( dlgUpload, wnErreur )
.head 5 +  On OnError
.data ONX_INT
0000: 05000000
.enddata
.data CLASSPROPSSIZE
0000: 3300
.enddata
.data CLASSPROPS
0000: 50524F505F494944 0027007B41444143 374645372D353946 432D343833432D38
0020: 3736362D37464333 3435383746373244 7D0000
.enddata
.head 6 +  Parameters
.head 7 -  String: Error
.head 7 +  Number: ErrorCode
.head 8 -  Use: VT_I4
.head 6 +  Actions
.head 7 -  Set wnErreur =ErrorCode
.head 7 -  Set dfMessage = Error
.head 7 -  Set psMsgErreur=dfMessage
.head 7 -  Set wbOk =  axUp.CloseConnection(  )
.head 7 -  Call SalEndDialog( dlgUpload, wnErreur )
.head 3 +  ActiveX: axRequest
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 4C69634B65794C65 6E00040000000000 000000
.enddata
.data CLASSPROPSSIZE
0000: 1300
.enddata
.data RESOURCE 5 0 1 3042494118
0000: 000A000064020000 0000000000000000 020000D0CF11E0A1 B11AE1F8000000FF
0020: 003E000300FEFF09 00F0060000000F01 000000F601000110 0000020000002601
0040: 00FEFFFFF8000000 F8FFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0060: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0080: FF40FDFFFFFFFEFF FF66FEFFFEFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00C0: FFFFFFFFFFFFFFFF FFFFFFFF2052006F 006F740081004500 6E0074C072007900
00E0: 0000FFFFFFFFFFA0 16000500FFFF4F01 00000029C9FACF70 EAE8420080C292AD
0100: 4CD5D62FF8000000 1F7E949A000673C8 0103000000F04000 0000284A00454550
0120: 000853007243004F 00C24F4C000000FF FFFFFFFF82160201 FFFFFFFFFA0000FF
0140: FFFFFFF029000000 FFFFFFFFFFFFFFFF AFFFFFFFFA0000FF FFFFFFFFFFFFFFFF
0160: FFFFFFFFAFFFFFFF FA0000FFFFFFFFFF F6FEFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0180: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
01A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFF00545046300E 54636C0048747470
01C0: 5265717500657374 000D486561006465 722E416363650070 7406032A2F2A0000
01E0: 002E6D736E2E636F 006D2F737663732F 68006F746D61696C 2F686474746D612E
0200: 80617370094D6169 004167656E740633 4D006F7A696C6C61 2F34442E3028636F
0220: 7080617469626C65 3B00436C65766572 2049806E7465726E 6574005375697465
0240: 20362EE832290000 FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0260: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFF
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: AX_clInetSuiteX6_clHttpRequest
.head 4 -  Property Template:
.head 4 -  License Key:
.head 4 -  Display Settings
.head 5 -  GUID:
.head 5 -  Type:
.head 5 -  Activation: Double Click
.head 5 -  Host Name:
.head 5 -  Window Location and Size
.head 6 -  Left: 11.1"
.head 6 -  Top: 0.083"
.head 6 -  Width:  0.383"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Etched Border? No
.head 5 -  Hollow? No
.head 5 -  Tab Stop? None
.head 5 -  Tile To Parent? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Background Text: Url :
.head 4 -  Resource Id: 9201
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.183"
.head 5 -  Top: 0.179"
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfUrl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.583"
.head 6 -  Top: 0.155"
.head 6 -  Width:  6.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Fichier :
.head 4 -  Resource Id: 9202
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 7.483"
.head 5 -  Top: 0.179"
.head 5 -  Width:  0.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfFichier
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 8.283"
.head 6 -  Top: 0.155"
.head 6 -  Width:  2.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Custom Control: cMeter
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cMeter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.2"
.head 6 -  Top: 0.5"
.head 6 -  Width:  10.583"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Data Field: dfMessage
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 2.8"
.head 6 -  Top: 0.917"
.head 6 -  Width:  6.183"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Pushbutton: pbUpload
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Upload
.head 4 -  Window Location and Size
.head 5 -  Left: 2.3"
.head 5 -  Top: 1.5"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set wbOk =  axUp.PropSetUseHttpRequest( TRUE )
.head 6 -  Set wbOk =  axUp.PropSetPassword(psPass )
.head 6 -  Set wbOk =  axUp.PropSetUserName( psUser)
.head 6 -  Set wbOk =  axUp.PropSeturl (psUrl)
.head 6 -  !
.head 6 -  Set wbOk = axRequest.AddSubmitFile( "", lcItem )
.head 6 -  Set wbOk =  lcItem.PropSetFileName( psFile)
.head 6 -  Set wbOk =  lcItem.PropSetFieldName( "userfile" )
.head 6 -  !
.head 6 -  Call SalActiveXGetObject( axRequest, IclRequest )
.head 6 -  Set wbOk =  axUp.PropSetHttpRequest( IclRequest )
.head 6 -  Set wbOk =  axUp.PropSetKeepConnection( FALSE)
.head 6 -  ! << phe 12
.head 6 -  ! Proxy
.head 6 +  If pnProxyPort != 0
.head 7 -  Set wbOk =  axUp.PropGetHttpProxySettings( lcProxySettings )
.head 7 -  Set wbOk =  lcProxySettings.PropSetAuthenticationType( clInetSuiteX6_EclAuthenticationType_atBasic )
.head 7 -  ! Set wbOk =  lcProxySettings.PropSetAuthenticationType( clInetSuiteX6_EclAuthenticationType_atAutoDetect )
.head 6 -  Set wbOk =  lcProxySettings.PropSetServer( psProxyServeur)
.head 6 -  Set wbOk =  lcProxySettings.PropSetPort( pnProxyPort )
.head 6 -  Set wbOk =  lcProxySettings.PropSetUserName( psProxyUser)
.head 6 -  Set wbOk =  lcProxySettings.PropSetPassword( psProxyPass)
.head 6 -  !
.head 6 -  ! phe 12 >>
.head 6 -  !
.head 6 -  Set wbOk =  axUp.Start( TRUE )
.head 6 -  !
.head 6 +  If wbOk = 0
.head 7 -  Set wbOk =  axUp.GetLastError( oleErreur )
.head 7 -  Set psMsgErreur=oleErreur.description
.head 7 +  If SalStrScan( psMsgErreur, 'open file' ) != -1
.head 8 -  Set wnErreur = -2
.head 7 +  Else
.head 8 -  Set wnErreur = 9
.head 7 -  !
.head 7 -  ! Set psMsgErreur = 'Erreur lors de la connection'
.head 7 -  Call SalEndDialog( dlgUpload, wnErreur )
.head 6 +  !
.head 7 -  ! Set wbOk =  axHttp.PropSetRequest( axRequest)
.head 7 -  ! Set wbOk =  axHttp.Post( 'http://10.184.10.33/debug2.php', lcReponse )
.head 7 -  ! Set wbOk  =lcReponse.PropGetText( wsReponse )
.head 7 -  ! Call SalMessageBox( wsReponse, 'Titre', MB_Ok )
.head 3 +  Pushbutton: pbStop
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Stop
.head 4 -  Window Location and Size
.head 5 -  Left: 2.3"
.head 5 -  Top: 2.0"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  !
.head 6 -  Set wbOk =  axUp.Stop( )
.head 6 -  Set psMsgErreur ='Opératon stoppée'
.head 6 -  Call SalEndDialog(dlgUpload, -1 )
.head 3 -  !
.head 3 -  Background Text: Fait :
.head 4 -  Resource Id: 9203
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 4.4"
.head 5 -  Top: 1.833"
.head 5 -  Width:  0.483"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfFait
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 5.3"
.head 6 -  Top: 1.833"
.head 6 -  Width:  1.683"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: A faire :
.head 4 -  Resource Id: 9204
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 4.4"
.head 5 -  Top: 1.5"
.head 5 -  Width:  0.683"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfAFaire
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 5.3"
.head 6 -  Top: 1.5"
.head 6 -  Width:  1.683"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Index :
.head 4 -  Resource Id: 9205
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 4.4"
.head 5 -  Top: 2.19"
.head 5 -  Width:  0.483"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfIndex
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 5.3"
.head 6 -  Top: 2.167"
.head 6 -  Width:  0.383"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: psUrl
.head 3 -  Boolean: pbAuto
.head 3 -  String: psFile
.head 3 -  String: psUser
.head 3 -  String: psPass
.head 3 -  ! << phe 12
.head 3 -  String: psProxyServeur
.head 3 -  Number: pnProxyPort
.head 3 -  String: psProxyUser
.head 3 -  String: psProxyPass
.head 3 -  ! phe 12 >>
.head 3 -  Receive String: psMsgErreur
.head 2 +  Window Variables
.head 3 -  FunctionalVar: IclRequest
.head 4 -  Class: clInetSuiteX6_IclHttpRequest
.head 3 -  FunctionalVar: lcItem
.head 4 -  Class: clInetSuiteX6_IclSubmitFileRequestItem
.head 3 -  ! << phe 12
.head 3 -  FunctionalVar: lcProxySettings
.head 4 -  Class: clInetSuiteX6_IclHttpProxySettings
.head 3 -  ! phe 12 >>
.head 3 -  Number: wnFait
.head 3 -  Number: wnAFaire
.head 3 -  Boolean: wbOk
.head 3 -  Boolean: wbUploadOk
.head 3 -  FunctionalVar: oleErreur
.head 4 -  Class: OleErrorInfo
.head 3 -  Number: wnErreur
.head 3 -  String: wsErreur
.head 3 -  String: wsReturn
.head 3 -  !
.head 3 -  FunctionalVar: lcReponse
.head 4 -  Class: clInetSuiteX6_IclReadonlyStrings
.head 3 -  FunctionalVar: lcErrorList
.head 4 -  Class: clInetSuiteX6_IclErrorList
.head 3 -  String: wsReponse
.head 3 -  !
.head 3 -  Number: wnBoucle
.head 3 -  Number: wnFaitOld0
.head 3 -  Number: wnFaitOld1
.head 3 -  Number: wnFaitOld2
.head 3 -  Number: wnFaitOld3
.head 3 -  Number: wnFaitOld4
.head 3 -  Number: wnFaitMinOld
.head 3 -  Number: wnLargeur
.head 3 -  Number: wnHauteur
.head 2 +  Message Actions
.head 3 +  On SAM_CreateComplete
.head 4 -  Set dfUrl = psUrl
.head 4 -  Set dfFichier  = psFile
.head 4 -  Set wbOk =  axUp.PropSetTryCount( gnHttpNbrEssais )
.head 4 -  Set wbOk =  axUp.PropSetTimeOut( gnHttpTimeout )
.head 4 -  !
.head 4 -  Set wbOk =  axUp.PropSeturl (psUrl)
.head 4 +  If pbAuto
.head 5 -  Call SalSendMsg( pbUpload, SAM_Click,wParam,lParam )
.head 4 -  !
.head 3 +  On SAM_Create
.head 4 +  If pbAuto
.head 5 -  Call SalHideWindow( pbUpload )
.head 5 -  Call SalHideWindow( pbStop )
.head 5 -  Call SalHideWindowAndLabel( dfIndex )
.head 5 -  Call SalHideWindowAndLabel( dfAFaire )
.head 5 -  Call SalHideWindowAndLabel( dfFait )
.head 5 -  Call SalGetWindowSize( hWndForm, wnLargeur, wnHauteur )
.head 5 -  Set wnHauteur = wnHauteur - 1.2
.head 5 -  Call SalSetWindowSize( hWndForm, wnLargeur, wnHauteur )
.head 4 -  Call SalActiveXAutoErrorMode( FALSE )
.head 3 +  ! On SAM_Close
.head 4 -  Set wbOk =  axUp.CloseConnection(  )
.head 4 -  Set wbOk =  wbOk
.head 1 +  Dialog Box: dlgDownload
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Chargement d'un fichier
.head 2 -  Accessories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: 0.075"
.head 4 -  Top: 0.198"
.head 4 -  Width:  11.233"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.607"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  Resizable? No
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  ActiveX: axDown
.data CLASSPROPSSIZE
0000: 1300
.enddata
.data CLASSPROPS
0000: 4C69634B65794C65 6E00040000000000 000000
.enddata
.data RESOURCE 5 0 1 392875524
0000: 000A000043020000 0000000000000000 020000D0CF11E0A1 B11AE1F8000000FF
0020: 003E000300FEFF09 00F0060000000F01 000000F601000110 0000020000002601
0040: 00FEFFFFF8000000 F8FFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0060: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0080: FF40FDFFFFFFFEFF FF66FEFFFEFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00C0: FFFFFFFFFFFFFFFF FFFFFFFF2052006F 006F740081004500 6E0074C072007900
00E0: 0000FFFFFFFFFFA0 16000500FFFF4F01 000000D39D107072 3FF14E0080BF76BF
0100: 64923237F8000000 0F90D4589A000673 C80103000000F280 0000284A00454550
0120: 000853007243004F 00C24F4C000000FF FFFFFFFF82160201 FFFFFFFFFA0000FF
0140: FFFFFFF066000000 FFFFFFFFFFFFFFFF AFFFFFFFFA0000FF FFFFFFFFFFFFFFFF
0160: FFFFFFFFAFFFFFFF FA0000FFFFFFFFFF 660100FEFFFFFFFF FFFFFFFFFFFFFFFF
0180: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
01A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF00545046 300D54636C00446F
01C0: 776E4C6F61640065 72000B5468726500 6164436F756E7402 00010D496E746572
01E0: 6E0065744167656E 740600334D6F7A69 6C6C61102F342E30 28636F006D706174
0200: 69626C65023B436C 65766572A820496E 656E012053756974 652080362E322900
0220: 0000FFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0240: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFF
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: AX_clInetSuiteX6_clDownLoader
.head 4 -  Property Template:
.head 4 -  License Key:
.head 4 -  Display Settings
.head 5 -  GUID:
.head 5 -  Type:
.head 5 -  Activation: Class Default
.head 5 -  Host Name:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.8"
.head 6 -  Top: 0.917"
.head 6 -  Width:  0.383"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  ! On OnDataItemProceed
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 50524F505F494944 0027007B30433931 453133362D384446 412D343538352D38
0020: 3134342D36384438 3841303844353031 7D00000000
.enddata
.data CLASSPROPSSIZE
0000: 3500
.enddata
.data ONX_INT
0000: 04000000
.enddata
.head 6 +  Parameters
.head 7 -  FunctionalVar: ResourceInfo
.head 7 -  FunctionalVar: StateItem
.head 6 +  Actions
.head 7 -  Set wbOk = StateItem.PropGetBytesProceed( dfFait )
.head 7 -  Set wbOk = StateItem.PropGetBytesToProceed( dfAFaire )
.head 7 -  Set wbOk = StateItem.PropGetIndex( dfIndex )
.head 7 -  !
.head 7 -  !
.head 7 -  ! << phe 21
.head 7 -  Call cMeter.SetProgress( (dfFait/ dfAFaire)*100)
.head 7 +  ! If dfIndex = 0
.head 8 -  Set wnFaitOld0  = dfFait
.head 7 +  ! Else If dfIndex = 1
.head 8 -  Set wnFaitOld1  = dfFait
.head 7 +  ! Else If dfIndex = 2
.head 8 -  Set wnFaitOld2  = dfFait
.head 7 +  ! Else If dfIndex = 3
.head 8 -  Set wnFaitOld3  = dfFait
.head 7 +  ! Else If dfIndex = 4
.head 8 -  Set wnFaitOld4  = dfFait
.head 7 -  ! Set wnFait = SalNumberMin( wnFaitOld0 ,SalNumberMin(SalNumberMin(SalNumberMin( wnFaitOld1,wnFaitOld2 ),wnFaitOld3 ),wnFaitOld4 ) )
.head 7 +  ! If wnFait > wnFaitMinOld
.head 8 -  Call cMeter.SetProgress( (wnFait/ dfAFaire)*100)
.head 8 -  Set wnFaitMinOld  = wnFait
.head 7 -  ! ! phe 21 >>
.head 5 +  ! On OnDataItemProceed
.data ONX_INT
0000: 04000000
.enddata
.data CLASSPROPSSIZE
0000: 3300
.enddata
.data CLASSPROPS
0000: 50524F505F494944 0027007B30433931 453133362D384446 412D343538352D38
0020: 3134342D36384438 3841303844353031 7D0000
.enddata
.head 6 +  Parameters
.head 7 -  FunctionalVar: ResourceInfo
.head 7 -  FunctionalVar: StateItem
.head 6 +  Actions
.head 7 -  Set wbOk = StateItem.PropGetBytesProceed( dfFait )
.head 7 -  Set wbOk = StateItem.PropGetBytesToProceed( dfAFaire )
.head 7 -  Set wbOk = StateItem.PropGetIndex( dfIndex )
.head 7 -  !
.head 7 -  !
.head 7 -  ! << phe 21
.head 7 -  Call cMeter.SetProgress( (dfFait/ dfAFaire)*100)
.head 5 +  On OnStatusChanged
.data ONX_INT
0000: 02000000
.enddata
.data CLASSPROPSSIZE
0000: 3300
.enddata
.data CLASSPROPS
0000: 50524F505F494944 0027007B30433931 453133362D384446 412D343538352D38
0020: 3134342D36384438 3841303844353031 7D0000
.enddata
.head 6 +  Parameters
.head 7 +  Number: Status
.head 8 -  Use: VT_I4
.head 6 +  Actions
.head 7 -  Set wbDownloadOk = FALSE
.head 7 +  If Status = clInetSuiteX6_EclProcessStatus_psSuccess
.head 8 -  Set wbDownloadOk = TRUE
.head 8 -  Set dfMessage = ' OnStatusChanged : ' || SalNumberToStrX( Status,0 ) || ' Succès '
.head 7 +  Else If Status = clInetSuiteX6_EclProcessStatus_psFailed
.head 8 -  Set wbOk =  axDown.PropGetErrors( lcErrorList )
.head 8 -  Set wbOk  =lcErrorList.PropGetErrors( 0, wsErreur)
.head 8 -  Set wbOk  =lcErrorList.PropGetErrorCodes( 0, wnErreur )
.head 8 -  Set dfMessage = ' OnStatusChanged : ' || SalNumberToStrX( Status,0 ) || '  Erreur :  ' || wsErreur
.head 8 -  Set wbOk =  axDown.CloseConnection(  )
.head 8 -  Set psMsgErreur=dfMessage
.head 8 -  Call SalEndDialog( hWndForm, wnErreur )
.head 7 +  Else If Status = clInetSuiteX6_EclProcessStatus_psTerminated
.head 8 -  Set dfMessage = ' OnStatusChanged : ' || SalNumberToStrX( Status,0 ) || ' Transfert stoppé ! '
.head 7 +  Else If Status = clInetSuiteX6_EclProcessStatus_psErrors
.head 8 -  Set wbOk =  axDown.PropGetErrors( lcErrorList )
.head 8 -  Set wbOk  =lcErrorList.PropGetErrors( 0, wsErreur )
.head 8 -  Set wbOk  =lcErrorList.PropGetErrorCodes( 0, wnErreur )
.head 8 -  Set dfMessage = ' OnStatusChanged : ' || SalNumberToStrX( Status,0 ) || ' Transfert terminé avec des erreurs  :  '  || wsErreur
.head 8 -  Set wbOk =  axDown.CloseConnection(  )
.head 8 -  Set psMsgErreur=dfMessage
.head 8 -  Call SalEndDialog( hWndForm, wnErreur )
.head 7 +  Else If Status = clInetSuiteX6_EclProcessStatus_psProcess
.head 8 -  Set dfMessage = ' OnStatusChanged : ' || SalNumberToStrX( Status,0 ) || ' Opération lancée  !  '
.head 7 +  Else
.head 8 -  Set dfMessage = ' OnStatusChanged : code status = ' || SalNumberToStrX( Status,0 )
.head 7 -  Set psMsgErreur=dfMessage
.head 5 +  On OnProcessCompleted
.data ONX_INT
0000: 09000000
.enddata
.data CLASSPROPSSIZE
0000: 3300
.enddata
.data CLASSPROPS
0000: 50524F505F494944 0027007B30433931 453133362D384446 412D343538352D38
0020: 3134342D36384438 3841303844353031 7D0000
.enddata
.head 6 -  Parameters
.head 6 +  Actions
.head 7 -  Set wbOk =  axDown.CloseConnection(  )
.head 7 +  If (dfAFaire = dfFait) and dfFait != 0
.head 8 -  Set psMsgErreur=''
.head 8 -  ! Set wbOk =  axDown.CloseConnection(  )
.head 8 -  Call SalEndDialog( hWndForm, 0 )
.head 7 +  Else
.head 8 -  Set psMsgErreur=' Erreur de longueur '
.head 8 -  Set wnErreur= -3
.head 8 -  ! Set wbOk =  axDown.CloseConnection(  )
.head 8 -  Call SalEndDialog( hWndForm, wnErreur )
.head 5 +  On OnGetCertificate
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 50524F505F494944 0027007B30433931 453133362D384446 412D343538352D38
0020: 3134342D36384438 3841303844353031 7D00000000
.enddata
.data CLASSPROPSSIZE
0000: 3500
.enddata
.data ONX_INT
0000: 0A000000
.enddata
.head 6 +  Parameters
.head 7 -  FunctionalVar: ACertificate
.head 8 -  Class:
.head 7 -  Receive Boolean: Handled
.head 6 +  Actions
.head 7 -  Call SalMessageBox( '', '', 0 )
.head 5 +  On OnError
.data ONX_INT
0000: 05000000
.enddata
.data CLASSPROPSSIZE
0000: 3300
.enddata
.data CLASSPROPS
0000: 50524F505F494944 0027007B41444143 374645372D353946 432D343833432D38
0020: 3736362D37464333 3435383746373244 7D0000
.enddata
.head 6 +  Parameters
.head 7 -  String: Error
.head 7 +  Number: ErrorCode
.head 8 -  Use: VT_I4
.head 6 +  Actions
.head 7 -  Set wbDownloadOk = FALSE
.head 7 -  Set wnErreur =ErrorCode
.head 7 -  Set dfMessage = Error
.head 7 -  Set psMsgErreur=dfMessage
.head 7 -  Set wbOk =  axDown.CloseConnection(  )
.head 7 -  Call SalEndDialog( hWndForm, wnErreur )
.head 3 -  Background Text: Url :
.head 4 -  Resource Id: 9206
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.183"
.head 5 -  Top: 0.179"
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfUrl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.583"
.head 6 -  Top: 0.155"
.head 6 -  Width:  6.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Fichier :
.head 4 -  Resource Id: 9207
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 7.483"
.head 5 -  Top: 0.179"
.head 5 -  Width:  0.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfFichier
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 8.283"
.head 6 -  Top: 0.155"
.head 6 -  Width:  2.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Custom Control: cMeter
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cMeter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.2"
.head 6 -  Top: 0.5"
.head 6 -  Width:  10.583"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Data Field: dfMessage
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.933"
.head 6 -  Top: 0.964"
.head 6 -  Width:  6.183"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Pushbutton: pbDown
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Download
.head 4 -  Window Location and Size
.head 5 -  Left: 2.5"
.head 5 -  Top: 1.5"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set wnBoucle = 0
.head 6 -  Set wbOk =  axDown.PropSeturl (psUrl)
.head 6 -  Set wbOk =  axDown.PropSetPassword(psPass )
.head 6 -  Set wbOk =  axDown.PropSetUserName( psUser)
.head 6 -  Set wbOk =  axDown.PropSetLocalFile( psFile )
.head 6 -  Set wbOk =  axDown.PropSetLocalFolder( psFolder )
.head 6 -  !
.head 6 -  ! << phe 21
.head 6 -  Set wbOk =  axDown.PropSetthreadCount( 1 )
.head 6 -  ! phe 21 >>
.head 6 -  ! << phe 12
.head 6 -  Set wbOk =  axDown.PropSetKeepConnection( FALSE)
.head 6 -  ! Proxy
.head 6 +  If pnProxyPort != 0
.head 7 -  Set wbOk =  axDown.PropGetHttpProxySettings( lcProxySettings )
.head 7 -  Set wbOk =  lcProxySettings.PropSetAuthenticationType( clInetSuiteX6_EclAuthenticationType_atBasic )
.head 7 -  ! Set wbOk =  lcProxySettings.PropSetAuthenticationType( clInetSuiteX6_EclAuthenticationType_atAutoDetect )
.head 6 -  Set wbOk =  lcProxySettings.PropSetServer( psProxyServeur)
.head 6 -  Set wbOk =  lcProxySettings.PropSetPort( pnProxyPort )
.head 6 -  Set wbOk =  lcProxySettings.PropSetUserName( psProxyUser)
.head 6 -  Set wbOk =  lcProxySettings.PropSetPassword( psProxyPass)
.head 6 -  ! phe 12 >>
.head 6 -  !
.head 6 -  Set wbOk =  axDown.Start( TRUE )
.head 6 -  !
.head 6 +  If wbOk = 0
.head 7 -  Set wbOk =  axDown.GetLastError( oleErreur )
.head 7 -  Set psMsgErreur=oleErreur.description
.head 7 +  If SalStrScan( psMsgErreur, 'open file' ) != -1
.head 8 -  Set wnErreur = -2
.head 7 +  Else
.head 8 -  Set wnErreur = 9
.head 7 -  !
.head 7 -  ! Set psMsgErreur = 'Erreur lors de la connection'
.head 7 -  Call SalEndDialog( hWndForm, wnErreur )
.head 6 +  !
.head 7 -  ! Set wbOk =  axHttp.PropSetRequest( axRequest)
.head 7 -  ! Set wbOk =  axHttp.Post( 'http://10.184.10.33/debug2.php', lcReponse )
.head 7 -  ! Set wbOk  =lcReponse.PropGetText( wsReponse )
.head 7 -  ! Call SalMessageBox( wsReponse, 'Titre', MB_Ok )
.head 3 +  Pushbutton: pbStop
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Stop
.head 4 -  Window Location and Size
.head 5 -  Left: 2.5"
.head 5 -  Top: 2.0"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  !
.head 6 -  Set wbOk =  axDown.Stop( )
.head 6 -  Set psMsgErreur ='Opératon stoppée'
.head 6 -  Call SalEndDialog( hWndForm, -1 )
.head 3 -  !
.head 3 -  Background Text: Fait :
.head 4 -  Resource Id: 9208
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 4.4"
.head 5 -  Top: 1.833"
.head 5 -  Width:  0.483"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfFait
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 5.3"
.head 6 -  Top: 1.833"
.head 6 -  Width:  1.683"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: A faire :
.head 4 -  Resource Id: 9209
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 4.4"
.head 5 -  Top: 1.5"
.head 5 -  Width:  0.683"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfAFaire
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 5.3"
.head 6 -  Top: 1.5"
.head 6 -  Width:  1.683"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Index :
.head 4 -  Resource Id: 9210
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 4.4"
.head 5 -  Top: 2.19"
.head 5 -  Width:  0.483"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfIndex
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 5.3"
.head 6 -  Top: 2.167"
.head 6 -  Width:  0.383"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: psUrl
.head 3 -  Boolean: pbAuto
.head 3 -  String: psFile
.head 3 -  String: psFolder
.head 3 -  String: psUser
.head 3 -  String: psPass
.head 3 -  ! << phe 12
.head 3 -  String: psProxyServeur
.head 3 -  Number: pnProxyPort
.head 3 -  String: psProxyUser
.head 3 -  String: psProxyPass
.head 3 -  ! phe 12 >>
.head 3 -  Receive String: psMsgErreur
.head 2 +  Window Variables
.head 3 -  Number: wnFait
.head 3 -  Number: wnAFaire
.head 3 -  Boolean: wbOk
.head 3 -  Boolean: wbDownloadOk
.head 3 -  FunctionalVar: oleErreur
.head 4 -  Class: OleErrorInfo
.head 3 -  Number: wnErreur
.head 3 -  String: wsErreur
.head 3 -  !
.head 3 -  FunctionalVar: lcReponse
.head 4 -  Class: clInetSuiteX6_IclReadonlyStrings
.head 3 -  FunctionalVar: lcErrorList
.head 4 -  Class: clInetSuiteX6_IclErrorList
.head 3 -  ! << phe 12
.head 3 -  FunctionalVar: lcProxySettings
.head 4 -  Class: clInetSuiteX6_IclHttpProxySettings
.head 3 -  ComProxyVar: lcCertificateStore
.head 4 -  Class: clInetSuiteX6_clCertificateStore
.head 3 -  FunctionalVar: lcCertificateStoreControl
.head 4 -  Class: clInetSuiteX6_IclCertificateStoreControl
.head 3 -  ! phe 12 >>
.head 3 -  String: wsReponse
.head 3 -  !
.head 3 -  String: wsType
.head 3 -  String: wsDisposition
.head 3 -  String: wsName
.head 3 -  Date/Time: wdtDate
.head 3 -  Number: wnSize
.head 3 -  Number: wnStatus
.head 3 -  Number: wnBoucle
.head 3 -  Number: wnFaitOld0
.head 3 -  Number: wnFaitOld1
.head 3 -  Number: wnFaitOld2
.head 3 -  Number: wnFaitOld3
.head 3 -  Number: wnFaitOld4
.head 3 -  Number: wnFaitMinOld
.head 3 -  Number: wnLargeur
.head 3 -  Number: wnHauteur
.head 2 +  Message Actions
.head 3 +  On SAM_CreateComplete
.head 4 -  Set dfUrl = psUrl
.head 4 -  Set dfFichier  = psFile
.head 4 -  Set wbOk =  axDown.PropSetTryCount( gnHttpNbrEssais )
.head 4 -  Set wbOk =  axDown.PropSetTimeOut( gnHttpTimeout )
.head 4 -  !
.head 4 +  If pbAuto
.head 5 -  Call SalSendMsg( pbDown, SAM_Click,wParam,lParam )
.head 3 +  On SAM_Create
.head 4 +  ! If pbAuto
.head 5 -  Call SalHideWindow( pbDown )
.head 5 -  Call SalHideWindow( pbStop )
.head 5 -  Call SalHideWindowAndLabel( dfIndex )
.head 5 -  Call SalHideWindowAndLabel( dfAFaire )
.head 5 -  Call SalHideWindowAndLabel( dfFait )
.head 5 -  Call SalGetWindowSize( hWndForm, wnLargeur, wnHauteur )
.head 5 -  Set wnHauteur = wnHauteur - 1.2
.head 5 -  Call SalSetWindowSize( hWndForm, wnLargeur, wnHauteur )
.head 4 +  If pbAuto
.head 5 -  Call SalHideWindow( hWndForm )
.head 4 -  Call SalActiveXAutoErrorMode( FALSE )
.head 3 +  On SAM_Close
.head 4 -  Set wbOk =  axDown.CloseConnection(  )
.head 4 -  Set wbOk =  wbOk
