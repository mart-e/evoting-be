.head 0 +  Application Description: Gupta SQLWindows Standard Application Template
.data CLASSPROPSSIZE
0000: 4500
.enddata
.data CLASSPROPS
0000: 557365476C6F6261 6C50617468000400 0100000000417070 506174684C656E00
0020: 04000D0000000041 707050617468000D 00433A5C505F4C69 6233322E34320000
0040: 0000000000
.enddata
.head 1 -  Outline Version - 4.0.35
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000007000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000050100 002C000000020000 0003000000FFFFFF FFFFFFFFFFFCFFFF
0040: FFE9FFFFFFFFFFFF FF000000007C0200 004D010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000000001 8002000200000000
0080: 000000000000002C 0000000000000001 000000FFFFFFFFFF FFFFFFFCFFFFFFE9
00A0: FFFFFF6E0000006E 00000050040000BE 0200000000000000 000000050000000F
00C0: 4170706C69636174 696F6E4974656D07 57696E646F77730E 646C67436F636B70
00E0: 6974416964650D43 68696C642057696E 646F77730F706254 6573745265636570
0100: 74696F6E00000000 0180020002000000 0000000000000000 2C00000000000000
0120: 01000000FFFFFFFF FFFFFFFFFCFFFFFF E9FFFFFF84000000 8400000066040000
0140: D402000000000000 0000000005000000 0F4170706C696361 74696F6E4974656D
0160: 0757696E646F7773 0E646C67436F636B 706974416964650D 4368696C64205769
0180: 6E646F77730B7062 54657374456E766F 6900000000018002 0001000000000000
01A0: 00000000002C0000 0000000000010000 00FFFFFFFFFFFFFF FFFCFFFFFFE9FFFF
01C0: FF6E0000006E0000 0050040000BE0200 0000000000000000 00030000000F4170
01E0: 706C69636174696F 6E4974656D12496E 7465726E616C2046 756E6374696F6E73
0200: 0D50616C55706C6F 616446696C650000 0000018002000200 0000000000000000
0220: 00002C0000000000 000001000000FFFF FFFFFFFFFFFFFCFF FFFFE9FFFFFF8400
0240: 0000840000006604 0000D40200000000 0000000000000300 00000F4170706C69
0260: 636174696F6E4974 656D12496E746572 6E616C2046756E63 74696F6E730F5061
0280: 6C446F776E6C6F61 6446696C65000000 0001800400010000 0000000000B90000
02A0: 002C000000000000 0001000000FFFFFF FFFFFFFFFFFCFFFF FFE9FFFFFF6E0000
02C0: 006E000000D10200 003C020000000000 0000000000030000 000F4170706C6963
02E0: 6174696F6E497465 6D0757696E646F77 730E646C67436F63 6B70697441696465
0300: 00000000
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left: -0.013"
.head 3 -  Top: 0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: D4180909B80B1A00
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left: 4.15"
.head 3 -  Top: 1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left: 0.575"
.head 3 -  Top: 0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left: 6.388"
.head 3 -  Top: 0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 2 -  Edit Fields Read Only On Disable? No
.head 1 +  Libraries
.head 2 -  File Include: Clever Internet Suite.apl
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 2 -  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 -  User
.head 3 -  Enumerations
.head 2 +  Resources
.head 3 +  Bitmap: resExitWinCock
.head 4 -  File Name: Exit_Menu.bmp
.head 3 +  Bitmap: resEID
.head 4 -  File Name: EID.bmp
.head 3 +  Bitmap: resEID2
.head 4 -  File Name: EID2.bmp
.head 3 +  Bitmap: resModi
.head 4 -  File Name: Modi.bmp
.head 2 +  Variables
.head 3 -  ! ! ! ! http, https, proxy
.head 3 -  ! ! ! ! gsHttpType = 0 -> http, 1 -> https
.head 3 -  String: gsHttpType
.head 3 -  Boolean: gbHttpActif
.head 3 -  ! ! ! ! http
.head 3 -  String: gsHttpCockpit
.head 3 -  String: gsHttpUp
.head 3 -  String: gsHttpDown
.head 3 -  ! ! ! ! https
.head 3 -  String: gsHttpsCockpit
.head 3 -  String: gsHttpsUp
.head 3 -  String: gsHttpsDown
.head 3 -  String: gsHttpsLogin
.head 3 -  String: gsHttpsPwd
.head 3 -  ! ! ! ! proxy
.head 3 -  String: gsProxyServeur
.head 3 -  Number: gnProxyPort
.head 3 -  String: gsProxyUser
.head 3 -  String: gsProxyPass
.head 3 -  Number: gnHttpNbrEssais
.head 3 -  Number: gnHttpTimeout
.head 3 -  String: gsHTTPMessage[*]
.head 3 -  ! Cockpit
.head 3 -  String: gsCurrentABC
.head 3 -  String: gsCockpitUrl[5]
.head 3 -  String: gsCockpitUrls[5]
.head 3 -  ! Upload
.head 3 -  String: gsUploadUrl[5]
.head 3 -  String: gsUploadUrls[5]
.head 3 -  ! Download
.head 3 -  String: gsDownloadUrl[5]
.head 3 -  String: gsDownloadUrls[5]
.head 3 -  ! Secure
.head 3 -  String: gsHttpsLogins[5]
.head 3 -  String: gsHttpsPwds[5]
.head 3 -  !
.head 3 -  String: gsMsgErreurHttp
.head 3 -  !
.head 3 -  Number: gnMsgNo
.head 3 -  !
.head 3 -  ! Ligne A,B,C ou juste C ?
.head 3 -  Boolean: gbInterne
.head 3 -  !
.head 3 -  ! Si NOT gbInterne -> test des 3 lignes en cascade (ne s'arrête pas si OK)
.head 3 -  Boolean: gbHttpOnAllLines
.head 2 +  Internal Functions
.head 3 -  ! fichier .ini
.head 3 +  Function: PalHttpIniRead
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sPathINI
.head 5 -  String: sPathINI_Msg
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: lsMsg
.head 5 -  File Handle: lhFile
.head 5 -  Boolean: lbContinue
.head 5 -  String: lsPath
.head 5 -  Number: lnI
.head 4 +  Actions
.head 5 -  !
.head 5 -  Call VisWaitCursor( TRUE )
.head 5 -  Set lbContinue = TRUE
.head 5 +  If lbContinue
.head 6 -  ! Set gnHttpNbrEssais =3
.head 6 -  ! Set gnHttpTimeout =3000
.head 6 -  Set gsHttpUp = ''
.head 6 -  Set gsHttpDown = ''
.head 6 -  Set gsHttpCockpit = ''
.head 6 -  Set gsHttpsUp = ''
.head 6 -  Set gsHttpsDown = ''
.head 6 -  Set gsHttpsLogin = ''
.head 6 -  Set gsHttpsPwd = ''
.head 6 -  Set gsHttpsLogin = ''
.head 6 -  Set gsHttpsPwd = ''
.head 6 -  Set lnI = 0
.head 6 +  While lnI < 5
.head 7 -  ! Cockpit
.head 7 -  Set gsCockpitUrl[lnI] = ''
.head 7 -  Set gsCockpitUrls[lnI] = ''
.head 7 -  ! Download
.head 7 -  Set gsDownloadUrl[lnI] = ''
.head 7 -  Set gsDownloadUrls[lnI] = ''
.head 7 -  ! Upoad
.head 7 -  Set gsUploadUrl[lnI] = ''
.head 7 -  Set gsUploadUrls[lnI] = ''
.head 7 -  ! HTTPS
.head 7 -  Set gsHttpsLogins[lnI] = ''
.head 7 -  Set gsHttpsPwds[lnI] = ''
.head 7 -  !
.head 7 -  Set lnI = lnI +1
.head 6 -  ! PROXY
.head 6 -  Set gsProxyServeur = ''
.head 6 -  Set gnProxyPort = 0
.head 6 -  Set gsProxyUser = ''
.head 6 -  Set gsProxyPass = ''
.head 5 -  !
.head 5 -  ! Http, https
.head 5 -  Call SalGetProfileString( 'HTTP_TYPE', 'HTTP_TYPE',  '0', gsHttpType, sPathINI )
.head 5 -  !
.head 5 -  ! Activé ?
.head 5 -  Set gbHttpActif = SalGetProfileInt( 'HTTP_TYPE', 'HTTP_ON', 1, sPathINI )
.head 5 -  !
.head 5 +  If NOT SalFileOpen( lhFile, sPathINI, OF_Exist )
.head 6 -  Set lsMsg = "Can't find " || sPathINI
.head 6 -  Set lbContinue =  FALSE
.head 5 -  !
.head 5 -  ! HTTP & HTTPS
.head 5 +  If lbContinue
.head 6 -  Set lnI = 1
.head 6 +  While lnI <= 3
.head 7 -  Call SalGetProfileString( 'HTTP', 'HTTP_COCKPIT_'|| SalNumberToStrX( lnI, 0), gsCockpitUrl[1], gsCockpitUrl[lnI], sPathINI  )
.head 7 -  Call SalGetProfileString( 'HTTP', 'HTTP_UP_'|| SalNumberToStrX( lnI, 0), gsUploadUrl[1], gsUploadUrl[lnI], sPathINI )
.head 7 -  Call SalGetProfileString( 'HTTP', 'HTTP_DOWN_'|| SalNumberToStrX( lnI, 0), gsDownloadUrl[1],  gsDownloadUrl[lnI],  sPathINI  )
.head 7 -  !
.head 7 -  Call SalGetProfileString( 'HTTPS', 'HTTPS_COCKPIT_'|| SalNumberToStrX( lnI, 0), gsCockpitUrls[1], gsCockpitUrls[lnI], sPathINI  )
.head 7 -  Call SalGetProfileString( 'HTTPS', 'HTTPS_UP_'|| SalNumberToStrX( lnI, 0), gsUploadUrls[1], gsUploadUrls[lnI], sPathINI )
.head 7 -  Call SalGetProfileString( 'HTTPS', 'HTTPS_DOWN_'|| SalNumberToStrX( lnI, 0), gsDownloadUrls[1],  gsDownloadUrls[lnI],  sPathINI  )
.head 7 -  Call SalGetProfileString( 'HTTPS', 'HTTPS_LOGIN_'|| SalNumberToStrX( lnI, 0), gsHttpsLogins[1], gsHttpsLogins[lnI], sPathINI  )
.head 7 -  Call SalGetProfileString( 'HTTPS', 'HTTPS_PWD_'|| SalNumberToStrX( lnI, 0), gsHttpsPwds[1],  gsHttpsPwds[lnI], sPathINI )
.head 7 -  !
.head 7 -  Set lnI = lnI +1
.head 6 -  ! PROXY
.head 6 -  Call SalGetProfileString( 'PROXY', 'PROXY_NOM', gsProxyServeur, gsProxyServeur, sPathINI  )
.head 6 -  Set gnProxyPort = SalGetProfileInt( 'PROXY', 'PROXY_PORT', gnProxyPort, sPathINI )
.head 6 -  Call SalGetProfileString( 'PROXY', 'PROXY_LOGIN', gsProxyUser,  gsProxyUser,  sPathINI  )
.head 6 -  Call SalGetProfileString( 'PROXY', 'PROXY_PWD', gsProxyPass, gsProxyPass, sPathINI )
.head 6 -  ! TIME OUT
.head 6 -  ! Set gnHttpNbrEssais = SalGetProfileInt( 'TIMEOUT', 'ESSAI', gnHttpNbrEssais, sPathINI )
.head 6 -  Set gnHttpNbrEssais = SalGetProfileInt( 'TIMEOUT', 'ESSAI', 2, sPathINI )
.head 6 -  ! Set gnHttpTimeout = SalGetProfileInt( 'TIMEOUT', 'TIMEOUT', gnHttpTimeout, sPathINI )
.head 6 -  Set gnHttpTimeout = SalGetProfileInt( 'TIMEOUT', 'TIMEOUT', 10000, sPathINI )
.head 6 -  !
.head 6 -  !
.head 6 -  ! Chargement Array des messages pour l'application
.head 6 -  Set gnMsgNo = SalGetProfileInt( 'HTTP_MSG', 'MSG_NO', 0, sPathINI_Msg )
.head 6 -  Set lnI = gnMsgNo
.head 6 +  While lnI <= gnMsgNo+99
.head 7 -  Call SalGetProfileString( 'HTTP_MSG', 'MSG_'|| SalNumberToStrX( lnI,0), '', gsHTTPMessage[lnI], sPathINI_Msg  )
.head 7 -  Set lnI = lnI + 1
.head 5 -  !
.head 5 +  If NOT gbHttpActif
.head 6 +  If gnLanguage = Language_NL
.head 7 -  Set lsMsg =  "Geen verbinding naar de HTTP servers ("|| sPathINI ||")"
.head 6 +  Else
.head 7 -  Set lsMsg =  "Aucune connexion vers des serveurs HTTP ("|| sPathINI ||")"
.head 6 -  Set lbContinue =  FALSE
.head 5 -  ! Datei übertragen.
.head 5 -  ! Display SalMsgBox
.head 5 +  If NOT lbContinue
.head 6 -  Call SalMessageBox( lsMsg, '', 0 )
.head 5 +  Else
.head 6 -  Set gsCurrentABC = ''
.head 6 -  Call PalABCSetUrls( 1 )
.head 5 -  !
.head 5 -  Call VisWaitCursor( FALSE )
.head 3 +  Function: PalHttpCockpit
.head 4 -  Description: Communication avec cockpit ...

pnTypeCom
psWarning
psErreur
psInfo
psElec (Election)
psModule (Logiciel)
psLieu (Ligne, INS, ...)
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: pnTypeCom
.head 5 -  String: psWarning
.head 5 -  String: psErreur
.head 5 -  Receive String: psInfo
.head 5 -  !
.head 5 -  String: psElec
.head 5 -  String: psModule
.head 5 -  String: psLieu
.head 5 -  String: psFichier
.head 5 -  ! Receive String: prsMsgErreur
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  !
.head 5 -  Boolean: lbMessageBox
.head 5 -  String: lsMessageBox
.head 5 -  Date/Time: ldtDateTime
.head 5 -  String: lsDateTime
.head 5 -  !
.head 5 -  ! String: lsReponse
.head 5 -  Number: lnReturn
.head 5 -  !
.head 5 -  String: lsUrl
.head 5 -  Boolean: lbAuto
.head 5 -  String: lsDuree
.head 5 -  String: lsQui
.head 5 -  String: lsElec
.head 5 -  String: lsLieu
.head 5 -  String: lsQuand
.head 5 -  String: lsFichier
.head 5 -  String: lsTraitement
.head 5 -  String: lsErreur
.head 5 -  String: lsWarning
.head 5 -  String: lsInfo
.head 5 -  String: lsUser
.head 5 -  String: lsPassword
.head 5 -  String: lsMsgErreur
.head 5 -  !
.head 5 -  String: lsPathname
.head 5 -  !
.head 5 -  String: lsProxyServeur
.head 5 -  Number: lnProxyPort
.head 5 -  String: lsProxyUser
.head 5 -  String: lsProxyPass
.head 5 -  !
.head 5 -  Number: lnEssai
.head 5 -  Boolean: bOkTransfert
.head 5 -  String: prsMsgErreur
.head 4 +  Actions
.head 5 -  !
.head 5 +  If gbHttpActif
.head 6 -  Set bOkTransfert = FALSE
.head 6 -  Set lnEssai = 1
.head 6 -  ! << Interne -> ligne 3
.head 6 +  If gbInterne
.head 7 -  Set lnEssai = 3
.head 6 -  ! Interne >>
.head 6 +  While ( lnEssai <= 3 AND NOT bOkTransfert ) OR (  lnEssai <= 3 AND gbHttpOnAllLines )
.head 7 -  Call VisWaitCursor(TRUE)
.head 7 -  Call PalABCSetUrls( lnEssai )
.head 7 -  ! Initialisation des variables
.head 7 +  If 1
.head 8 -  ! Automatique ?
.head 8 -  Set lbAuto = TRUE
.head 8 -  ! Quelque soit le pnTypeCom
.head 8 +  If 1
.head 9 +  If gsHttpType = '0'
.head 10 -  Set lsUrl = gsHttpCockpit
.head 9 +  Else If gsHttpType = '1'
.head 10 -  Set lsUrl = gsHttpsCockpit
.head 9 -  Set lsQui = psModule
.head 9 -  Set lsElec = psElec
.head 9 -  Set lsLieu = psLieu
.head 9 -  ! date aaaammddhhmmsscc
.head 9 -  Set ldtDateTime = SalDateCurrent(  )
.head 9 -  Call SalDateToStr( ldtDateTime, lsQuand )
.head 9 -  ! Set lsQuand = SalFmtFormatDateTime( ldtDateTime, 'yyyyMMddhhhhmmss' )
.head 9 -  ! Set lsDateTime = SalFmtFormatDateTime( ldtDateTime, '' )
.head 9 -  Set lsQuand = SalStrLeftX( lsQuand, 22 )
.head 9 -  Set lsQuand = VisStrSubstitute( lsQuand, '-', '')
.head 9 -  Set lsQuand = VisStrSubstitute( lsQuand, '.', '')
.head 9 -  Set lsQuand = VisStrSubstitute( lsQuand, ':', '')
.head 9 -  Set lsTraitement = SalNumberToStrX( pnTypeCom, 0 )
.head 9 -  Set lsFichier = psFichier
.head 9 -  Set lsWarning = psWarning
.head 9 -  Set lsErreur = psErreur
.head 9 -  ! Proxy
.head 9 -  Set lsProxyServeur = gsProxyServeur
.head 9 -  Set lnProxyPort = gnProxyPort
.head 9 -  Set lsProxyUser = gsProxyUser
.head 9 -  Set lsProxyPass = gsProxyPass
.head 9 -  !
.head 9 -  Set lsUser = gsHttpsLogin
.head 9 -  Set lsPassword = gsHttpsPwd
.head 8 -  ! Spécifique au pnTypeCom
.head 8 +  If gsHTTPMessage[pnTypeCom] != ''
.head 9 -  Set lsInfo =  psModule || ' - ' || gsHTTPMessage[pnTypeCom]
.head 8 +  Else
.head 9 -  Set lsInfo = psModule || ' - '|| 'Unknown Msg : '|| SalNumberToStrX( pnTypeCom, 0)
.head 8 +  If psInfo != ''
.head 9 -  Set lsInfo = lsInfo || ' - '|| psInfo
.head 8 -  Set lsInfo = VisStrSubstitute( lsInfo, "'","\\'" )
.head 8 -  ! << 2010
.head 8 +  If lsElec = ''
.head 9 -  Set lsElec=  gsPar_ElectionType
.head 8 -  Set lsInfo = lsInfo || ' 
' || wsLoginUserCE_NN  || ' : ' || wsLoginUserCEI_Nom
.head 8 -  ! 2010 >>
.head 7 -  ! Durée
.head 7 -  Set gdFin = SalDateCurrent(  )
.head 7 -  Set lsDuree = SalNumberToStrX( (gdFin - gdDebut) * 60 *60 * 24 , 2 )
.head 7 +  If lsDuree != '0,00'
.head 8 -  Set lsInfo = lsInfo || ' ' || lsDuree || ' sec.'
.head 7 -  ! Com
.head 7 +  If 1
.head 8 -  Set lnReturn =  SalModalDialog( dlgSendCockpit, hWndForm,
lsUrl,
lbAuto,
lsQui,
lsElec,
lsLieu,
lsQuand,
lsFichier,
lsTraitement,
lsWarning,
lsErreur,
'(' || gsCurrentABC || ') ' || lsInfo,
lsUser,
lsPassword,
lsProxyServeur,
lnProxyPort,
lsProxyUser,
lsProxyPass,
lsMsgErreur )
.head 8 -  !
.head 8 -  ! Ajout info ligne gsCurrentABC
.head 8 +  If gbHttpOnAllLines AND lnEssai > 1
.head 9 -  Set prsMsgErreur = prsMsgErreur ||  ' ----- '
.head 8 -  Set prsMsgErreur = prsMsgErreur || gsCurrentABC || ' : '
.head 8 -  !
.head 8 +  If lnReturn = 0
.head 9 -  Set prsMsgErreur = prsMsgErreur || ' Cockpit OK ! '
.head 9 -  Set bOkTransfert = TRUE
.head 9 +  If NOT gbHttpOnAllLines
.head 10 -  Break
.head 8 +  Else
.head 9 -  ! Erreurs
.head 9 -  ! wnErreur = -1 : Mauvaise réponse du serveur : wsReponse  (Réponse != INSERT INTO ActivityLog)
.head 9 -  ! wnErreur =  1 : erreur 404 page inconnue   ('404' in Réponse)
.head 9 -  ! wnErreur =  2 : Hôte inconnu  ( 'Hôte' in Réponse)
.head 9 -  ! wnErreur =  3 : Connection refusée par le seveur ( 'accès' in Réponse)
.head 9 -  ! wnErreur =  9 : autres erreurs
.head 9 -  Set prsMsgErreur = prsMsgErreur || ' Err. ' || SalNumberToStrX( lnReturn, 0 ) || ' : ' || lsMsgErreur
.head 9 +  If lnEssai = 3
.head 10 -  Call SalMessageBox( prsMsgErreur, '', MB_Ok )
.head 8 -  Set lnEssai = lnEssai +1
.head 7 -  Call VisWaitCursor(FALSE)
.head 5 -  !
.head 5 -  Call VisWaitCursor(FALSE)
.head 5 -  Set psInfo = prsMsgErreur
.head 5 -  Return TRUE
.head 3 +  Function: PalHttpIniSave
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sPathINI
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: lsMsg
.head 5 -  File Handle: lhFile
.head 5 -  Boolean: lbContinue
.head 5 -  Number: lnI
.head 4 +  Actions
.head 5 -  !
.head 5 -  Call VisWaitCursor( TRUE )
.head 5 -  Set lbContinue = TRUE
.head 5 -  !
.head 5 +  If lbContinue
.head 6 -  Call SalSetProfileString( 'HTTP_TYPE', 'HTTP_TYPE',  gsHttpType, sPathINI )
.head 6 -  ! HTTP & HTTPs
.head 6 -  Set lnI = 1
.head 6 +  While lnI <= 3
.head 7 -  Call SalSetProfileString( 'HTTP', 'HTTP_COCKPIT_'|| SalNumberToStrX( lnI, 0),  gsCockpitUrl[lnI], sPathINI  )
.head 7 -  Call SalSetProfileString( 'HTTP', 'HTTP_UP_'|| SalNumberToStrX( lnI, 0),  gsUploadUrl[lnI], sPathINI )
.head 7 -  Call SalSetProfileString( 'HTTP', 'HTTP_DOWN_'|| SalNumberToStrX( lnI, 0),   gsDownloadUrl[lnI],  sPathINI  )
.head 7 -  !
.head 7 -  Call SalSetProfileString( 'HTTPS', 'HTTPS_COCKPIT_'|| SalNumberToStrX( lnI, 0),  gsCockpitUrls[lnI], sPathINI  )
.head 7 -  Call SalSetProfileString( 'HTTPS', 'HTTPS_UP_'|| SalNumberToStrX( lnI, 0),  gsUploadUrls[lnI], sPathINI )
.head 7 -  Call SalSetProfileString( 'HTTPS', 'HTTPS_DOWN_'|| SalNumberToStrX( lnI, 0),   gsDownloadUrls[lnI],  sPathINI  )
.head 7 -  Call SalSetProfileString( 'HTTPS', 'HTTPS_LOGIN_'|| SalNumberToStrX( lnI, 0),  gsHttpsLogins[lnI], sPathINI  )
.head 7 -  Call SalSetProfileString( 'HTTPS', 'HTTPS_PWD_'|| SalNumberToStrX( lnI, 0),  gsHttpsPwds[lnI], sPathINI )
.head 7 -  !
.head 7 -  Set lnI = lnI +1
.head 6 -  ! PROXY
.head 6 -  Call SalSetProfileString( 'PROXY', 'PROXY_NOM', gsProxyServeur, sPathINI )
.head 6 -  Call SalSetProfileInt( 'PROXY', 'PROXY_PORT', gnProxyPort, sPathINI )
.head 6 -  Call SalSetProfileString( 'PROXY', 'PROXY_LOGIN', gsProxyUser, sPathINI )
.head 6 -  Call SalSetProfileString( 'PROXY', 'PROXY_PWD', gsProxyPass, sPathINI )
.head 5 -  !
.head 5 -  !
.head 5 -  Call VisWaitCursor( FALSE )
.head 3 -  ! msg erreurs
.head 3 +  Function: PalDownloadFile
.head 4 -  Description: 
upload d'un fichier 

paramètres
	String: psFileToDownload
	String: psTargetPathname
	Receive String: prsMsgErreur
	Boolean: bAuto
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: psFileToDownload
.head 5 -  String: psTargetPathname
.head 5 -  Receive String: prsMsgErreur
.head 5 -  Boolean: bAuto
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Boolean: lbContinue
.head 5 -  Number: lnReturn
.head 5 -  String: lsMsgErreur
.head 5 -  String: lsHttpError
.head 5 -  String: lsUrl
.head 5 -  Number: lnEssai
.head 5 -  Boolean: bOkTransfert
.head 4 +  Actions
.head 5 -  Set bOkTransfert = FALSE
.head 5 -  !
.head 5 -  Set prsMsgErreur = ''
.head 5 +  If gbHttpActif
.head 6 -  Call VisWaitCursor(TRUE)
.head 6 -  Set lnEssai = 1
.head 6 -  ! << Interne -> ligne 3
.head 6 +  If gbInterne
.head 7 -  Set lnEssai = 3
.head 6 -  ! Interne >>
.head 6 +  While ( lnEssai <= 3 AND  NOT bOkTransfert ) OR (  lnEssai <= 3 AND gbHttpOnAllLines )
.head 7 -  Call PalABCSetUrls( lnEssai )
.head 7 -  !
.head 7 +  If gsHttpType = '0'
.head 8 -  Set lsUrl = gsHttpDown
.head 7 +  Else
.head 8 -  Set lsUrl = gsHttpsDown
.head 7 -  ! Gestion des releases
.head 7 +  If SalStrScan( psFileToDownload  , '3' || gsPar_BureauType   || '_' || gsPar_ElectionType || '_' ) >= 0
.head 8 -  Set lsUrl =lsUrl || 'RELEASE\\'
.head 7 -  !
.head 7 -  Set lnReturn =  SalModalDialog( dlgDownload, hWndForm,
lsUrl || psFileToDownload,
bAuto ,
psFileToDownload,
psTargetPathname,
gsHttpsLogin,
gsHttpsPwd,
gsProxyServeur,
gnProxyPort,
gsProxyUser,
gsProxyPass,
lsMsgErreur)
.head 7 -  !
.head 7 -  ! Ajout info ligne gsCurrentABC
.head 7 +  If gbHttpOnAllLines AND lnEssai > 1
.head 8 -  Set prsMsgErreur = prsMsgErreur ||  ' ----- '
.head 7 -  Set prsMsgErreur = prsMsgErreur ||gsCurrentABC || ' : '
.head 7 -  !
.head 7 +  If lnReturn = 0
.head 8 -  Set prsMsgErreur = prsMsgErreur || ' Download OK !  ' ||  lsMsgErreur
.head 8 -  Set lsHttpError = '0'
.head 8 -  Set bOkTransfert = TRUE
.head 8 +  If NOT gbHttpOnAllLines
.head 9 -  Break
.head 7 +  Else
.head 8 -  ! Erreurs du Start
.head 8 -  ! wnErreur =  -1 : opération stoppée
.head 8 -  ! wnErreur =  -2 : nom du fichier à transférer incorect ( 'open file'in Réponse)
.head 8 -  ! wnErreur =  -9 : autres erreurs du Start
.head 8 -  !
.head 8 -  ! Autres erreurs gestion interne à la classe
.head 8 -  ! wnErreur =  404 : page incorrecte
.head 8 -  ! wnErreur =  12007 : Hôte inconnu
.head 8 -  ! wnErreur =  12045 : Certificat authentification
.head 8 -  Set prsMsgErreur = prsMsgErreur || ' Err. ' || SalNumberToStrX( lnReturn, 0 )  || ' : '  || lsMsgErreur
.head 8 -  Set lsHttpError = '1'
.head 8 -  !
.head 8 +  If lnEssai = 3 AND NOT gbHttpOnAllLines
.head 9 -  ! Return
.head 9 -  Break
.head 7 -  Set lnEssai = lnEssai + 1
.head 6 -  Call VisWaitCursor(FALSE)
.head 5 -  Call VisWaitCursor(FALSE)
.head 5 -  Return bOkTransfert
.head 5 -  !
.head 3 +  Function: PalUploadFile
.head 4 -  Description: 
upload d'un fichier 

.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: psPathnameFichierUp
.head 5 -  String: psFilenameFichierUp
.head 5 -  Receive String: prsMsgErreur
.head 5 -  Boolean: bAuto
.head 5 -  Boolean: bMsgBox
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: lnReturn
.head 5 -  String: lsUrl
.head 5 -  String: lsMsgErreur
.head 5 -  !
.head 5 -  String: lsMsgDlgBox
.head 5 -  !
.head 5 -  String: lsFilename
.head 5 -  Number: lnEssai
.head 5 -  Boolean: bOkTransfert
.head 4 +  Actions
.head 5 -  !
.head 5 -  Set bOkTransfert = FALSE
.head 5 -  Set prsMsgErreur = ''
.head 5 -  !
.head 5 +  If gbHttpActif
.head 6 -  Set lnEssai = 1
.head 6 -  ! << Interne -> ligne 3
.head 6 +  If gbInterne
.head 7 -  Set lnEssai = 3
.head 6 -  ! Interne >>
.head 6 +  While ( lnEssai <= 3 AND  NOT bOkTransfert ) OR (  lnEssai <= 3 AND gbHttpOnAllLines )
.head 7 -  Call VisWaitCursor(TRUE)
.head 7 -  Call PalABCSetUrls( lnEssai )
.head 7 -  !
.head 7 +  If gsHttpType = '0'
.head 8 -  Set lsUrl = gsHttpUp
.head 7 +  Else
.head 8 -  Set lsUrl = gsHttpsUp
.head 7 -  Set lnReturn =  SalModalDialog( dlgUpload, hWndForm,
lsUrl,
bAuto,
psPathnameFichierUp,
gsHttpsLogin,
gsHttpsPwd,
gsProxyServeur,
gnProxyPort,
gsProxyUser,
gsProxyPass,
lsMsgErreur)
.head 7 -  !
.head 7 -  ! Ajout info ligne gsCurrentABC
.head 7 +  If gbHttpOnAllLines AND lnEssai > 1
.head 8 -  Set prsMsgErreur = prsMsgErreur ||  ' ----- '
.head 7 -  Set prsMsgErreur = prsMsgErreur || gsCurrentABC || ' : '
.head 7 -  !
.head 7 +  If lnReturn = 0
.head 8 -  Set bOkTransfert = TRUE
.head 8 -  ! Datei übertragen. 
.head 8 +  If gnLanguage = Language_NL
.head 9 -  Set lsMsgDlgBox = 'Bestand overgebracht !'
.head 8 +  Else If gnLanguage = Language_DE
.head 9 -  Set lsMsgDlgBox = 'Datei übertragen !'
.head 8 +  Else
.head 9 -  Set lsMsgDlgBox = ' Fichier transféré !  '
.head 8 -  Set prsMsgErreur = prsMsgErreur || lsMsgDlgBox
.head 8 +  If NOT gbHttpOnAllLines
.head 9 +  If bMsgBox
.head 10 -  Call SalMessageBox( lsMsgDlgBox, 'Upload', 0 )
.head 9 -  Break
.head 7 +  Else
.head 8 -  ! Erreurs du Start
.head 8 -  ! wnErreur =  -1 : opération stoppée
.head 8 -  ! wnErreur =  -2 : nom du fichier à transférer incorect ( 'open file in Réponse)
.head 8 -  ! wnErreur =  -9 : autres erreurs du Start
.head 8 -  !
.head 8 -  ! Autres erreurs gestion interne à la classe
.head 8 -  ! wnErreur =  404 : page incorrecte
.head 8 -  ! wnErreur =  12007 : Hôte inconnu
.head 8 -  ! Set lsMsgDlgBox = 'Erreur :' || SalNumberToStrX( wnReturn, 0 )  || ' '  || lsMsgErreur
.head 8 -  ! Set prsMsgErreur = prsMsgErreur || ' Erreur ' || SalNumberToStrX( lnReturn, 0 ) || ' : ' || PalGetIIsErrorX( lnReturn )
.head 8 -  Set prsMsgErreur = prsMsgErreur || ' Err. ' || SalNumberToStrX( lnReturn, 0 ) || ' : ' || lsMsgErreur
.head 8 +  If lnEssai = 3
.head 9 -  ! Return
.head 9 +  If NOT gbHttpOnAllLines
.head 10 +  If bMsgBox
.head 11 -  ! Set lsMsgDlgBox = 'Erreur :' || SalNumberToStrX( lnReturn, 0 ) || '
' || PalGetIIsErrorX( lnReturn )
.head 11 -  Set lsMsgDlgBox = 'Err. :' || SalNumberToStrX( lnReturn, 0 ) || '
' || lsMsgErreur
.head 11 -  Call SalMessageBox( lsMsgDlgBox, 'Upload', 0 )
.head 10 -  Break
.head 7 -  Set lnEssai = lnEssai + 1
.head 7 -  Call VisWaitCursor(FALSE)
.head 5 -  Call VisWaitCursor(FALSE)
.head 5 -  Return bOkTransfert
.head 3 -  !
.head 3 +  Function: PalABCSetUrls
.head 4 -  Description: 
MAJ des != URLs par rapport à 'A' = 1, 'B' = 2, 'C' = 3 ( & secure )
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nLigne
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If gsHttpType = '0'
.head 6 -  Set gsHttpCockpit = gsCockpitUrl[ nLigne]
.head 6 -  Set gsHttpUp = gsUploadUrl[ nLigne ]
.head 6 -  Set gsHttpDown = gsDownloadUrl[ nLigne ]
.head 5 +  Else If gsHttpType = '1'
.head 6 -  Set gsHttpsCockpit = gsCockpitUrls[ nLigne ]
.head 6 -  Set gsHttpsUp = gsUploadUrls[ nLigne ]
.head 6 -  Set gsHttpsDown = gsDownloadUrls[nLigne ]
.head 6 -  Set gsHttpsLogin = gsHttpsLogins[ nLigne ]
.head 6 -  Set gsHttpsPwd = gsHttpsPwds[ nLigne] 
.head 5 -  Set gsCurrentABC = SalNumberToChar( nLigne + 64 )
.head 3 -  !
.head 2 -  Named Menus
.head 2 +  Class Definitions
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton:
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control:
.head 3 -  ActiveX:
.head 2 -  Application Actions
.head 1 +  Dialog Box: dlgCockpitAide
.data CLASSPROPSSIZE
0000: 9400
.enddata
.data CLASSPROPS
0000: 4C6162656C640019 0054657374206465 206C6120636F6E66 696775726174696F
0020: 6E00004C6162656C 6600190054657374 206465206C612063 6F6E666967757261
0040: 74696F6E00004C61 62656C6E00190054 657374206465206C 6120636F6E666967
0060: 75726174696F6E00 004C6162656C6500 1900546573742064 65206C6120636F6E
0080: 6669677572617469 6F6E000000000000 00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Tests
.head 2 -  Accessories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: 5.263"
.head 4 -  Top: 0.948"
.head 4 -  Width:  11.15"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.798"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  Resizable? No
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbQuitter
.data CLASSPROPS
0000: 4C6162656C640001 0000004C6162656C 6600010000004C61 62656C6E00010000
0020: 004C6162656C6500 0100000000000000 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3400
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: 9.25"
.head 5 -  Top: 5.143"
.head 5 -  Width:  0.733"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.488"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: 0
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( hWndForm, FALSE )
.head 5 +  On SAM_Create
.head 6 -  Call SalPicSet( hWndItem, resExitWinCock , PIC_FormatBitmap )
.head 3 -  !
.head 3 +  Pushbutton: pbTestCockpit
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Cockpit
.head 4 -  Window Location and Size
.head 5 -  Left: 0.3"
.head 5 -  Top: 0.333"
.head 5 -  Width:  1.283"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: 0
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set mlCockpit = ''
.head 6 -  Set gbHttpOnAllLines = TRUE
.head 6 -  Set gdDebut = SalDateCurrent(  )
.head 6 -  Set wbResult = PalHttpCockpit( gnMsgNo + 70, '', '', gsMsgErreurHttp, psLieu, psModule, psModuleLigne, '')
.head 6 -  Set gbHttpOnAllLines = FALSE
.head 6 -  ! Output
.head 6 -  Set mlCockpit = VisStrSubstitute (gsMsgErreurHttp, ' ----- ', '
')
.head 6 +  ! If wbResult
.head 7 -  Set mlCockpit = 'Test cockpit Ok !
'
.head 6 +  ! Else
.head 7 -  Set mlCockpit = 'Problème de communiquation avec cockpit
'
.head 7 -  Set mlCockpit = mlCockpit  || gsMsgErreurHttp || '
'
.head 6 -  ! Set mlCockpit  = mlCockpit || 'HttpType : ' || gsHttpType
.head 6 +  ! If gsHttpType = '0'
.head 7 -  Set mlCockpit  = mlCockpit || '
HttpCockpit : ' || gsHttpCockpit
.head 6 +  ! Else If gsHttpType = '1'
.head 7 -  Set mlCockpit  = mlCockpit || '
HttpsCockpit : ' || gsHttpsCockpit
.head 3 +  Multiline Field: mlCockpit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  String Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left: 1.8"
.head 6 -  Top: 0.333"
.head 6 -  Width:  8.183"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.071"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Pushbutton: pbTestEnvoi
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Upload
.head 4 -  Window Location and Size
.head 5 -  Left: 0.3"
.head 5 -  Top: 1.56"
.head 5 -  Width:  1.283"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: 0
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! Upload dlg
.head 6 -  Set gbHttpOnAllLines = TRUE
.head 6 -  !
.head 6 -  ! Set gnProxiTaille = 0
.head 6 +  If rb1K
.head 7 -  Set wsPathFichierTest = psPathTest  || '_1K_'
.head 7 -  Set wsNomFichierTest =  'T1K'
.head 6 +  Else If rb150K
.head 7 -  Set wsPathFichierTest = psPathTest || '_150K_'
.head 7 -  Set wsNomFichierTest =  'T150K'
.head 6 +  Else If rb650K
.head 7 -  Set wsPathFichierTest = psPathTest || '_650K_'
.head 7 -  Set wsNomFichierTest =  'T650K'
.head 7 -  !
.head 6 +  Else If rb2M
.head 7 -  Set wsPathFichierTest = psPathTest || '_2M_'
.head 7 -  Set wsNomFichierTest =  'T2M'
.head 6 +  Else If rb15M
.head 7 -  Set wsPathFichierTest = psPathTest || '_15M_'
.head 7 -  Set wsNomFichierTest =  'T15M'
.head 6 -  ! ! Copy
.head 6 -  Set wsDateHeure =  SalNumberToStrX(    SalDateYear(SalDateCurrent(  )) ,0) ||
                                 SalStrRightX( '00' || SalNumberToStrX( SalDateMonth(SalDateCurrent(  ))  ,0) ,2) ||
                                 SalStrRightX( '00' || SalNumberToStrX(     SalDateDay(SalDateCurrent(  ))  ,0) ,2)||
                                 SalStrRightX( '00' || SalNumberToStrX(    SalDateHour(SalDateCurrent(  ))  ,0) ,2)||
                                 SalStrRightX( '00' || SalNumberToStrX(  SalDateMinute(SalDateCurrent( )) ,0) ,2)
.head 6 -  Call SalFileCopy(   sPathTmp ||  wsNomFichierTest, wsPathFichierTest || wsDateHeure, TRUE )
.head 6 -  Set wbResult = PalUploadFile( wsPathFichierTest || wsDateHeure , '', gsMsgErreurHttp, FALSE, TRUE)
.head 6 -  !
.head 6 -  Set gbHttpOnAllLines = FALSE
.head 6 -  !
.head 6 -  ! Output
.head 6 -  Set mlEnvoi = VisStrSubstitute (gsMsgErreurHttp, ' ----- ', '
')
.head 6 -  ! Cockpit
.head 6 +  If wbResult
.head 7 -  Call PalHttpCockpit( gnMsgNo + 72, '0', '0', gsMsgErreurHttp ,psLieu, psModule, psModuleLigne, wsNomFichierTest  || '_' || wsDateHeure )
.head 6 +  Else
.head 7 -  Call PalHttpCockpit( gnMsgNo + 72, '0', '1', gsMsgErreurHttp , psLieu, psModule, psModuleLigne, wsNomFichierTest || '_' || wsDateHeure )
.head 3 +  Multiline Field: mlEnvoi
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  String Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left: 1.8"
.head 6 -  Top: 1.512"
.head 6 -  Width:  8.183"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.071"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Pushbutton: pbTestReception
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Download
.head 4 -  Window Location and Size
.head 5 -  Left: 0.3"
.head 5 -  Top: 2.726"
.head 5 -  Width:  1.283"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: 0
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set wsNomFichierTestDown = 'TK00000.EL'
.head 6 -  ! Download dlg
.head 6 -  Set gbHttpOnAllLines = TRUE
.head 6 -  Set wbResult = PalDownloadFile( wsNomFichierTestDown, sPathTmp, gsMsgErreurHttp, FALSE )
.head 6 -  Set gbHttpOnAllLines = FALSE
.head 6 -  ! Output
.head 6 -  ! Set mlReception = gsMsgErreurHttp
.head 6 -  Set mlReception = VisStrSubstitute (gsMsgErreurHttp, ' ----- ', '
')
.head 6 -  ! Cockpit
.head 6 +  If wbResult
.head 7 -  Call PalHttpCockpit( gnMsgNo + 73, '0', '0', gsMsgErreurHttp , psLieu, psModule, psModuleLigne, '' )
.head 6 +  Else
.head 7 -  Call PalHttpCockpit( gnMsgNo + 73, '0', '1', gsMsgErreurHttp , psLieu, psModule, psModuleLigne, '' )
.head 3 +  Multiline Field: mlReception
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  String Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left: 1.8"
.head 6 -  Top: 2.69"
.head 6 -  Width:  8.183"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.071"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Pushbutton: pbTestSigna
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: eId
.head 4 -  Window Location and Size
.head 5 -  Left: 0.35"
.head 5 -  Top: 3.905"
.head 5 -  Width:  1.283"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: 0
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set gdDebut = SalDateCurrent(  )
.head 6 -  Call PalTestSigna()
.head 5 +  On SAM_Create
.head 6 +  If sPathSign = ''
.head 7 -  Call SalHideWindow( hWndItem )
.head 3 +  Multiline Field: mlSigna
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  String Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left: 1.8"
.head 6 -  Top: 3.869"
.head 6 -  Width:  8.183"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.071"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If sPathSign = ''
.head 7 -  Call SalHideWindow( hWndItem )
.head 3 -  !
.head 3 +  Pushbutton: pbHttpINI
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: HTTP.INI
.head 4 -  Window Location and Size
.head 5 -  Left: 4.483"
.head 5 -  Top: 5.31"
.head 5 -  Width:  2.05"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalModalDialog( dlgIniFileManager, hWndForm,  sPathINI )
.head 3 -  !
.head 3 +  Radio Button: rb1K
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: clsRbMultiLanguage
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 1k
.head 4 -  Window Location and Size
.head 5 -  Left: 9.983"
.head 5 -  Top: 1.405"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set wsTailleFichier = '1k'
.head 3 +  Radio Button: rb150K
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: clsRbMultiLanguage
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 150k
.head 4 -  Window Location and Size
.head 5 -  Left: 9.983"
.head 5 -  Top: 1.655"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  ! On SAM_Create
.head 6 -  Set MyValue = TRUE
.head 6 -  Set wsTailleFichier = '150k'
.head 5 +  On SAM_Click
.head 6 -  Set wsTailleFichier = '150k'
.head 3 +  Radio Button: rb650K
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: clsRbMultiLanguage
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 620k
.head 4 -  Window Location and Size
.head 5 -  Left: 9.983"
.head 5 -  Top: 1.905"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set MyValue = TRUE
.head 6 -  Set wsTailleFichier = '650k'
.head 5 +  On SAM_Click
.head 6 -  Set wsTailleFichier = '650k'
.head 3 +  Radio Button: rb2M
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: clsRbMultiLanguage
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 2M
.head 4 -  Window Location and Size
.head 5 -  Left: 9.983"
.head 5 -  Top: 2.155"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set wsTailleFichier = '2M'
.head 3 +  Radio Button: rb15M
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: clsRbMultiLanguage
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 15M
.head 4 -  Window Location and Size
.head 5 -  Left: 9.983"
.head 5 -  Top: 2.405"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set wsTailleFichier = '15M'
.head 2 +  Functions
.head 3 +  Function: PalTestSigna
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: lsRn 
.head 5 -  String: lsShortFileName
.head 5 -  String: lsNomCEI
.head 5 -  File Handle: fhFileSign
.head 5 -  String: lsPdfSign
.head 5 -  String: lsCurrentDirectory
.head 5 -  Boolean: lbEidOk
.head 5 -  Number: lnError
.head 5 -  String: lsNomTestFile
.head 5 -  String: lsNomQrp
.head 4 +  Actions
.head 5 -  Set lsRn ='000'
.head 5 -  Set lsNomTestFile = gsPar_BureauType || gsPar_BureauIns
.head 5 +  If SalModalDialog( dlgPvSignCEI_Test, hWndForm , lbEidOk , lsRn, lsNomCEI)
.head 6 -  Set lsShortFileName = sPathTmp || 'tst.pdf'
.head 6 -  ! Création du fichier sign.ini pour signature P.V.
.head 6 -  Call SalFileOpen( fhFileSign, sPathSign || 'sign.ini' , OF_Create  | OF_Write )
.head 6 -  Call SalFilePutStr( fhFileSign, lsRn )
.head 6 -  Call SalFilePutStr( fhFileSign, 'PDFSIGN' )
.head 6 -  Call SalFilePutStr( fhFileSign, sPathTmp || 'tst.pdf')
.head 6 -  Set lsPdfSign = sPathSign || 'sign_'|| lsNomTestFile  || '.pdf'
.head 6 -  Call SalFilePutStr( fhFileSign, lsPdfSign)
.head 6 -  Call SalFilePutStr( fhFileSign, 'FALSE' )
.head 6 +  If gnLanguage = Language_NL
.head 7 -  Call SalFilePutStr( fhFileSign, 'NL' )
.head 6 +  Else If gnLanguage = Language_DE
.head 7 -  Call SalFilePutStr( fhFileSign, 'DE' )
.head 6 +  Else
.head 7 -  Call SalFilePutStr( fhFileSign, 'FR' )
.head 6 -  Call SalFileClose( fhFileSign )
.head 6 -  Call SalFileOpen( fhFileOut, lsPdfSign, OF_Delete )
.head 6 -  Call SalFileOpen( fhFileOut, sPathTmp || 'sign.err', OF_Delete )
.head 6 -  !
.head 6 -  ! << 2010
.head 6 +  ! If gnLanguage = Language_NL
.head 7 -  Set lsFileToSign = "Test_Sign_nl.PDF"
.head 6 +  ! Else If gnLanguage = Language_DE
.head 7 -  Set lsFileToSign = "Test_Sign_de.PDF"
.head 6 +  ! Else 
.head 7 -  Set lsFileToSign = "Test_Sign_fr.PDF"
.head 6 +  ! If VisFileCopy( sPathSign || lsFileToSign , sPathTmp || 'tst.pdf'  ) != 1
.head 7 +  If gnLanguage = Language_NL
.head 8 -  Call SalMessageBox ( "File  '" || sPathSign || "Not found !", '', 0 )
.head 7 +  Else 
.head 8 -  Call SalMessageBox ( "Le fichier " || sPathSign || lsFileToSign || " n'existe pas", '', 0 )
.head 7 +  If gnLanguage = Language_NL
.head 8 -  Set mlSigna = 'eID: Ondertekentest - Fout'
.head 7 +  Else 
.head 8 -  Set mlSigna = 'eID: Test de signature - Erreur'
.head 7 -  Return FALSE
.head 6 -  ! 2010>>
.head 6 -  ! ! <<
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 -  Call PalPdf( 1, sPathSign || 'Test_Sign.PDF' )
.head 6 -  !
.head 6 -  Set wsNomBur = gsPar_BureauIns
.head 6 +  Select Case gnLanguage
.head 7 +  Case Language_NL
.head 8 -  Set wsNomBur = gUDV_Param1Cfg.Param1_GetBureauNom2_NN(  ) || ' (' || wsNomBur || ')'
.head 8 -  Set lsNomQrp = gsPath2008 || 'qrp\\' || 'test_sign_nl.qrp'
.head 8 -  Break
.head 7 +  Case Language_FR
.head 8 -  Set wsNomBur = gUDV_Param1Cfg.Param1_GetBureauNom2_FF(  ) || ' (' || wsNomBur || ')'
.head 8 -  Set lsNomQrp = gsPath2008 || 'qrp\\' || 'test_sign_fr.qrp'
.head 8 -  Break
.head 7 +  Case Language_DE
.head 8 -  Set wsNomBur = gUDV_Param1Cfg.Param1_GetBureauNom2_DD(  ) || ' (' || wsNomBur || ')'
.head 8 -  Set lsNomQrp = gsPath2008 || 'qrp\\' || 'test_sign.qrp'
.head 8 -  Break
.head 6 -  Call SalReportPrint( dlgCockpitAide,lsNomQrp, 'wsNomBur','NOM',1,RPT_PrintAll,0, 0,lnError )
.head 6 -  Call PalPdf( 0, sPathSign || 'Test_Sign.PDF' )
.head 6 -  ! !
.head 6 -  ! ! Call SalMessageBox ( sPathSign || "Test_Sign.qrp" , 'file',0 )
.head 6 -  Call SalWaitCursor( FALSE )
.head 6 +  If VisFileCopy( sPathSign || "Test_Sign.PDF" , sPathTmp || 'tst.pdf'  ) != 1
.head 7 -  Call SalMessageBox ( "File :"  || sPathSign || "Test_Sign.PDF" || " Not found !", '', 0 )
.head 7 -  Set mlSigna = 'eID: Sign test - Error. ' || "File :"  || sPathSign || "Test_Sign.PDF" || " Not found !"
.head 7 -  Call PalHttpCockpit( gnMsgNo + 71, '0', '1', mlSigna , psLieu, psModule, psModuleLigne, '' )
.head 7 -  Set mlSigna = 'eID: Sign test - Error. ' || "File :"  || sPathSign || "Test_Sign.PDF" || " Not found !"
.head 7 -  Return FALSE
.head 6 -  ! ! >>
.head 6 +  If NOT SalFileGetCurrentDirectory( lsCurrentDirectory )
.head 7 -  Call SalMessageBox ( 'Could not get current directory.', 'Error', 0 )
.head 7 +  If gnLanguage = Language_NL
.head 8 -  Set mlSigna = 'eID: Ondertekentest - Fout'
.head 7 +  Else
.head 8 -  Set mlSigna = 'eID: Test de signature - Erreur'
.head 7 -  Return FALSE
.head 6 -  Call SalFileSetCurrentDirectory( sPathSign )
.head 6 +  If ShellExecuteA( hWndForm, 'open', sPathSign || 'stesudsign.exe' , '','', SW_NORMAL )
.head 7 +  While SalFileOpen( fhFileOut,lsPdfSign,OF_Exist ) = FALSE AND SalFileOpen( fhFileOut,sPathTmp ||'sign.err',OF_Exist ) = FALSE
.head 8 -  Call SalSetFocus( hWndForm )
.head 8 -  Call SalPause( 500 )
.head 7 -  ! redonne le focus à l'application
.head 7 -  Call SalFileSetCurrentDirectory( lsCurrentDirectory )
.head 7 -  Call SalSetFocus( hWndForm )
.head 7 +  If SalFileOpen( fhFileOut, sPathTmp || 'sign.err',OF_Exist ) = TRUE
.head 8 +  If gnLanguage = Language_NL
.head 9 -  Set mlSigna = 'eID: Ondertekentest - Fout sign.err'
.head 8 +  Else
.head 9 -  Set mlSigna = 'eID: Test de signature - Erreur sign.err'
.head 8 -  ! << 201b et 301b
.head 8 -  Set lsSigna=mlSigna
.head 8 -  ! >>
.head 8 -  Call PalHttpCockpit( gnMsgNo + 71, '0', '1', mlSigna , psLieu, psModule, psModuleLigne, '' )
.head 7 +  Else
.head 8 +  If gnLanguage = Language_NL
.head 9 -  Set mlSigna = 'eID: Ondertekentest - OK!'
.head 8 +  Else
.head 9 -  Set mlSigna ='eID: Test de signature -  OK !'
.head 8 -  ! << 201b et 301b
.head 8 -  Set lsSigna=mlSigna
.head 8 -  ! >>
.head 8 -  Set wnRetShell =ShellExecuteA( hWndForm, 'open', sPathSign  || 'sign_' || lsNomTestFile ||'.pdf' , '','', SW_NORMAL )
.head 8 +  If wnRetShell <= 32
.head 9 -  Call SalMessageBox( 'Shell Execute error ' || SalNumberToStrX(wnRetShell,0), 'Shell Execute error ', MB_Ok )
.head 8 -  Call PalHttpCockpit( gnMsgNo + 71, '0', '0', mlSigna , psLieu, psModule, psModuleLigne, '' )
.head 8 -  ! << 2010
.head 8 -  Set gnTestSignOk = TRUE
.head 8 -  Call SalSetProfileInt( 'CONTROLE', 'TEST_SIGN_OK', gnTestSignOk, gsPvIniFilename )
.head 8 -  ! 2010 >>
.head 8 -  ! ! ! Transfert du fichier
.head 8 -  Set wbResult = PalUploadFile(  sPathSign || 'sign_'|| lsNomTestFile || '.pdf', '', gsMsgErreurHttp, FALSE, TRUE)
.head 8 -  ! ! ! Cockpit
.head 8 +  If wbResult
.head 9 -  Call PalHttpCockpit( gnMsgNo + 72, '0', '0', gsMsgErreurHttp , '', psModule, psModuleLigne, 'sign_'|| lsNomTestFile || '.pdf' )
.head 8 +  Else
.head 9 -  Call PalHttpCockpit( gnMsgNo + 72, '0', '1', gsMsgErreurHttp , '', psModule, psModuleLigne, 'sign_'|| lsNomTestFile || '.pdf' )
.head 6 +  Else
.head 7 +  If gnLanguage = Language_NL
.head 8 -  Set mlSigna = 'eID: Ondertekentest - Fout stesudsign.exe'
.head 7 +  Else
.head 8 -  Set mlSigna = 'eID: Test de signature - Erreur stesudsign.exe'
.head 7 -  ! << 201b et 301b
.head 7 -  Set lsSigna=mlSigna
.head 7 -  ! >>
.head 7 -  Call PalHttpCockpit( gnMsgNo + 71, '0', '1', mlSigna , psLieu, psModule, psModuleLigne, '' )
.head 5 +  Else
.head 6 -  Set mlSigna = 'eID: Test de signature - Erreur dlgPvSignCEI_Test'
.head 6 -  ! << 201b et 301b
.head 6 -  Set lsSigna=mlSigna
.head 6 -  ! >>
.head 6 -  Call PalHttpCockpit( gnMsgNo + 71, '0', '1', mlSigna , psLieu, psModule, psModuleLigne, '' )
.head 5 -  ! << 201b et 301b
.head 5 -  Set mlSigna = lsSigna || '
 ' || mlSigna
.head 5 -  ! >>
.head 2 +  Window Parameters
.head 3 -  String: sPathINI
.head 3 -  String: sPathTmp
.head 3 -  String: sPathSign
.head 3 -  String: psLieu
.head 3 -  String: psModule
.head 3 -  String: psModuleLigne
.head 3 -  String: psPathTest
.head 3 -  String: psPathFichierTest
.head 2 +  Window Variables
.head 3 -  ! << 2010
.head 3 -  String: wsDateHeure
.head 3 -  String: wsNomBur
.head 3 -  String: wsTailleFichier
.head 3 -  String: lsFileToSign
.head 3 -  Boolean: wbStop
.head 3 -  ! 2010 >>
.head 3 -  Number: wnRetShell
.head 3 -  String: lsSigna
.head 3 -  ! >>
.head 3 -  String: wsNomFichierTestDown
.head 3 -  Number: wn_pData
.head 3 -  String: wsSigna
.head 3 -  String: wsPdfSign
.head 3 -  String: wsCurrentDirectory
.head 3 -  Number: wnGroupBoxTeller
.head 3 -  Window Handle: whWnd
.head 3 -  File Handle: fhFileSign
.head 3 -  File Handle: fhFileOut
.head 3 -  File Handle: fhFile
.head 3 -  !
.head 3 -  Number: wnhFind
.head 3 -  String: wsNumServeur
.head 3 -  Long String: wsPasswordFtp
.head 3 -  Long String: wsPasswordFtp2
.head 3 -  Long String: wsPasswordFtp3
.head 3 -  Long String: wsUser
.head 3 -  Long String: wsUser2
.head 3 -  Long String: wsUser3
.head 3 -  Long String: wsServeur
.head 3 -  Long String: wsServeur2
.head 3 -  Long String: wsServeur3
.head 3 -  Number: wnhOpen
.head 3 -  Number: wnhConnect
.head 3 -  Number: wnhFile
.head 3 -  Number: wnPort
.head 3 -  Number: wnLgBuffer
.head 3 -  Number: wnSeman
.head 3 -  Number: wnType
.head 3 -  String: wsDir
.head 3 -  String: wsShortFileName
.head 3 -  String: wsProv
.head 3 -  String: wsNomCEI
.head 3 -  String: wsNomFichierTest
.head 3 -  String: wsPathFichierTest
.head 3 -  Boolean: wbResult
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow( hWndForm )
.head 3 +  On SAM_CreateComplete
.head 4 -  Set wsPathFichierTest = psPathTest
.head 4 -  Set wsNomFichierTest = psPathFichierTest
.head 4 +  If NOT SalFileOpen( fhFile, wsPathFichierTest , OF_Create | OF_Write | OF_Text )
.head 5 +  If gnLanguage = Language_NL
.head 6 -  Call SalMessageBox( "Can't create test file ", '' ,MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Ne peut créer le fichier servant au test ', '' ,MB_Ok )
.head 4 +  Else
.head 5 -  Call SalFilePutStr( fhFile, "Test File..." )
.head 5 -  Call SalFileClose( fhFile )
.head 3 +  On SAM_Close
.head 4 -  ! Call InternetCloseHandle( wnhFind )
.head 4 +  ! If wnhConnect != 0
.head 5 -  Call InternetCloseHandle( wnhConnect )
.head 4 +  ! If wnhOpen != 0
.head 5 -  Call InternetCloseHandle( wnhOpen )
.head 3 +  On SAM_ReportFetchNext
.head 4 -  Set wbStop = Not wbStop
.head 4 -  Return wbStop
.head 3 +  On SAM_ReportStart
.head 4 -  ! Set wsNom= ' TEST'
.head 4 -  Set wbStop = FALSE
.head 1 -  !
.head 1 +  Dialog Box: dlgSendCockpit
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Communication avec le serveur cockpit
.head 2 -  Accessories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: 2.713"
.head 4 -  Top: 1.635"
.head 4 -  Width:  13.983"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.06"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  Resizable? No
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  ActiveX: axHttp
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 4C69634B65794C65 6E00040000000000 000000
.enddata
.data CLASSPROPSSIZE
0000: 1300
.enddata
.data RESOURCE 5 0 1 3604892284
0000: 000A000031020000 0000000000000000 020000D0CF11E0A1 B11AE1F8000000FF
0020: 003E000300FEFF09 00F0060000000F01 000000F601000110 0000020000002601
0040: 00FEFFFFF8000000 F8FFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0060: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0080: FF40FDFFFFFFFEFF FF66FEFFFEFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00C0: FFFFFFFFFFFFFFFF FFFFFFFF2052006F 006F740081004500 6E0074C072007900
00E0: 0000FFFFFFFFFFA0 16000500FFFF4F01 000000282C01F093 C6CB4E00B163D3CB
0100: 5E1B5C36F8000000 0F2026869A000673 C80103000000F280 0000284A00454550
0120: 000853007243004F 00C24F4C000000FF FFFFFFFF82160201 FFFFFFFFFA0000FF
0140: FFFFFFF04E000000 FFFFFFFFFFFFFFFF AFFFFFFFFA0000FF FFFFFFFFFFFFFFFF
0160: FFFFFFFFAFFFFFFF FA0000FFFFFFFFFF 660100FEFFFFFFFF FFFFFFFFFFFFFFFF
0180: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
01A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF00545046 300754636C004874
01C0: 7470000955730065 724167656E740600 334D6F7A696C6C61 102F342E3028636F
01E0: 006D70617469626C 65023B436C657665 720020496E746572 6E65027453756974
0200: 652080362E322900 0000F92036FE00FF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0220: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0240: FFFFFF
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: AX_clInetSuiteX6_clHttp
.head 4 -  Property Template:
.head 4 -  License Key:
.head 4 -  Display Settings
.head 5 -  GUID:
.head 5 -  Type:
.head 5 -  Activation: Class Default
.head 5 -  Host Name:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.2"
.head 6 -  Top: 0.167"
.head 6 -  Width:  0.383"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  ActiveX: axRequest
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 4C69634B65794C65 6E00040000000000 000000
.enddata
.data CLASSPROPSSIZE
0000: 1300
.enddata
.data RESOURCE 5 0 1 3042494118
0000: 000A000064020000 0000000000000000 020000D0CF11E0A1 B11AE1F8000000FF
0020: 003E000300FEFF09 00F0060000000F01 000000F601000110 0000020000002601
0040: 00FEFFFFF8000000 F8FFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0060: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0080: FF40FDFFFFFFFEFF FF66FEFFFEFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00C0: FFFFFFFFFFFFFFFF FFFFFFFF2052006F 006F740081004500 6E0074C072007900
00E0: 0000FFFFFFFFFFA0 16000500FFFF4F01 00000029C9FACF70 EAE8420080C292AD
0100: 4CD5D62FF8000000 1F7E949A000673C8 0103000000F04000 0000284A00454550
0120: 000853007243004F 00C24F4C000000FF FFFFFFFF82160201 FFFFFFFFFA0000FF
0140: FFFFFFF029000000 FFFFFFFFFFFFFFFF AFFFFFFFFA0000FF FFFFFFFFFFFFFFFF
0160: FFFFFFFFAFFFFFFF FA0000FFFFFFFFFF F6FEFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0180: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
01A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFF00545046300E 54636C0048747470
01C0: 5265717500657374 000D486561006465 722E416363650070 7406032A2F2A0000
01E0: 002E6D736E2E636F 006D2F737663732F 68006F746D61696C 2F686474746D612E
0200: 80617370094D6169 004167656E740633 4D006F7A696C6C61 2F34442E3028636F
0220: 7080617469626C65 3B00436C65766572 2049806E7465726E 6574005375697465
0240: 20362EE832290000 FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0260: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFF
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: AX_clInetSuiteX6_clHttpRequest
.head 4 -  Property Template:
.head 4 -  License Key:
.head 4 -  Display Settings
.head 5 -  GUID:
.head 5 -  Type:
.head 5 -  Activation: Class Default
.head 5 -  Host Name:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.9"
.head 6 -  Top: 0.167"
.head 6 -  Width:  0.383"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Url :
.head 4 -  Resource Id: 9951
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 1.583"
.head 5 -  Top: 0.262"
.head 5 -  Width:  0.833"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfUrl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 2.083"
.head 6 -  Top: 0.238"
.head 6 -  Width:  11.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Pushbutton: pbSend
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: send
.head 4 -  Window Location and Size
.head 5 -  Left: 0.9"
.head 5 -  Top: 0.667"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set wbOk =  axRequest.AddFormField( 'Qui',psQui, lcItem)
.head 6 -  Set wbOk =  axRequest.AddFormField( 'Elec',psElec, lcItem)
.head 6 -  Set wbOk =  axRequest.AddFormField( 'Lieu',psLieu, lcItem)
.head 6 -  Set wbOk =  axRequest.AddFormField( 'Quand',psQuand, lcItem)
.head 6 -  Set wbOk =  axRequest.AddFormField( 'Fichier',psFichier, lcItem)
.head 6 -  Set wbOk =  axRequest.AddFormField( 'Traitement',psTraitement, lcItem)
.head 6 -  Set wbOk =  axRequest.AddFormField( 'Warning',psWarning,lcItem)
.head 6 -  Set wbOk = axRequest.AddFormField( 'Erreur',psErreur, lcItem)
.head 6 -  Set wbOk =  axRequest.AddFormField( 'Info',psInfo, lcItem)
.head 6 -  ! << 2010
.head 6 -  ! VERSION
.head 6 +  If gbVersionTest
.head 7 -  Set wbOk =  axRequest.AddFormField( 'Version', QUOTE || 'T.'  || VERSION || QUOTE, lcItem)
.head 6 +  Else
.head 7 -  Set wbOk =  axRequest.AddFormField( 'Version',QUOTE || VERSION || QUOTE, lcItem)
.head 6 -  ! Num Rn
.head 6 -  Set wbOk =  axRequest.AddFormField( 'RNNum',QUOTE || wsLoginUserCE_NN || QUOTE, lcItem)
.head 6 -  ! 2010>>
.head 6 -  Set wbOk = SalActiveXGetObject( axRequest, lcRequest )
.head 6 -  Set wbOk =  axHttp.PropSetPassword(psPass )
.head 6 -  Set wbOk =  axHttp.PropSetUserName( psUser)
.head 6 -  Set wbOk =  axHttp.PropSetRequest( lcRequest)
.head 6 -  ! Proxy
.head 6 +  If pnProxyPort != 0
.head 7 -  Set wbOk =  axHttp.PropGetProxySettings( lcProxySettings )
.head 7 -  Set wbOk =  lcProxySettings.PropSetServer( psProxyServeur)
.head 7 -  Set wbOk =  lcProxySettings.PropSetPort( pnProxyPort )
.head 7 -  Set wbOk =  lcProxySettings.PropSetUserName( psProxyUser)
.head 7 -  Set wbOk =  lcProxySettings.PropSetPassword( psProxyPass)
.head 6 -  !
.head 6 -  !
.head 6 -  Set wbOk =  axHttp.PropSetTimeOut( gnHttpTimeout )
.head 6 -  Set wbOk =  axHttp.Post( psUrl, lcReponse )
.head 6 +  If wbOk = 0
.head 7 -  Set wbOk =  axHttp.GetLastError( oleErreur )
.head 7 -  Set psMsgErreur=oleErreur.description
.head 7 +  If SalStrScan( psMsgErreur, '404' ) != -1
.head 8 -  Set wnErreur = 1
.head 7 +  Else If SalStrScan( psMsgErreur, 'Hôte' ) != -1
.head 8 -  Set wnErreur = 2
.head 7 +  Else If SalStrScan( psMsgErreur, 'accès' ) != -1
.head 8 -  Set wnErreur = 3
.head 7 +  Else
.head 8 -  Set wnErreur = 9
.head 7 -  ! Set wnErreur=oleErreur.wcode
.head 6 +  Else
.head 7 -  Call SalStrSetBufferLength( wsReponse,500)
.head 7 -  Set wbOk  =lcReponse.PropGetText( wsReponse )
.head 7 +  If SalStrLeftX( wsReponse,23 ) != 'INSERT INTO ActivityLog' and SalStrLeftX( wsReponse,8 ) != '<BR>2008'
.head 8 +  If gnLanguage = Language_NL
.head 9 -  Set psMsgErreur= ' Verkeerd antwoord van de server : ' || wsReponse
.head 8 +  Else
.head 9 -  Set psMsgErreur= ' Mauvaise réponse du serveur : ' || wsReponse
.head 8 -  Set wnErreur = -1
.head 7 +  Else
.head 8 -  Set wnErreur = 0
.head 6 -  Call SalEndDialog( dlgSendCockpit, wnErreur )
.head 6 -  !
.head 3 -  !
.head 3 -  Background Text: Qui :
.head 4 -  Resource Id: 9952
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.483"
.head 5 -  Top: 1.262"
.head 5 -  Width:  0.833"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfQui
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.283"
.head 6 -  Top: 1.238"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Elec:
.head 4 -  Resource Id: 9953
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.483"
.head 5 -  Top: 1.762"
.head 5 -  Width:  0.833"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfElec
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.283"
.head 6 -  Top: 1.738"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Lieu :
.head 4 -  Resource Id: 9954
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.483"
.head 5 -  Top: 2.262"
.head 5 -  Width:  0.833"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfLieu
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.283"
.head 6 -  Top: 2.238"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Quand :
.head 4 -  Resource Id: 9955
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.483"
.head 5 -  Top: 2.762"
.head 5 -  Width:  0.833"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfQuand
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.283"
.head 6 -  Top: 2.738"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Fichier :
.head 4 -  Resource Id: 9956
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.483"
.head 5 -  Top: 3.262"
.head 5 -  Width:  0.833"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfFichier
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.283"
.head 6 -  Top: 3.238"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Traitement :
.head 4 -  Resource Id: 9957
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.483"
.head 5 -  Top: 3.762"
.head 5 -  Width:  0.833"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfTraitement
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.283"
.head 6 -  Top: 3.738"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Warning :
.head 4 -  Resource Id: 9958
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.483"
.head 5 -  Top: 4.262"
.head 5 -  Width:  0.833"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfWarning
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.283"
.head 6 -  Top: 4.238"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Erreur :
.head 4 -  Resource Id: 9959
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.483"
.head 5 -  Top: 4.762"
.head 5 -  Width:  0.833"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfErreur
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.283"
.head 6 -  Top: 4.738"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: info :
.head 4 -  Resource Id: 9960
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.483"
.head 5 -  Top: 5.262"
.head 5 -  Width:  0.833"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfInfo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.283"
.head 6 -  Top: 5.238"
.head 6 -  Width:  10.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: psUrl
.head 3 -  Boolean: pbAuto
.head 3 -  String: psQui
.head 3 -  String: psElec
.head 3 -  String: psLieu
.head 3 -  String: psQuand
.head 3 -  String: psFichier
.head 3 -  String: psTraitement
.head 3 -  String: psWarning
.head 3 -  String: psErreur
.head 3 -  String: psInfo
.head 3 -  String: psUser
.head 3 -  String: psPass
.head 3 -  String: psProxyServeur
.head 3 -  Number: pnProxyPort
.head 3 -  String: psProxyUser
.head 3 -  String: psProxyPass
.head 3 -  Receive String: psMsgErreur
.head 2 +  Window Variables
.head 3 -  FunctionalVar: lcItem
.head 4 -  Class: clInetSuiteX6_IclFormFieldRequestItem
.head 3 -  FunctionalVar: lcReponse
.head 4 -  Class: clInetSuiteX6_IclReadonlyStrings
.head 3 -  ComProxyVar: lcRequest
.head 4 -  Class: clInetSuiteX6_clHttpRequest
.head 3 -  FunctionalVar: lcProxySettings
.head 4 -  Class: clInetSuiteX6_IclHttpProxySettings
.head 3 -  String: wsReponse
.head 3 -  String: wsErreur
.head 3 -  Number: wnErreur
.head 3 -  FunctionalVar: oleErreur
.head 4 -  Class: OleErrorInfo
.head 3 -  Boolean: wbOk
.head 3 -  FunctionalVar: lcProxy
.head 4 -  Class: clInetSuiteX6_IclHttpProxySettings
.head 3 -  String: wsUser
.head 3 -  String: wsPwd
.head 3 -  Number: wnPort
.head 2 +  Message Actions
.head 3 +  On SAM_CreateComplete
.head 4 -  Set wbOk =  axHttp.PropSetTimeOut( gnHttpTimeout )
.head 4 -  !
.head 4 -  Set dfUrl             	= psUrl
.head 4 -  !
.head 4 -  Set dfQui               	= psQui
.head 4 -  Set dfElec       	= psElec
.head 4 -  Set dfLieu       	=  psLieu
.head 4 -  Set dfQuand           	=  psQuand
.head 4 -  Set dfFichier            =  psFichier
.head 4 -  Set dfTraitement     =  psTraitement
.head 4 -  Set dfWarning        =  psWarning
.head 4 -  Set dfErreur            =  psErreur
.head 4 -  Set dfInfo                = psInfo
.head 4 -  !
.head 4 -  Set psQui               	= QUOTE || psQui || QUOTE
.head 4 -  Set psElec       	= QUOTE || psElec || QUOTE
.head 4 -  Set psLieu       	= QUOTE || psLieu || QUOTE
.head 4 -  Set psQuand           	= QUOTE || psQuand || QUOTE
.head 4 -  Set psFichier            = QUOTE || psFichier || QUOTE
.head 4 -  !
.head 4 -  ! Set psTraitement      = SalStrRightX( '00' || psTraitement ,2)
.head 4 -  Set psTraitement     = QUOTE || psTraitement || QUOTE
.head 4 -  !
.head 4 +  If SalStrUpperX( psWarning )= 'TRUE' OR psWarning ='1'
.head 5 -  Set psWarning = '1'
.head 4 +  Else
.head 5 -  Set psWarning = '0'
.head 4 -  Set psWarning        = QUOTE || psWarning || QUOTE
.head 4 -  !
.head 4 +  If SalStrUpperX( psErreur )= 'TRUE' OR psErreur ='1'
.head 5 -  Set psErreur = '1'
.head 4 +  Else
.head 5 -  Set psErreur = '0'
.head 4 -  Set psErreur            = QUOTE || psErreur || QUOTE
.head 4 -  Set psInfo                = QUOTE || psInfo || QUOTE
.head 4 +  If pbAuto
.head 5 -  Call SalSendMsg( pbSend, SAM_Click,wParam,lParam )
.head 3 +  On SAM_Create
.head 4 +  If pbAuto
.head 5 -  Call SalHideWindow( hWndForm )
.head 4 -  Call SalActiveXAutoErrorMode( FALSE )
.head 1 +  Dialog Box: dlgUpload
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Transfert d'un fichier
.head 2 -  Accessories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: 2.088"
.head 4 -  Top: 1.542"
.head 4 -  Width:  11.75"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 1.417"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  Resizable? No
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  ActiveX: axRequest
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 4C69634B65794C65 6E00040000000000 000000
.enddata
.data CLASSPROPSSIZE
0000: 1300
.enddata
.data RESOURCE 5 0 1 3042494118
0000: 000A000064020000 0000000000000000 020000D0CF11E0A1 B11AE1F8000000FF
0020: 003E000300FEFF09 00F0060000000F01 000000F601000110 0000020000002601
0040: 00FEFFFFF8000000 F8FFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0060: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0080: FF40FDFFFFFFFEFF FF66FEFFFEFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00C0: FFFFFFFFFFFFFFFF FFFFFFFF2052006F 006F740081004500 6E0074C072007900
00E0: 0000FFFFFFFFFFA0 16000500FFFF4F01 00000029C9FACF70 EAE8420080C292AD
0100: 4CD5D62FF8000000 1F7E949A000673C8 0103000000F04000 0000284A00454550
0120: 000853007243004F 00C24F4C000000FF FFFFFFFF82160201 FFFFFFFFFA0000FF
0140: FFFFFFF029000000 FFFFFFFFFFFFFFFF AFFFFFFFFA0000FF FFFFFFFFFFFFFFFF
0160: FFFFFFFFAFFFFFFF FA0000FFFFFFFFFF F6FEFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0180: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
01A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFF00545046300E 54636C0048747470
01C0: 5265717500657374 000D486561006465 722E416363650070 7406032A2F2A0000
01E0: 002E6D736E2E636F 006D2F737663732F 68006F746D61696C 2F686474746D612E
0200: 80617370094D6169 004167656E740633 4D006F7A696C6C61 2F34442E3028636F
0220: 7080617469626C65 3B00436C65766572 2049806E7465726E 6574005375697465
0240: 20362EE832290000 FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0260: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFF
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: AX_clInetSuiteX6_clHttpRequest
.head 4 -  Property Template:
.head 4 -  License Key:
.head 4 -  Display Settings
.head 5 -  GUID:
.head 5 -  Type:
.head 5 -  Activation: Automatic
.head 5 -  Host Name:
.head 5 -  Window Location and Size
.head 6 -  Left: 7.85"
.head 6 -  Top: 1.762"
.head 6 -  Width:  0.383"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Etched Border? No
.head 5 -  Hollow? No
.head 5 -  Tab Stop? None
.head 5 -  Tile To Parent? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  ActiveX: axHttp
.data CLASSPROPSSIZE
0000: 1300
.enddata
.data CLASSPROPS
0000: 4C69634B65794C65 6E00040000000000 000000
.enddata
.data RESOURCE 5 0 1 3604892284
0000: 000A000031020000 0000000000000000 020000D0CF11E0A1 B11AE1F8000000FF
0020: 003E000300FEFF09 00F0060000000F01 000000F601000110 0000020000002601
0040: 00FEFFFFF8000000 F8FFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0060: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0080: FF40FDFFFFFFFEFF FF66FEFFFEFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00C0: FFFFFFFFFFFFFFFF FFFFFFFF2052006F 006F740081004500 6E0074C072007900
00E0: 0000FFFFFFFFFFA0 16000500FFFF4F01 000000282C01F093 C6CB4E00B163D3CB
0100: 5E1B5C36F8000000 0F2026869A000673 C80103000000F280 0000284A00454550
0120: 000853007243004F 00C24F4C000000FF FFFFFFFF82160201 FFFFFFFFFA0000FF
0140: FFFFFFF04E000000 FFFFFFFFFFFFFFFF AFFFFFFFFA0000FF FFFFFFFFFFFFFFFF
0160: FFFFFFFFAFFFFFFF FA0000FFFFFFFFFF 660100FEFFFFFFFF FFFFFFFFFFFFFFFF
0180: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
01A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF00545046 300754636C004874
01C0: 7470000955730065 724167656E740600 334D6F7A696C6C61 102F342E3028636F
01E0: 006D70617469626C 65023B436C657665 720020496E746572 6E65027453756974
0200: 652080362E322900 0000F92036FE00FF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0220: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0240: FFFFFF
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: AX_clInetSuiteX6_clHttp
.head 4 -  Property Template:
.head 4 -  License Key:
.head 4 -  Display Settings
.head 5 -  GUID:
.head 5 -  Type:
.head 5 -  Activation: Class Default
.head 5 -  Host Name:
.head 5 -  Window Location and Size
.head 6 -  Left: 8.7"
.head 6 -  Top: 1.583"
.head 6 -  Width:  0.383"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On OnSendProgress
.data ONX_INT
0000: 0B000000
.enddata
.data CLASSPROPSSIZE
0000: 3300
.enddata
.data CLASSPROPS
0000: 50524F505F494944 0027007B44333441 314633332D344635 412D344342412D39
0020: 4545322D31363331 4643344641353138 7D0000
.enddata
.head 6 +  Parameters
.head 7 +  Number: ABytesProceed
.head 8 -  Use: VT_I4
.head 7 +  Number: ATotalBytes
.head 8 -  Use: VT_I4
.head 6 +  Actions
.head 7 -  Set dfFait  = ABytesProceed
.head 7 -  Set dfAFaire = ATotalBytes
.head 7 -  !
.head 7 +  If dfAFaire != 0
.head 8 -  Call cMeter.SetProgress( (dfFait/ dfAFaire)*100)
.head 3 -  ! << 2009
.head 3 -  !
.head 3 -  Background Text: Url :
.head 4 -  Resource Id: 9201
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.183"
.head 5 -  Top: 0.179"
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfUrl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.583"
.head 6 -  Top: 0.155"
.head 6 -  Width:  5.05"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Fichier :
.head 4 -  Resource Id: 9202
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 5.733"
.head 5 -  Top: 0.179"
.head 5 -  Width:  0.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfFichier
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 6.483"
.head 6 -  Top: 0.155"
.head 6 -  Width:  5.05"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Custom Control: cMeter
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cMeter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.2"
.head 6 -  Top: 0.5"
.head 6 -  Width:  11.283"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Data Field: dfMessage
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 2.8"
.head 6 -  Top: 0.917"
.head 6 -  Width:  6.183"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  ! << 2009
.head 3 +  ! Pushbutton: pbUpload
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Upload
.head 4 -  Window Location and Size
.head 5 -  Left: 2.3"
.head 5 -  Top: 1.5"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Click
.head 6 -  Set wbOk =  axUp.PropSetUseHttpRequest( TRUE )
.head 6 -  Set wbOk =  axUp.PropSetPassword(psPass )
.head 6 -  Set wbOk =  axUp.PropSetUserName( psUser)
.head 6 -  Set wbOk =  axUp.PropSeturl (psUrl)
.head 6 -  !
.head 6 -  Set wbOk = axRequest.AddSubmitFile( "", lcItem )
.head 6 -  Set wbOk =  lcItem.PropSetFileName( psFile)
.head 6 -  Set wbOk =  lcItem.PropSetFieldName( "userfile" )
.head 6 -  !
.head 6 -  Call SalActiveXGetObject( axRequest, IclRequest )
.head 6 -  Set wbOk =  axUp.PropSetHttpRequest( IclRequest )
.head 6 -  Set wbOk =  axUp.PropSetKeepConnection( FALSE)
.head 6 -  ! Set wbOk =  axUp.PropSetKeepConnection( TRUE)
.head 6 -  ! Proxy
.head 6 +  If pnProxyPort != 0
.head 7 -  Set wbOk =  axUp.PropGetHttpProxySettings( lcProxySettings )
.head 7 -  Set wbOk =  lcProxySettings.PropSetAuthenticationType( clInetSuiteX6_EclAuthenticationType_atBasic )
.head 7 -  ! Set wbOk =  lcProxySettings.PropSetAuthenticationType( clInetSuiteX6_EclAuthenticationType_atAutoDetect )
.head 6 -  Set wbOk =  lcProxySettings.PropSetServer( psProxyServeur)
.head 6 -  Set wbOk =  lcProxySettings.PropSetPort( pnProxyPort )
.head 6 -  Set wbOk =  lcProxySettings.PropSetUserName( psProxyUser)
.head 6 -  Set wbOk =  lcProxySettings.PropSetPassword( psProxyPass)
.head 6 -  !
.head 6 -  !
.head 6 -  Set wbOk =  axUp.Start( TRUE )
.head 6 -  !
.head 6 +  If wbOk = 0
.head 7 -  Set wbOk =  axUp.GetLastError( oleErreur )
.head 7 -  Set psMsgErreur=oleErreur.description
.head 7 +  If SalStrScan( psMsgErreur, 'open file' ) != -1
.head 8 -  Set wnErreur = -2
.head 7 +  Else 
.head 8 -  Set wnErreur = 9
.head 7 -  !
.head 7 -  ! Set psMsgErreur = 'Erreur lors de la connection'
.head 7 -  Call SalEndDialog( dlgUpload, wnErreur )
.head 6 +  !
.head 7 -  ! Set wbOk =  axHttp.PropSetRequest( axRequest)
.head 7 -  ! Set wbOk =  axHttp.Post( 'http://10.184.10.33/debug2.php', lcReponse )
.head 7 -  ! Set wbOk  =lcReponse.PropGetText( wsReponse )
.head 7 -  ! Call SalMessageBox( wsReponse, 'Titre', MB_Ok )
.head 3 +  Pushbutton: pbUpload
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Upload
.head 4 -  Window Location and Size
.head 5 -  Left: 2.3"
.head 5 -  Top: 1.5"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set dfFait = 0
.head 6 -  Set dfAFaire = 0
.head 6 -  Call cMeter.SetProgress(0)
.head 6 -  !
.head 6 -  Call SalActiveXGetObject( axRequest, IclRequest )
.head 6 -  Set wbOk =  axHttp.PropSetRequest( IclRequest )
.head 6 +  If pnProxyPort != 0
.head 7 -  Set wbOk =  axHttp.PropGetProxySettings( lcProxySettings )
.head 7 -  Set wbOk =  lcProxySettings.PropSetAuthenticationType( clInetSuiteX6_EclAuthenticationType_atBasic )
.head 7 -  !
.head 7 -  Set wbOk =  lcProxySettings.PropSetServer( psProxyServeur)
.head 7 -  Set wbOk =  lcProxySettings.PropSetPort( pnProxyPort )
.head 7 -  Set wbOk =  lcProxySettings.PropSetUserName( psProxyUser)
.head 7 -  Set wbOk =  lcProxySettings.PropSetPassword( psProxyPass)
.head 6 -  !
.head 6 -  Set wbOk = axRequest.AddSubmitFile( "", lcItem )
.head 6 -  Set wbOk =  lcItem.PropSetFileName( psFile)
.head 6 -  Set wbOk =  lcItem.PropSetFieldName( "userfile" )
.head 6 -  !
.head 6 -  !
.head 6 -  Set wbOk =  axHttp.PropSetTimeOut( gnHttpTimeout )
.head 6 -  Set gdDebut = SalDateCurrent(  )
.head 6 -  Set wbOk =  axHttp.Post( psUrl, lcReponse)
.head 6 -  !
.head 6 +  If wbOk = 0
.head 7 -  Set wbOk =  axHttp.GetLastError( oleErreur )
.head 7 -  Set psMsgErreur=oleErreur.description
.head 7 +  If SalStrScan( psMsgErreur, 'open file' ) != -1
.head 8 -  Set wnErreur = -2
.head 7 +  Else
.head 8 -  Set wnErreur = 9
.head 7 -  !
.head 7 -  Set wbUploadOk = FALSE
.head 7 -  Set wbOk =  axHttp.Close(  )
.head 7 -  Call SalEndDialog( dlgUpload, wnErreur )
.head 6 +  Else
.head 7 -  Set wbUploadOk = TRUE
.head 7 -  Set wbOk =  axHttp.Close(  )
.head 7 -  Call SalEndDialog( dlgUpload, 0 )
.head 6 +  !
.head 7 -  ! Set wbOk =  axHttp.PropSetRequest( axRequest)
.head 7 -  ! Set wbOk =  axHttp.Post( 'http://10.184.10.33/debug2.php', lcReponse )
.head 7 -  ! Set wbOk  =lcReponse.PropGetText( wsReponse )
.head 7 -  ! Call SalMessageBox( wsReponse, 'Titre', MB_Ok )
.head 3 -  ! 2009 >>
.head 3 +  ! Pushbutton: pbStop
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Stop
.head 4 -  Window Location and Size
.head 5 -  Left: 2.3"
.head 5 -  Top: 2.0"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Click
.head 6 -  !
.head 6 -  Set wbOk =  axUp.Stop( )
.head 6 +  If gnLanguage = Language_NL
.head 7 -  Set psMsgErreur ='Operatie stopgezet'
.head 6 +  Else 
.head 7 -  Set psMsgErreur ='Opératon stoppée'
.head 6 -  Call SalEndDialog(dlgUpload, -1 )
.head 3 -  !
.head 3 -  Background Text: Fait :
.head 4 -  Resource Id: 9203
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 4.4"
.head 5 -  Top: 1.833"
.head 5 -  Width:  0.483"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfFait
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 5.3"
.head 6 -  Top: 1.833"
.head 6 -  Width:  1.683"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: A faire :
.head 4 -  Resource Id: 9204
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 4.4"
.head 5 -  Top: 1.5"
.head 5 -  Width:  0.683"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfAFaire
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 5.3"
.head 6 -  Top: 1.5"
.head 6 -  Width:  1.683"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: psUrl
.head 3 -  Boolean: pbVisu
.head 3 -  String: psFile
.head 3 -  String: psUser
.head 3 -  String: psPass
.head 3 -  String: psProxyServeur
.head 3 -  Number: pnProxyPort
.head 3 -  String: psProxyUser
.head 3 -  String: psProxyPass
.head 3 -  Receive String: psMsgErreur
.head 2 +  Window Variables
.head 3 -  FunctionalVar: IclRequest
.head 4 -  Class: clInetSuiteX6_IclHttpRequest
.head 3 -  FunctionalVar: lcItem
.head 4 -  Class: clInetSuiteX6_IclSubmitFileRequestItem
.head 3 -  FunctionalVar: lcProxySettings
.head 4 -  Class: clInetSuiteX6_IclHttpProxySettings
.head 3 -  Number: wnFait
.head 3 -  Number: wnAFaire
.head 3 -  Boolean: wbOk
.head 3 -  Boolean: wbUploadOk
.head 3 -  FunctionalVar: oleErreur
.head 4 -  Class: OleErrorInfo
.head 3 -  Number: wnErreur
.head 3 -  String: wsErreur
.head 3 -  String: wsReturn
.head 3 -  !
.head 3 -  FunctionalVar: lcReponse
.head 4 -  Class: clInetSuiteX6_IclReadonlyStrings
.head 3 -  FunctionalVar: lcErrorList
.head 4 -  Class: clInetSuiteX6_IclErrorList
.head 3 -  String: wsReponse
.head 3 -  !
.head 3 -  Number: wnBoucle
.head 3 -  Number: wnFaitOld0
.head 3 -  Number: wnFaitOld1
.head 3 -  Number: wnFaitOld2
.head 3 -  Number: wnFaitOld3
.head 3 -  Number: wnFaitOld4
.head 3 -  Number: wnFaitMinOld
.head 3 -  Number: wnLargeur
.head 3 -  Number: wnHauteur
.head 2 +  Message Actions
.head 3 +  On SAM_CreateComplete
.head 4 -  Set dfUrl = psUrl
.head 4 -  Set dfFichier  = psFile
.head 4 -  Call SalSetFocus( hWndNULL )
.head 4 -  Call SalSendMsg( pbUpload, SAM_Click,wParam,lParam )
.head 4 -  !
.head 3 +  On SAM_Create
.head 4 -  ! Call SalHideWindow( pbStop )
.head 4 -  Call SalHideWindowAndLabel( dfAFaire )
.head 4 -  Call SalHideWindowAndLabel( dfFait )
.head 4 +  If pbVisu
.head 5 -  Call SalHideWindow( hWndForm )
.head 4 +  Else
.head 5 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call SalActiveXAutoErrorMode( FALSE )
.head 3 +  On SAM_Close
.head 4 -  Set psMsgErreur = 'Cancel by user ! '
.head 4 -  Call SalEndDialog( dlgUpload, -1 )
.head 1 +  Dialog Box: dlgDownload
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Chargement d'un fichier
.head 2 -  Accessories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: 3.125"
.head 4 -  Top: 2.052"
.head 4 -  Width:  11.233"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 1.44"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  Resizable? No
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  ActiveX: axDown
.data CLASSPROPSSIZE
0000: 1300
.enddata
.data CLASSPROPS
0000: 4C69634B65794C65 6E00040000000000 000000
.enddata
.data RESOURCE 5 0 1 392875524
0000: 000A000043020000 0000000000000000 020000D0CF11E0A1 B11AE1F8000000FF
0020: 003E000300FEFF09 00F0060000000F01 000000F601000110 0000020000002601
0040: 00FEFFFFF8000000 F8FFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0060: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0080: FF40FDFFFFFFFEFF FF66FEFFFEFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00C0: FFFFFFFFFFFFFFFF FFFFFFFF2052006F 006F740081004500 6E0074C072007900
00E0: 0000FFFFFFFFFFA0 16000500FFFF4F01 000000D39D107072 3FF14E0080BF76BF
0100: 64923237F8000000 0F90D4589A000673 C80103000000F280 0000284A00454550
0120: 000853007243004F 00C24F4C000000FF FFFFFFFF82160201 FFFFFFFFFA0000FF
0140: FFFFFFF066000000 FFFFFFFFFFFFFFFF AFFFFFFFFA0000FF FFFFFFFFFFFFFFFF
0160: FFFFFFFFAFFFFFFF FA0000FFFFFFFFFF 660100FEFFFFFFFF FFFFFFFFFFFFFFFF
0180: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
01A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF00545046 300D54636C00446F
01C0: 776E4C6F61640065 72000B5468726500 6164436F756E7402 00010D496E746572
01E0: 6E0065744167656E 740600334D6F7A69 6C6C61102F342E30 28636F006D706174
0200: 69626C65023B436C 65766572A820496E 656E012053756974 652080362E322900
0220: 0000FFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0240: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFF
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: AX_clInetSuiteX6_clDownLoader
.head 4 -  Property Template:
.head 4 -  License Key:
.head 4 -  Display Settings
.head 5 -  GUID:
.head 5 -  Type:
.head 5 -  Activation: Class Default
.head 5 -  Host Name:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.8"
.head 6 -  Top: 1.595"
.head 6 -  Width:  0.383"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On OnStatusChanged
.data ONX_INT
0000: 02000000
.enddata
.data CLASSPROPSSIZE
0000: 3300
.enddata
.data CLASSPROPS
0000: 50524F505F494944 0027007B30433931 453133362D384446 412D343538352D38
0020: 3134342D36384438 3841303844353031 7D0000
.enddata
.head 6 +  Parameters
.head 7 +  Number: Status
.head 8 -  Use: VT_I4
.head 6 +  Actions
.head 7 -  Set wbDownloadOk = FALSE
.head 7 +  If Status = clInetSuiteX6_EclProcessStatus_psSuccess
.head 8 -  Set wbDownloadOk = TRUE
.head 8 +  If gnLanguage = Language_NL
.head 9 -  Set dfMessage = ' OnStatusChanged : ' || SalNumberToStrX( Status,0 ) || ' Succes '
.head 8 +  Else
.head 9 -  Set dfMessage = ' OnStatusChanged : ' || SalNumberToStrX( Status,0 ) || ' Succès '
.head 7 +  Else If Status = clInetSuiteX6_EclProcessStatus_psFailed
.head 8 -  Set wbOk =  axDown.PropGetErrors( lcErrorList )
.head 8 -  Set wbOk  =lcErrorList.PropGetErrors( 0, wsErreur)
.head 8 -  Set wbOk  =lcErrorList.PropGetErrorCodes( 0, wnErreur )
.head 8 +  If gnLanguage = Language_NL
.head 9 -  Set dfMessage = ' OnStatusChanged : ' || SalNumberToStrX( Status,0 ) || '  Fout :  ' || wsErreur
.head 8 +  Else
.head 9 -  Set dfMessage = ' OnStatusChanged : ' || SalNumberToStrX( Status,0 ) || '  Erreur :  ' || wsErreur
.head 8 -  Set wbOk =  axDown.CloseConnection(  )
.head 8 -  Set psMsgErreur=dfMessage
.head 8 -  Call SalEndDialog( hWndForm, wnErreur )
.head 7 +  Else If Status = clInetSuiteX6_EclProcessStatus_psTerminated
.head 8 +  If gnLanguage = Language_NL
.head 9 -  Set dfMessage = ' OnStatusChanged : ' || SalNumberToStrX( Status,0 ) || ' Transfer stopgezet ! '
.head 8 +  Else
.head 9 -  Set dfMessage = ' OnStatusChanged : ' || SalNumberToStrX( Status,0 ) || ' Transfert stoppé ! '
.head 7 +  Else If Status = clInetSuiteX6_EclProcessStatus_psErrors
.head 8 -  Set wbOk =  axDown.PropGetErrors( lcErrorList )
.head 8 -  Set wbOk  =lcErrorList.PropGetErrors( 0, wsErreur )
.head 8 -  Set wbOk  =lcErrorList.PropGetErrorCodes( 0, wnErreur )
.head 8 +  If gnLanguage = Language_NL
.head 9 -  Set dfMessage = ' OnStatusChanged : ' || SalNumberToStrX( Status,0 ) || ' Transfer beeïndigd met fouten  :  '  || wsErreur
.head 8 +  Else
.head 9 -  Set dfMessage = ' OnStatusChanged : ' || SalNumberToStrX( Status,0 ) || ' Transfert terminé avec des erreurs  :  '  || wsErreur
.head 8 -  Set wbOk =  axDown.CloseConnection(  )
.head 8 -  Set psMsgErreur=dfMessage
.head 8 -  Call SalEndDialog( hWndForm, wnErreur )
.head 7 +  Else If Status = clInetSuiteX6_EclProcessStatus_psProcess
.head 8 +  If gnLanguage = Language_NL
.head 9 -  Set dfMessage = ' OnStatusChanged : ' || SalNumberToStrX( Status,0 ) || ' Operatie is bezig  !  '
.head 8 +  Else
.head 9 -  Set dfMessage = ' OnStatusChanged : ' || SalNumberToStrX( Status,0 ) || ' Opération lancée  !  '
.head 7 +  Else
.head 8 -  Set dfMessage = ' OnStatusChanged : code status = ' || SalNumberToStrX( Status,0 )
.head 7 -  Set psMsgErreur=dfMessage
.head 5 +  On OnProcessCompleted
.data ONX_INT
0000: 09000000
.enddata
.data CLASSPROPSSIZE
0000: 3300
.enddata
.data CLASSPROPS
0000: 50524F505F494944 0027007B30433931 453133362D384446 412D343538352D38
0020: 3134342D36384438 3841303844353031 7D0000
.enddata
.head 6 -  Parameters
.head 6 +  Actions
.head 7 -  Set wbOk =  axDown.CloseConnection(  )
.head 7 +  If (dfAFaire = dfFait) and dfFait != 0
.head 8 -  Set psMsgErreur=''
.head 8 -  ! Set wbOk =  axDown.CloseConnection(  )
.head 8 -  Call SalEndDialog( hWndForm, 0 )
.head 7 +  Else
.head 8 -  Set psMsgErreur=' Erreur de longueur '
.head 8 -  Set wnErreur= -3
.head 8 -  ! Set wbOk =  axDown.CloseConnection(  )
.head 8 -  Call SalEndDialog( hWndForm, wnErreur )
.head 5 +  On OnGetCertificate
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 50524F505F494944 0027007B30433931 453133362D384446 412D343538352D38
0020: 3134342D36384438 3841303844353031 7D00000000
.enddata
.data CLASSPROPSSIZE
0000: 3500
.enddata
.data ONX_INT
0000: 0A000000
.enddata
.head 6 +  Parameters
.head 7 -  FunctionalVar: ACertificate
.head 8 -  Class:
.head 7 -  Receive Boolean: Handled
.head 6 +  Actions
.head 7 -  Call SalMessageBox( '', '', 0 )
.head 5 +  On OnError
.data ONX_INT
0000: 05000000
.enddata
.data CLASSPROPSSIZE
0000: 3300
.enddata
.data CLASSPROPS
0000: 50524F505F494944 0027007B41444143 374645372D353946 432D343833432D38
0020: 3736362D37464333 3435383746373244 7D0000
.enddata
.head 6 +  Parameters
.head 7 -  String: Error
.head 7 +  Number: ErrorCode
.head 8 -  Use: VT_I4
.head 6 +  Actions
.head 7 -  Set wbDownloadOk = FALSE
.head 7 -  Set wnErreur =ErrorCode
.head 7 -  Set dfMessage = Error
.head 7 -  Set psMsgErreur=dfMessage
.head 7 -  Set wbOk =  axDown.CloseConnection(  )
.head 7 -  Call SalEndDialog( hWndForm, wnErreur )
.head 5 +  On OnDataItemProceed
.data ONX_INT
0000: 04000000
.enddata
.data CLASSPROPSSIZE
0000: 3300
.enddata
.data CLASSPROPS
0000: 50524F505F494944 0027007B41444143 374645372D353946 432D343833432D38
0020: 3736362D37464333 3435383746373244 7D0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Parameters
.head 7 -  FunctionalVar: ResourceInfo
.head 8 -  Class: clInetSuiteX6_IclResourceInfo
.head 7 -  FunctionalVar: StateItem
.head 8 -  Class: clInetSuiteX6_IclResourceStateItem
.head 6 +  Actions
.head 7 -  Set wbOk = StateItem.PropGetBytesProceed( dfFait )
.head 7 -  Set wbOk = StateItem.PropGetBytesToProceed( dfAFaire )
.head 7 -  !
.head 7 +  If dfAFaire != 0
.head 8 -  Call cMeter.SetProgress( (dfFait/ dfAFaire)*100)
.head 7 -  !
.head 3 -  Background Text: Url :
.head 4 -  Resource Id: 9206
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.183"
.head 5 -  Top: 0.179"
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfUrl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.583"
.head 6 -  Top: 0.155"
.head 6 -  Width:  5.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Fichier :
.head 4 -  Resource Id: 9207
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 5.883"
.head 5 -  Top: 0.179"
.head 5 -  Width:  0.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfFichier
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 6.533"
.head 6 -  Top: 0.155"
.head 6 -  Width:  4.35"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Custom Control: cMeter
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cMeter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.2"
.head 6 -  Top: 0.5"
.head 6 -  Width:  10.683"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Data Field: dfMessage
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.933"
.head 6 -  Top: 0.964"
.head 6 -  Width:  6.183"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Pushbutton: pbDown
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Download
.head 4 -  Window Location and Size
.head 5 -  Left: 2.5"
.head 5 -  Top: 1.5"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set dfFait = 0
.head 6 -  Set dfAFaire = 0
.head 6 -  Call cMeter.SetProgress(0)
.head 6 -  !
.head 6 -  Set wnBoucle = 0
.head 6 -  Set wbOk =  axDown.PropSeturl (psUrl)
.head 6 -  Set wbOk =  axDown.PropSetPassword(psPass )
.head 6 -  Set wbOk =  axDown.PropSetUserName( psUser)
.head 6 -  Set wbOk =  axDown.PropSetLocalFile( psFile )
.head 6 -  Set wbOk =  axDown.PropSetLocalFolder( psFolder )
.head 6 -  !
.head 6 -  Set wbOk =  axDown.PropSetthreadCount( 1 )
.head 6 -  Set wbOk =  axDown.PropSetKeepConnection( FALSE)
.head 6 -  ! Proxy
.head 6 +  If pnProxyPort != 0
.head 7 -  Set wbOk =  axDown.PropGetHttpProxySettings( lcProxySettings )
.head 7 -  Set wbOk =  lcProxySettings.PropSetAuthenticationType( clInetSuiteX6_EclAuthenticationType_atBasic )
.head 7 -  ! Set wbOk =  lcProxySettings.PropSetAuthenticationType( clInetSuiteX6_EclAuthenticationType_atAutoDetect )
.head 6 -  Set wbOk =  lcProxySettings.PropSetServer( psProxyServeur)
.head 6 -  Set wbOk =  lcProxySettings.PropSetPort( pnProxyPort )
.head 6 -  Set wbOk =  lcProxySettings.PropSetUserName( psProxyUser)
.head 6 -  Set wbOk =  lcProxySettings.PropSetPassword( psProxyPass)
.head 6 -  !
.head 6 -  Set wbOk =  axDown.PropSetTimeOut( gnHttpTimeout )
.head 6 -  Set gdDebut = SalDateCurrent(  )
.head 6 -  Set wbOk =  axDown.Start( TRUE )
.head 6 -  !
.head 6 +  If wbOk = 0
.head 7 -  Set wbOk =  axDown.GetLastError( oleErreur )
.head 7 -  Set psMsgErreur=oleErreur.description
.head 7 +  If SalStrScan( psMsgErreur, 'open file' ) != -1
.head 8 -  Set wnErreur = -2
.head 7 +  Else
.head 8 -  Set wnErreur = 9
.head 7 -  !
.head 7 -  ! Set psMsgErreur = 'Erreur lors de la connection'
.head 7 -  Call SalEndDialog( hWndForm, wnErreur )
.head 6 +  !
.head 7 -  ! Set wbOk =  axHttp.PropSetRequest( axRequest)
.head 7 -  ! Set wbOk =  axHttp.Post( 'http://10.184.10.33/debug2.php', lcReponse )
.head 7 -  ! Set wbOk  =lcReponse.PropGetText( wsReponse )
.head 7 -  ! Call SalMessageBox( wsReponse, 'Titre', MB_Ok )
.head 3 +  Pushbutton: pbStop
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Stop
.head 4 -  Window Location and Size
.head 5 -  Left: 2.5"
.head 5 -  Top: 2.0"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  !
.head 6 -  Set wbOk =  axDown.Stop( )
.head 6 +  If gnLanguage = Language_NL
.head 7 -  Set psMsgErreur ='Operatie stopgezet'
.head 6 +  Else
.head 7 -  Set psMsgErreur ='Opératon stoppée'
.head 6 -  Call SalEndDialog( hWndForm, -1 )
.head 3 -  !
.head 3 -  Background Text: Fait :
.head 4 -  Resource Id: 9208
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 4.4"
.head 5 -  Top: 1.833"
.head 5 -  Width:  0.483"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfFait
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 5.3"
.head 6 -  Top: 1.833"
.head 6 -  Width:  1.683"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: A faire :
.head 4 -  Resource Id: 9209
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 4.4"
.head 5 -  Top: 1.5"
.head 5 -  Width:  0.683"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfAFaire
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 5.3"
.head 6 -  Top: 1.5"
.head 6 -  Width:  1.683"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Index :
.head 4 -  Resource Id: 9210
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 4.4"
.head 5 -  Top: 2.19"
.head 5 -  Width:  0.483"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  !
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: psUrl
.head 3 -  Boolean: pbVisu
.head 3 -  String: psFile
.head 3 -  String: psFolder
.head 3 -  String: psUser
.head 3 -  String: psPass
.head 3 -  String: psProxyServeur
.head 3 -  Number: pnProxyPort
.head 3 -  String: psProxyUser
.head 3 -  String: psProxyPass
.head 3 -  Receive String: psMsgErreur
.head 2 +  Window Variables
.head 3 -  Number: wnFait
.head 3 -  Number: wnAFaire
.head 3 -  Boolean: wbOk
.head 3 -  Boolean: wbDownloadOk
.head 3 -  FunctionalVar: oleErreur
.head 4 -  Class: OleErrorInfo
.head 3 -  Number: wnErreur
.head 3 -  String: wsErreur
.head 3 -  !
.head 3 -  FunctionalVar: lcReponse
.head 4 -  Class: clInetSuiteX6_IclReadonlyStrings
.head 3 -  FunctionalVar: lcErrorList
.head 4 -  Class: clInetSuiteX6_IclErrorList
.head 3 -  FunctionalVar: lcProxySettings
.head 4 -  Class: clInetSuiteX6_IclHttpProxySettings
.head 3 -  ComProxyVar: lcCertificateStore
.head 4 -  Class: clInetSuiteX6_clCertificateStore
.head 3 -  FunctionalVar: lcCertificateStoreControl
.head 4 -  Class: clInetSuiteX6_IclCertificateStoreControl
.head 3 -  String: wsReponse
.head 3 -  !
.head 3 -  String: wsType
.head 3 -  String: wsDisposition
.head 3 -  String: wsName
.head 3 -  Date/Time: wdtDate
.head 3 -  Number: wnSize
.head 3 -  Number: wnStatus
.head 3 -  Number: wnBoucle
.head 3 -  Number: wnFaitOld0
.head 3 -  Number: wnFaitOld1
.head 3 -  Number: wnFaitOld2
.head 3 -  Number: wnFaitOld3
.head 3 -  Number: wnFaitOld4
.head 3 -  Number: wnFaitMinOld
.head 3 -  Number: wnLargeur
.head 3 -  Number: wnHauteur
.head 2 +  Message Actions
.head 3 +  On SAM_CreateComplete
.head 4 -  Set dfUrl = psUrl
.head 4 -  Set dfFichier  = psFile
.head 4 -  Set wbOk =  axDown.PropSetTryCount( gnHttpNbrEssais )
.head 4 -  Set wbOk =  axDown.PropSetTimeOut( gnHttpTimeout )
.head 4 -  !
.head 4 -  Call SalSetFocus( hWndNULL )
.head 4 -  Call SalSendMsg( pbDown, SAM_Click,wParam,lParam )
.head 3 +  On SAM_Create
.head 4 -  ! << 2009
.head 4 +  ! If pbVisu
.head 5 -  Call SalHideWindow( hWndForm )
.head 4 +  ! Else 
.head 5 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  ! 2009 >>
.head 4 -  Call SalActiveXAutoErrorMode( FALSE )
.head 3 +  On SAM_Close
.head 4 -  Set wbOk =  axDown.CloseConnection(  )
.head 4 -  Set wbOk =  wbOk
.head 1 +  Dialog Box: dlgIniFileManager
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accessories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: 18.7"
.head 4 -  Top: 2.698"
.head 4 -  Width:  12.45"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.845"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  Resizable? No
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.head 2 -  Description: Paramétrage transferts (http, https, upload, dowload, proxy)
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  !
.head 3 +  Pushbutton: pbQuit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: 11.533"
.head 5 -  Top: 4.036"
.head 5 -  Width:  0.65"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.45"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalPicSet( hWndItem, resExitWinCock , PIC_FormatBitmap )
.head 5 +  On SAM_Click
.head 6 -  Set wbFermetureAutorisee = TRUE
.head 6 -  ! TYPE (http, https)
.head 6 -  Set gsHttpType = SalNumberToStrX( SalListQuerySelection( cmbTypeHttp ), 0 )
.head 6 -  Call SalSetProfileString( 'HTTP_TYPE', 'HTTP_TYPE',  gsHttpType, pwsPathnameIni )
.head 6 -  !
.head 6 -  Set gbInterne = cbInterne
.head 6 -  Call SalSetProfileInt( 'HTTP_TYPE', 'HTTP_INTERNE',  gbInterne, pwsPathnameIni )
.head 6 -  ! Activé ?
.head 6 -  Set gbHttpActif = cbHttpActif
.head 6 -  Call SalSetProfileInt( 'HTTP_TYPE', 'HTTP_ON',  gbHttpActif, pwsPathnameIni )
.head 6 -  !
.head 6 -  Call SalEndDialog( hWndForm, FALSE )
.head 3 -  !
.head 3 -  !
.head 3 +  Data Field: labTypeHttp
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 4C6162656C650001 0000004C6162656C 6E00010000004C61 62656C6600010000
0020: 004C6162656C6400 0100000000000000 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3400
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template: C:\P_LIB\LANGUE\Qo_lang.exe,frmPropertiesLanguage,Translation...,,N,N
.head 4 -  Class DLL Name: QUIKPDLG.DLL
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 3.283"
.head 6 -  Top: 0.226"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalDisableWindow( hWndItem )
.head 6 -  Set MyValue = 'Type HTTP: '
.head 3 +  Combo Box: cmbTypeHttp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 5.183"
.head 5 -  Top: 0.214"
.head 5 -  Width:  1.267"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.357"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 +  List Initialization
.head 5 -  Text: HTTP
.head 5 -  Text: HTTPS
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalListSetSelect( cmbTypeHttp, 0 )
.head 5 +  On SAM_Click
.head 6 -  Call PalManageHttpsPwd(  )
.head 6 -  Call PalInitTestDirectory(  )
.head 6 -  Call PalInitCockpitSrvIp(  )
.head 6 -  Call PalInitUpDown(  )
.head 3 +  Data Field: labTypeABC
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 4C6162656C650001 0000004C6162656C 6E00010000004C61 62656C6600010000
0020: 004C6162656C6400 0100000000000000 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3400
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template: C:\P_LIB\LANGUE\Qo_lang.exe,frmPropertiesLanguage,Translation...,,N,N
.head 4 -  Class DLL Name: QUIKPDLG.DLL
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.083"
.head 6 -  Top: 0.226"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalDisableWindow( hWndItem )
.head 6 -  Set MyValue = 'A, B, C: '
.head 3 +  Combo Box: cmbTypeABC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 1.883"
.head 5 -  Top: 0.22"
.head 5 -  Width:  1.267"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 +  List Initialization
.head 5 -  Text: A
.head 5 -  Text: B
.head 5 -  Text: C
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call PalManageHttpsPwd(  )
.head 6 -  Call PalInitTestDirectory(  )
.head 6 -  Call PalInitCockpitSrvIp(  )
.head 6 -  Call PalInitUpDown(  )
.head 5 +  On SAM_Create
.head 6 -  Call SalListSetSelect( cmbTypeABC, 0 )
.head 3 +  Data Field: labHttpsCockpit
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 4C6162656C650001 0000004C6162656C 6E00010000004C61 62656C6600010000
0020: 004C6162656C6400 0100000000000000 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3400
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template: C:\P_LIB\LANGUE\Qo_lang.exe,frmPropertiesLanguage,Translation...,,N,N
.head 4 -  Class DLL Name: QUIKPDLG.DLL
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.483"
.head 6 -  Top: 0.976"
.head 6 -  Width:  1.667"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalDisableWindow( hWndItem )
.head 6 -  Set MyValue = 'Cockpit :'
.head 3 +  Data Field: dfHttpsCockpit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 100
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 2.317"
.head 6 -  Top: 0.976"
.head 6 -  Width:  8.867"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: ###0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: System Window Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call PalSaveCurrentValues(  )
.head 3 +  Data Field: labHttpsUp
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 4C6162656C650001 0000004C6162656C 6E00010000004C61 62656C6600010000
0020: 004C6162656C6400 0100000000000000 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3400
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template: C:\P_LIB\LANGUE\Qo_lang.exe,frmPropertiesLanguage,Translation...,,N,N
.head 4 -  Class DLL Name: QUIKPDLG.DLL
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.483"
.head 6 -  Top: 1.31"
.head 6 -  Width:  1.667"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalDisableWindow( hWndItem )
.head 6 -  Set MyValue = 'UPLOAD :'
.head 3 +  Data Field: dfHttpsUp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 100
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 2.317"
.head 6 -  Top: 1.31"
.head 6 -  Width:  8.867"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: ###0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: System Window Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call PalSaveCurrentValues(  )
.head 3 +  Data Field: labHttpsDown
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 4C6162656C650001 0000004C6162656C 6E00010000004C61 62656C6600010000
0020: 004C6162656C6400 0100000000000000 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3400
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template: C:\P_LIB\LANGUE\Qo_lang.exe,frmPropertiesLanguage,Translation...,,N,N
.head 4 -  Class DLL Name: QUIKPDLG.DLL
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.483"
.head 6 -  Top: 1.643"
.head 6 -  Width:  1.667"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalDisableWindow( hWndItem )
.head 6 -  Set MyValue = 'DOWNLOAD :'
.head 3 +  Data Field: dfHttpsDown
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 100
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 2.317"
.head 6 -  Top: 1.643"
.head 6 -  Width:  8.867"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: ###0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: System Window Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call PalSaveCurrentValues(  )
.head 3 +  Data Field: labHttpsUser
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 4C6162656C650001 0000004C6162656C 6E00010000004C61 62656C6600010000
0020: 004C6162656C6400 0100000000000000 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3400
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template: C:\P_LIB\LANGUE\Qo_lang.exe,frmPropertiesLanguage,Translation...,,N,N
.head 4 -  Class DLL Name: QUIKPDLG.DLL
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.483"
.head 6 -  Top: 1.976"
.head 6 -  Width:  1.667"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalDisableWindow( hWndItem )
.head 6 -  Set MyValue = 'USERNAME :'
.head 3 +  Data Field: dfHttpsUser
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 100
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 2.317"
.head 6 -  Top: 1.976"
.head 6 -  Width:  8.867"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: System Window Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call PalSaveCurrentValues(  )
.head 3 +  Data Field: labHttpsPwd
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 4C6162656C650001 0000004C6162656C 6E00010000004C61 62656C6600010000
0020: 004C6162656C6400 0100000000000000 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3400
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template: C:\P_LIB\LANGUE\Qo_lang.exe,frmPropertiesLanguage,Translation...,,N,N
.head 4 -  Class DLL Name: QUIKPDLG.DLL
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.483"
.head 6 -  Top: 2.31"
.head 6 -  Width:  1.667"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalDisableWindow( hWndItem )
.head 6 -  Set MyValue = 'PWD :'
.head 3 +  Data Field: dfHttpsPwd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 100
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 2.317"
.head 6 -  Top: 2.31"
.head 6 -  Width:  8.867"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: System Window Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call PalSaveCurrentValues(  )
.head 3 -  Group Box: HTTP(S)
.head 4 -  Resource Id: 13665
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.183"
.head 5 -  Top: 0.619"
.head 5 -  Width:  11.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.06"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: labProxy
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 4C6162656C650001 0000004C6162656C 6E00010000004C61 62656C6600010000
0020: 004C6162656C6400 0100000000000000 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3400
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template: C:\P_LIB\LANGUE\Qo_lang.exe,frmPropertiesLanguage,Translation...,,N,N
.head 4 -  Class DLL Name: QUIKPDLG.DLL
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.483"
.head 6 -  Top: 3.143"
.head 6 -  Width:  1.667"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalDisableWindow( hWndItem )
.head 6 -  Set MyValue = 'PROXY :'
.head 3 +  Data Field: dfProxy
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 60
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 2.317"
.head 6 -  Top: 3.167"
.head 6 -  Width:  8.867"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: ###0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: System Window Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call PalSaveCurrentValues(  )
.head 3 +  Data Field: labProxyPort
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 4C6162656C650001 0000004C6162656C 6E00010000004C61 62656C6600010000
0020: 004C6162656C6400 0100000000000000 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3400
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template: C:\P_LIB\LANGUE\Qo_lang.exe,frmPropertiesLanguage,Translation...,,N,N
.head 4 -  Class DLL Name: QUIKPDLG.DLL
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.483"
.head 6 -  Top: 3.476"
.head 6 -  Width:  1.667"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalDisableWindow( hWndItem )
.head 6 -  Set MyValue = 'PORT :'
.head 3 +  Data Field: dfProxyPort
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 60
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 2.317"
.head 6 -  Top: 3.476"
.head 6 -  Width:  8.867"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: System Window Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call PalSaveCurrentValues(  )
.head 3 +  Data Field: labProxyLogin
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 4C6162656C650001 0000004C6162656C 6E00010000004C61 62656C6600010000
0020: 004C6162656C6400 0100000000000000 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3400
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template: C:\P_LIB\LANGUE\Qo_lang.exe,frmPropertiesLanguage,Translation...,,N,N
.head 4 -  Class DLL Name: QUIKPDLG.DLL
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.483"
.head 6 -  Top: 3.81"
.head 6 -  Width:  1.667"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalDisableWindow( hWndItem )
.head 6 -  Set MyValue = 'LOGIN :'
.head 3 +  Data Field: dfProxyLogin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 60
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 2.317"
.head 6 -  Top: 3.81"
.head 6 -  Width:  8.867"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Invisible
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: System Window Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call PalSaveCurrentValues(  )
.head 3 +  Data Field: labProxyPwd
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 4C6162656C650001 0000004C6162656C 6E00010000004C61 62656C6600010000
0020: 004C6162656C6400 0100000000000000 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3400
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template: C:\P_LIB\LANGUE\Qo_lang.exe,frmPropertiesLanguage,Translation...,,N,N
.head 4 -  Class DLL Name: QUIKPDLG.DLL
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.483"
.head 6 -  Top: 4.143"
.head 6 -  Width:  1.667"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalDisableWindow( hWndItem )
.head 6 -  Set MyValue = 'PWD :'
.head 3 +  Data Field: dfProxyPwd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 60
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 2.317"
.head 6 -  Top: 4.143"
.head 6 -  Width:  8.867"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Invisible
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: System Window Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call PalSaveCurrentValues(  )
.head 3 -  Group Box: PROXY
.head 4 -  Resource Id: 13666
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.183"
.head 5 -  Top: 2.786"
.head 5 -  Width:  11.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.702"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  ! Pushbutton: pbSaveCurrent
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: 10.883"
.head 5 -  Top: 0.071"
.head 5 -  Width:  0.65"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.45"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Click
.head 6 -  Call PalSaveCurrentValues(  )
.head 5 +  On SAM_Create
.head 6 -  Call SalPicSet( hWndItem, resDBleu, PIC_FormatBitmap )
.head 3 +  Data Field: dfTestDirectoryTo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 4.117"
.head 6 -  Top: 5.429"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfTestDirectoryFrom
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 2.017"
.head 6 -  Top: 5.429"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbUpdateTestDirectory
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: 6.017"
.head 5 -  Top: 5.286"
.head 5 -  Width:  0.533"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call PalSetTestDirectory(  )
.head 5 +  On SAM_Create
.head 6 -  Call SalPicSet( hWndItem, resModi , PIC_FormatBitmap )
.head 3 -  Group Box:
.head 4 -  Resource Id: 58817
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.217"
.head 5 -  Top: 5.119"
.head 5 -  Width:  6.517"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.75"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: ->
.head 4 -  Resource Id: 36692
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 3.85"
.head 5 -  Top: 5.44"
.head 5 -  Width:  0.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSrvIpTo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 4.133"
.head 6 -  Top: 6.262"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfSrvIpFrom
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 2.033"
.head 6 -  Top: 6.262"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbUpdateSrvIp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: 6.033"
.head 5 -  Top: 6.095"
.head 5 -  Width:  0.533"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call PalSetCockpitSrvIp(  )
.head 5 +  On SAM_Create
.head 6 -  Call SalPicSet( hWndItem, resModi , PIC_FormatBitmap )
.head 3 -  Group Box:
.head 4 -  Resource Id: 58818
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.233"
.head 5 -  Top: 5.929"
.head 5 -  Width:  6.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: ->
.head 4 -  Resource Id: 58820
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 3.867"
.head 5 -  Top: 6.345"
.head 5 -  Width:  0.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Cockpit
.head 4 -  Resource Id: 58821
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.933"
.head 5 -  Top: 6.345"
.head 5 -  Width:  0.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Répertoire:
.head 4 -  Resource Id: 46213
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.85"
.head 5 -  Top: 5.464"
.head 5 -  Width:  1.083"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Up / Download
.head 4 -  Resource Id: 58822
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.5"
.head 5 -  Top: 6.869"
.head 5 -  Width:  1.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfUpDownTo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 4.133"
.head 6 -  Top: 6.786"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfUpDownFrom
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 2.033"
.head 6 -  Top: 6.786"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbUpdateUpDown
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: 6.033"
.head 5 -  Top: 6.619"
.head 5 -  Width:  0.533"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call PalSetUpDown(  )
.head 5 +  On SAM_Create
.head 6 -  Call SalPicSet( hWndItem, resModi , PIC_FormatBitmap )
.head 3 -  Background Text: ->
.head 4 -  Resource Id: 58819
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 3.867"
.head 5 -  Top: 6.869"
.head 5 -  Width:  0.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Check Box: cbInterne
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Interne Stésud - Active Ligne C uniquement
.head 4 -  Window Location and Size
.head 5 -  Left: 7.033"
.head 5 -  Top: 5.357"
.head 5 -  Width:  3.85"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set gbInterne = cbInterne
.head 6 -  Call PalInterne(  )
.head 3 +  Pushbutton: pbF7
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: F7
.head 4 -  Window Location and Size
.head 5 -  Left: 11.333"
.head 5 -  Top: 6.881"
.head 5 -  Width:  0.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: F7
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSetWindowSize( hWndForm, nW, nH+2.6 )
.head 6 -  Call SalCenterWindow( hWndForm )
.head 3 +  Check Box: cbHttpActif
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ON
.head 4 -  Window Location and Size
.head 5 -  Left: 7.033"
.head 5 -  Top: 5.631"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: PalSaveCurrentValues
.head 4 -  Description: sauvegarde fichier(s) .ini
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SalListQuerySelection( cmbTypeHttp ) = 0
.head 6 -  Set gsHttpType = '0'
.head 6 -  Set gsCockpitUrl[ wnLigne] = dfHttpsCockpit 
.head 6 -  Set gsUploadUrl[wnLigne] = dfHttpsUp
.head 6 -  Set gsDownloadUrl[wnLigne] =dfHttpsDown 
.head 5 +  Else
.head 6 -  Set gsHttpType = '1'
.head 6 -  Set gsCockpitUrls[ wnLigne] = dfHttpsCockpit 
.head 6 -  Set gsUploadUrls[wnLigne] = dfHttpsUp
.head 6 -  Set gsDownloadUrls[wnLigne] =dfHttpsDown 
.head 5 -  !
.head 5 -  Set gsProxyServeur = dfProxy
.head 5 -  Set gnProxyPort = dfProxyPort
.head 5 -  Set gsProxyUser = dfProxyLogin
.head 5 -  Set gsProxyPass = dfProxyPwd
.head 5 -  !
.head 5 -  ! Save
.head 5 -  Call PalHttpIniSave( pwsPathnameIni )
.head 3 +  Function: PalManageHttpsPwd
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SalListQuerySelection( cmbTypeABC ) =0
.head 6 -  Set wnLigne = 1
.head 5 +  Else If SalListQuerySelection( cmbTypeABC ) =1
.head 6 -  Set wnLigne = 2
.head 5 +  Else
.head 6 -  Set wnLigne = 3
.head 5 -  !
.head 5 +  If SalListQuerySelection( cmbTypeHttp ) =0
.head 6 -  Call SalHideWindow ( labHttpsUser )
.head 6 -  Call SalHideWindow ( dfHttpsUser )
.head 6 -  Call SalHideWindow ( labHttpsPwd )
.head 6 -  Call SalHideWindow ( dfHttpsPwd )
.head 6 -  Set dfHttpsCockpit = gsCockpitUrl[ wnLigne]
.head 6 -  Set dfHttpsUp = gsUploadUrl[wnLigne]
.head 6 -  Set dfHttpsDown = gsDownloadUrl[wnLigne]
.head 5 +  Else
.head 6 -  Call SalShowWindow ( labHttpsUser )
.head 6 -  Call SalShowWindow ( dfHttpsUser )
.head 6 -  Call SalShowWindow ( labHttpsPwd )
.head 6 -  Call SalShowWindow ( dfHttpsPwd )
.head 6 -  Set dfHttpsCockpit = gsCockpitUrls[ wnLigne]
.head 6 -  Set dfHttpsUp = gsUploadUrls[wnLigne]
.head 6 -  Set dfHttpsDown = gsDownloadUrls[wnLigne]
.head 6 -  Set dfHttpsUser = gsHttpsLogins[wnLigne]
.head 6 -  Set dfHttpsPwd = gsHttpsPwds[wnLigne]
.head 5 -  Set dfProxy = gsProxyServeur
.head 5 -  Set dfProxyPort = gnProxyPort
.head 5 -  Set dfProxyLogin = gsProxyUser
.head 5 -  Set dfProxyPwd = gsProxyPass
.head 3 -  !
.head 3 +  Function: PalInitTestDirectory
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: lsSource
.head 5 -  Number: lnNumTokens
.head 5 -  String: lsTokenArray[*]
.head 4 +  Actions
.head 5 -  Set dfTestDirectoryFrom = ''
.head 5 -  Set dfTestDirectoryTo = ''
.head 5 -  !
.head 5 -  Set lsSource = SalStrTrimX( dfHttpsUp )
.head 5 +  If SalStrLength( lsSource )
.head 6 -  Set lnNumTokens = SalStrTokenize ( lsSource, '/', '/', lsTokenArray )
.head 6 -  Set dfTestDirectoryFrom = SalStrUpperX ( lsTokenArray[2] )
.head 6 -  Set dfTestDirectoryTo = dfTestDirectoryFrom
.head 6 -  ! XYZ_R <> XYZ
.head 6 +  If SalStrRightX( dfTestDirectoryFrom, 2 ) = '_R'
.head 7 -  Set dfTestDirectoryTo = SalStrLeftX( dfTestDirectoryFrom, SalStrLength( dfTestDirectoryFrom ) - 2 )
.head 6 +  Else If SalStrLength( dfTestDirectoryFrom )
.head 7 -  Set dfTestDirectoryTo = dfTestDirectoryFrom || '_R'
.head 3 +  Function: PalInitCockpitSrvIp
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: lsSource
.head 5 -  Number: lnNumTokens
.head 5 -  String: lsTokenArray[*]
.head 4 +  Actions
.head 5 -  Set dfSrvIpFrom = ''
.head 5 -  Set dfSrvIpTo = ''
.head 5 -  !
.head 5 -  Set lsSource = SalStrTrimX( dfHttpsCockpit )
.head 5 +  If SalStrLength( lsSource )
.head 6 -  Set lnNumTokens = SalStrTokenize ( lsSource, '/', '/', lsTokenArray )
.head 6 -  Set dfSrvIpFrom = SalStrUpperX( lsTokenArray[1] )
.head 6 -  ! A
.head 6 +  If dfSrvIpFrom  = 'SRV4-A'
.head 7 -  Set dfSrvIpTo  = '193.191.221.39'
.head 6 +  Else If dfSrvIpFrom  = '193.191.221.39'
.head 7 -  Set dfSrvIpTo  = 'SRV4-A'
.head 6 -  ! B
.head 6 +  Else If dfSrvIpFrom  = 'SRV4-B'
.head 7 -  Set dfSrvIpTo  = '193.191.221.43'
.head 6 +  Else If dfSrvIpFrom  = '193.191.221.43'
.head 7 -  Set dfSrvIpTo  = 'SRV4-B'
.head 6 -  ! C
.head 6 -  ! << 201b et 301b
.head 6 +  ! Else If ( dfSrvIpFrom  = 'SRV4-C' OR dfSrvIpFrom  = 'COCKPIT.STESUD.BE' )
.head 7 -  Set dfSrvIpTo  = '10.184.10.54'
.head 6 +  ! Else If dfSrvIpFrom  = '10.184.10.54'
.head 7 -  Set dfSrvIpTo  = 'COCKPIT.STESUD.BE'
.head 6 +  Else If ( dfSrvIpFrom  = 'SRV4-C' OR dfSrvIpFrom  = 'COCKPIT.STESUD.BE' OR dfSrvIpFrom  = 'CODICOCKPIT.STESUD.BE' )
.head 7 -  Set dfSrvIpTo  = '10.184.10.54'
.head 6 +  Else If dfSrvIpFrom  = '10.184.10.54'
.head 7 -  Set dfSrvIpTo  = 'CODICOCKPIT.STESUD.BE'
.head 6 -  ! >>
.head 3 +  Function: PalInitUpDown
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: lsSource
.head 5 -  Number: lnNumTokens
.head 5 -  String: lsTokenArray[*]
.head 4 +  Actions
.head 5 -  Set dfUpDownFrom = ''
.head 5 -  Set dfUpDownTo = ''
.head 5 -  !
.head 5 -  Set lsSource = SalStrTrimX( dfHttpsUp )
.head 5 +  If SalStrLength( lsSource )
.head 6 -  Set lnNumTokens = SalStrTokenize ( lsSource, '/', '/', lsTokenArray )
.head 6 -  Set dfUpDownFrom = SalStrUpperX( lsTokenArray[1] )
.head 6 -  ! A
.head 6 +  If dfUpDownFrom  = 'SRV1-A'
.head 7 -  Set dfUpDownTo  = '193.191.221.40'
.head 6 +  Else If dfUpDownFrom  = '193.191.221.40'
.head 7 -  Set dfUpDownTo  = 'SRV1-A'
.head 6 -  ! B
.head 6 +  Else If dfUpDownFrom  = 'SRV1-B'
.head 7 -  Set dfUpDownTo  = '193.191.221.44'
.head 6 +  Else If dfUpDownFrom  = '193.191.221.44'
.head 7 -  Set dfUpDownTo  = 'SRV1-B'
.head 6 -  ! C
.head 6 +  Else If ( dfUpDownFrom  = 'SRV1-C' OR dfUpDownFrom  = 'CODI.STESUD.BE' )
.head 7 -  Set dfUpDownTo  = '10.184.10.51'
.head 6 +  Else If dfUpDownFrom  = '10.184.10.51'
.head 7 -  Set dfUpDownTo  = 'CODI.STESUD.BE'
.head 3 +  Function: PalSetTestDirectory
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: lsSource
.head 5 -  String: lsTmp
.head 5 -  Number: lnNumTokens
.head 5 -  String: lsTokenArray[*]
.head 5 -  Number: lnId
.head 4 +  Actions
.head 5 -  !
.head 5 +  If NOT dfTestDirectoryFrom = dfTestDirectoryTo
.head 6 -  ! Cockpit
.head 6 -  Set lsSource = SalStrTrimX( dfHttpsCockpit )
.head 6 +  If SalStrLength( lsSource )
.head 7 -  Set lnNumTokens = SalStrTokenize ( lsSource, '/', '/', lsTokenArray )
.head 7 -  !
.head 7 -  Set lsTokenArray[2] = SalStrUpperX( lsTokenArray[2] )
.head 7 -  !
.head 7 +  If lsTokenArray[2] = SalStrUpperX( dfTestDirectoryFrom )
.head 8 -  Set lsTokenArray[2] = dfTestDirectoryTo
.head 8 -  Set dfHttpsCockpit = lsTokenArray[0] || '//' || lsTokenArray[1]
.head 8 -  Set lnId = 2
.head 8 +  While lnId < lnNumTokens
.head 9 -  Set dfHttpsCockpit = dfHttpsCockpit || '/' || lsTokenArray[lnId]
.head 9 -  Set lnId = lnId + 1
.head 6 -  ! Upload
.head 6 -  Set lsSource = SalStrTrimX( dfHttpsUp )
.head 6 +  If SalStrLength( lsSource )
.head 7 -  Set lnNumTokens = SalStrTokenize ( lsSource, '/', '/', lsTokenArray )
.head 7 -  !
.head 7 -  Set lsTokenArray[2] = SalStrUpperX( lsTokenArray[2] )
.head 7 -  !
.head 7 +  If lsTokenArray[2] = SalStrUpperX( dfTestDirectoryFrom )
.head 8 -  Set lsTokenArray[2] = dfTestDirectoryTo
.head 8 -  Set dfHttpsUp = lsTokenArray[0] || '//' || lsTokenArray[1]
.head 8 -  Set lnId = 2
.head 8 +  While lnId < lnNumTokens
.head 9 -  Set dfHttpsUp = dfHttpsUp || '/' || lsTokenArray[lnId]
.head 9 -  Set lnId = lnId + 1
.head 6 -  ! Download (idem upload si ce n'est que nous ajoutons un '/' final
.head 6 -  Set lsSource = SalStrTrimX( dfHttpsDown )
.head 6 +  If SalStrLength( lsSource )
.head 7 -  Set lnNumTokens = SalStrTokenize ( lsSource, '/', '/', lsTokenArray )
.head 7 -  !
.head 7 -  Set lsTokenArray[2] = SalStrUpperX( lsTokenArray[2] )
.head 7 -  !
.head 7 +  If lsTokenArray[2] = SalStrUpperX( dfTestDirectoryFrom )
.head 8 -  Set lsTokenArray[2] = dfTestDirectoryTo
.head 8 -  Set dfHttpsDown = lsTokenArray[0] || '//' || lsTokenArray[1]
.head 8 -  Set lnId = 2
.head 8 +  While lnId < lnNumTokens
.head 9 -  Set dfHttpsDown = dfHttpsDown || '/' || lsTokenArray[lnId]
.head 9 -  Set lnId = lnId + 1
.head 8 -  Set dfHttpsDown = dfHttpsDown || '/'
.head 6 -  ! <->
.head 6 -  Set lsTmp = dfTestDirectoryFrom
.head 6 -  Set dfTestDirectoryFrom = dfTestDirectoryTo
.head 6 -  Set dfTestDirectoryTo = lsTmp
.head 5 -  !
.head 5 -  Call PalSaveCurrentValues(  )
.head 5 -  Call PalResetValues(gsCurrentABC, gsHttpType )
.head 3 +  Function: PalSetCockpitSrvIp
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: lsSource
.head 5 -  String: lsTmp
.head 5 -  Number: lnNumTokens
.head 5 -  String: lsTokenArray[*]
.head 5 -  Number: lnId
.head 4 +  Actions
.head 5 -  !
.head 5 +  If NOT dfSrvIpFrom = dfSrvIpTo
.head 6 -  ! Cockpit
.head 6 -  Set lsSource = SalStrTrimX( dfHttpsCockpit )
.head 6 +  If SalStrLength( lsSource )
.head 7 -  Set lnNumTokens = SalStrTokenize ( lsSource, '/', '/', lsTokenArray )
.head 7 -  !
.head 7 -  Set lsTokenArray[1] = SalStrUpperX( lsTokenArray[1] )
.head 7 -  !
.head 7 +  If lsTokenArray[1] = SalStrUpperX( dfSrvIpFrom )
.head 8 -  Set lsTokenArray[1] = dfSrvIpTo
.head 8 -  Set dfHttpsCockpit = lsTokenArray[0] || '//' || lsTokenArray[1]
.head 8 -  Set lnId = 2
.head 8 +  While lnId < lnNumTokens
.head 9 -  Set dfHttpsCockpit = dfHttpsCockpit || '/' || lsTokenArray[lnId]
.head 9 -  Set lnId = lnId + 1
.head 6 -  ! <->
.head 6 -  ! Set lsTmp = dfSrvIpFrom
.head 6 -  ! Set dfSrvIpFrom = dfSrvIpTo
.head 6 -  ! Set dfSrvIpTo = lsTmp
.head 6 -  Call PalInitCockpitSrvIp(  )
.head 5 -  !
.head 5 -  Call PalSaveCurrentValues(  )
.head 5 -  Call PalResetValues(gsCurrentABC, gsHttpType )
.head 3 +  Function: PalSetUpDown
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: lsSource
.head 5 -  String: lsTmp
.head 5 -  Number: lnNumTokens
.head 5 -  String: lsTokenArray[*]
.head 5 -  Number: lnId
.head 4 +  Actions
.head 5 -  !
.head 5 +  If NOT dfUpDownFrom = dfUpDownTo
.head 6 -  ! Upload
.head 6 -  Set lsSource = SalStrTrimX( dfHttpsUp )
.head 6 +  If SalStrLength( lsSource )
.head 7 -  Set lnNumTokens = SalStrTokenize ( lsSource, '/', '/', lsTokenArray )
.head 7 -  !
.head 7 -  Set lsTokenArray[1] = SalStrUpperX( lsTokenArray[1] )
.head 7 -  !
.head 7 +  If lsTokenArray[1] = SalStrUpperX( dfUpDownFrom )
.head 8 -  Set lsTokenArray[1] = dfUpDownTo
.head 8 -  Set dfHttpsUp = lsTokenArray[0] || '//' || lsTokenArray[1]
.head 8 -  Set lnId = 2
.head 8 +  While lnId < lnNumTokens
.head 9 -  Set dfHttpsUp = dfHttpsUp || '/' || lsTokenArray[lnId]
.head 9 -  Set lnId = lnId + 1
.head 6 -  ! Download (idem upload si ce n'est que nous ajoutons un '/' final
.head 6 -  Set lsSource = SalStrTrimX( dfHttpsDown )
.head 6 +  If SalStrLength( lsSource )
.head 7 -  Set lnNumTokens = SalStrTokenize ( lsSource, '/', '/', lsTokenArray )
.head 7 -  !
.head 7 -  Set lsTokenArray[1] = SalStrUpperX( lsTokenArray[1] )
.head 7 -  !
.head 7 +  If lsTokenArray[1] = SalStrUpperX( dfUpDownFrom )
.head 8 -  Set lsTokenArray[1] = dfUpDownTo
.head 8 -  Set dfHttpsDown = lsTokenArray[0] || '//' || lsTokenArray[1]
.head 8 -  Set lnId = 2
.head 8 +  While lnId < lnNumTokens
.head 9 -  Set dfHttpsDown = dfHttpsDown || '/' || lsTokenArray[lnId]
.head 9 -  Set lnId = lnId + 1
.head 8 -  Set dfHttpsDown = dfHttpsDown || '/'
.head 6 -  ! <->
.head 6 -  ! Set lsTmp = dfUpDownFrom
.head 6 -  ! Set dfUpDownFrom = dfUpDownTo
.head 6 -  ! Set dfUpDownTo = lsTmp
.head 6 -  Call PalInitUpDown(  )
.head 5 -  !
.head 5 -  Call PalSaveCurrentValues(  )
.head 5 -  Call PalResetValues(gsCurrentABC, gsHttpType )
.head 3 +  Function: PalResetValues
.head 4 -  Description: lecture fichier .ini
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: psABC
.head 5 -  String: psHttp
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  ! If 1
.head 6 -  Call PalHttpIniRead ( psHttp, psHttp )
.head 6 -  Call PalABCInit (  )
.head 6 -  ! Paramètres ?
.head 6 +  If NOT psABC = ''
.head 7 -  Set gsCurrentABC = psABC
.head 6 +  If NOT psHttp = ''
.head 7 -  Set gsHttpType = psHttp
.head 6 -  ! COMBOS
.head 6 +  If 1
.head 7 -  ! A,B,C
.head 7 +  If gsCurrentABC = 'A'
.head 8 -  Call SalListSetSelect( cmbTypeABC, 0 )
.head 7 +  Else If gsCurrentABC = 'B'
.head 8 -  Call SalListSetSelect( cmbTypeABC, 1 )
.head 7 +  Else If gsCurrentABC = 'C'
.head 8 -  Call SalListSetSelect( cmbTypeABC, 2 )
.head 7 -  ! HTTP / HTTPS
.head 7 +  If gsHttpType = '0'
.head 8 -  Call SalListSetSelect( cmbTypeHttp, 0 )
.head 7 +  Else If gsHttpType = '1'
.head 8 -  Call SalListSetSelect( cmbTypeHttp, 1 )
.head 6 -  ! Reset
.head 6 -  Call PalABCSetUrls()
.head 6 -  ! HTTP
.head 6 -  ! Set dfHttpCockpit = gsCockpitUrl
.head 6 -  ! Set dfHttpUp = gsUploadUrl
.head 6 -  ! Set dfHttpDown = gsDownloadUrl
.head 6 -  ! HTTP(S)
.head 6 -  Set dfHttpsCockpit = gsCockpitUrl
.head 6 -  Set dfHttpsUp = gsUploadUrl
.head 6 -  Set dfHttpsDown = gsDownloadUrl
.head 6 -  !
.head 6 -  Set dfHttpsUser = gsHttpsLogin
.head 6 -  Set dfHttpsPwd = gsHttpsPwd
.head 6 -  !
.head 6 -  Call PalManageHttpsPwd ( )
.head 6 -  ! Proxy
.head 6 -  Set dfProxy = gsProxyServeur
.head 6 -  Set dfProxyPort = gnProxyPort
.head 6 -  Set dfProxyLogin = gsProxyUser
.head 6 -  Set dfProxyPwd = gsProxyPass
.head 6 -  !
.head 6 -  Set dfPartielMode = gsPartielsTransfMode
.head 6 -  Call SalListSetSelect( cmbPartielMode, SalStrToNumber( gsPartielsTransfMode ) )
.head 6 -  Set dfPartielAuto = gsPartielsTransfAuto
.head 6 -  Call SalListSetSelect( cmbPartielAuto, SalStrToNumber( gsPartielsTransfAuto ) )
.head 3 +  Function: PalInterne
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If gbInterne
.head 6 -  Call SalListSetSelect( cmbTypeABC, 2 )
.head 6 -  Call SalSendMsg( cmbTypeABC, SAM_Click, 0, 0 )
.head 2 +  Window Parameters
.head 3 -  String: pwsPathnameIni
.head 2 +  Window Variables
.head 3 -  Number: wnReturn
.head 3 -  String: wsMsgErreur
.head 3 -  Boolean: wbFermetureAutorisee
.head 3 -  String: wsFilename
.head 3 -  String: wsPathname
.head 3 -  Number: wnLigne
.head 3 -  Number: nW
.head 3 -  Number: nH
.head 2 +  Message Actions
.head 3 +  ! On SAM_Close
.head 4 +  If NOT wbFermetureAutorisee
.head 5 -  Return FALSE
.head 3 +  On SAM_Create
.head 4 -  Call SalGetWindowSize( dlgIniFileManager, nW, nH )
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSetWindowText( hWndForm, pwsPathnameIni )
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Set wbFermetureAutorisee = FALSE
.head 4 -  !
.head 4 -  Set gbInterne = SalGetProfileInt( 'HTTP_TYPE', 'HTTP_INTERNE',  0, pwsPathnameIni )
.head 4 -  Set cbInterne = gbInterne
.head 4 -  ! Actif ?
.head 4 -  Set cbHttpActif = gbHttpActif
.head 4 -  !
.head 4 -  ! Combo type http, https
.head 4 -  Call SalListSetSelect( cmbTypeHttp, SalStrToNumber( gsHttpType ) )
.head 4 -  !
.head 4 -  Call PalManageHttpsPwd ( )
.head 4 -  Call PalInitTestDirectory (  )
.head 4 -  Call PalInitCockpitSrvIp (  )
.head 4 -  Call PalInitUpDown (  )
.head 4 -  !
.head 4 -  Call PalInterne ( )
.head 1 +  Dialog Box: dlgPvSignCEI_Test
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Identification
.head 2 -  Accessories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: 5.488"
.head 4 -  Top: 2.021"
.head 4 -  Width:  4.2"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.167"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  Resizable? No
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ok
.head 4 -  Window Location and Size
.head 5 -  Left: 0.483"
.head 5 -  Top: 1.726"
.head 5 -  Width:  1.25"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If sPhoto = '' or sNN = ''
.head 7 +  If gnLanguage = Language_NL
.head 8 -  Call SalMessageBox( "Gelieve uw identiteitskaart indelezer in te brengen ...", "", MB_Ok | MB_IconExclamation )
.head 7 +  Else If gnLanguage = Language_DE
.head 8 -  Call SalMessageBox( "Bitte legen Sie Ihren Ausweis in das Lesegerät ...", "", MB_Ok | MB_IconExclamation )
.head 7 +  Else
.head 8 -  Call SalMessageBox( "Veuillez inserer votre carte d'identité électronique dans le lecteur ...", "", MB_Ok | MB_IconExclamation )
.head 7 -  Return FALSE
.head 6 -  Set wbOk = TRUE
.head 6 -  Set sNom = dfNomUser
.head 6 -  Call SalEndDialog( hWndForm, TRUE )
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Cancel
.head 4 -  Window Location and Size
.head 5 -  Left: 2.433"
.head 5 -  Top: 1.738"
.head 5 -  Width:  1.25"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( hWndForm, FALSE )
.head 3 +  Picture: picUserPW
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 1.333"
.head 5 -  Top: 0.107"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.095"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Size for Best Fit
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: No Border
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Call SalPicSetFile( picUserPW, gsPathApplic || "EID2.jpg" )
.head 6 -  Call SalPicSet( picUserPW, resEID2 , PIC_FormatBitmap )
.head 6 -  Call loStesudEID.SalCreateObjectEID()
.head 3 +  Data Field: dfPlus
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.633"
.head 6 -  Top: 0.381"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 18
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfPlus2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 2.733"
.head 6 -  Top: 0.381"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 18
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfNomUser
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.083"
.head 6 -  Top: 1.31"
.head 6 -  Width:  3.95"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: PalLectureCarte
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If loStesudEID.SalEidInit(  )
.head 6 +  If sPhoto = '' or sPhotoPrec != sPhoto
.head 7 +  If loStesudEID.SalEidReadId()
.head 8 -  Call loStesudEID.SalEidId_NN( sNN )
.head 8 +  If sNNPrec != sNN
.head 9 -  Set sNom = ''
.head 9 -  Call loStesudEID.SalEidId_Nom1Prenom( sNom )
.head 9 -  Set dfNomUser = PalTransUnicodeToStr( sNom )
.head 9 -  Set sNNPrec = sNN
.head 9 -  Set sPhoto = ''
.head 9 +  If loStesudEID.SalEidReadPhoto( sPhoto )
.head 10 +  If sPhoto != ''
.head 11 +  If sPhotoPrec != sPhoto
.head 12 -  Call VisWaitCursor( TRUE )
.head 12 -  Call SalPicSetImage( picUserPW, sPhoto, PIC_ImageTypeJPEG )
.head 12 -  Call VisWaitCursor( FALSE )
.head 12 -  Set sPhotoPrec = sPhoto
.head 12 -  Call SalEnableWindow( pbOk )
.head 11 -  Call SalTimerSet( dlgPvSignCEI_Test, 7, 1000 )
.head 10 +  Else
.head 11 -  Call SalTimerSet( dlgPvSignCEI_Test, 7, 1000 )
.head 9 +  Else
.head 10 -  Call SalTimerSet( dlgPvSignCEI_Test, 7, 1000 )
.head 8 +  Else
.head 9 -  Call SalTimerSet( dlgPvSignCEI_Test, 7, 1000 )
.head 7 +  Else
.head 8 -  Call SalTimerSet( dlgPvSignCEI_Test, 7, 1000 )
.head 6 +  Else
.head 7 -  Call SalTimerSet( dlgPvSignCEI_Test, 7, 1000 )
.head 5 +  Else
.head 6 -  Set sPhoto = ''
.head 6 -  Set sPhotoPrec = ''
.head 6 -  Set sNN = ''
.head 6 -  Set sNNPrec = ''
.head 6 -  Call SalTimerSet( dlgPvSignCEI_Test, 7, 1000 )
.head 3 +  Function: PalTransUnicodeToStr
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: psIn
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: psOut
.head 4 +  Actions
.head 5 -  Set psOut = psIn
.head 5 -  !
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "â¬","" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","À" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","Á" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","Â" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","Ã" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","Ä" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","Å" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","Æ" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","Ç" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","Ç" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","È" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","É" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","Ê" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","Ë" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","Ì" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","Í" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","Î" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","Ï" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","Ð" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","Ñ" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","Ò" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","Ó" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","Ô" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","Õ" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","Ö" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","×" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","Ø" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","Ù" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","Ú" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","Û" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","Ü" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","Ý" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","Þ" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã","ß" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã ","à" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã¡","á" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã¢","â" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã£","ã" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã¤","ä" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã¥","å" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã¦","æ" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã§","ç" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã¨","è" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã©","é" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ãª","ê" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã«","ë" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã¬","ì" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã­","í" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã®","î" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã¯","ï" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã°","ð" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã±","ñ" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã²","ò" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã³","ó" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã´","ô" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ãµ","õ" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã¶","ö" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã·","÷" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã¸","ø" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã¹","ù" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ãº","ú" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã»","û" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã¼","ü" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã½","ý" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã¾","þ" )
.head 5 -  Set psOut = VisStrSubstitute( psOut,  "Ã¿","ÿ" )
.head 5 -  !
.head 5 -  Return ( psOut )
.head 2 +  Window Parameters
.head 3 -  Receive Boolean: wbOk
.head 3 -  Receive String: sNN
.head 3 -  Receive String: sNom
.head 2 +  Window Variables
.head 3 -  FunctionalVar: loStesudEID
.head 4 -  Class: StesudEID
.head 3 -  Long String: sPhoto
.head 3 -  Long String: sPhotoPrec
.head 3 -  Number: wnPassage
.head 3 -  String: sNNPrec
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Set wbOk = FALSE
.head 4 -  Set dfPlus = '>>'
.head 4 -  Set dfPlus2 = '<<'
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalDisableWindow( pbOk )
.head 4 -  Call PalLectureCarte()
.head 3 +  On SAM_Timer
.head 4 -  Call SalTimerKill( dlgPvSignCEI_Test, 7 )
.head 4 -  Set wnPassage = wnPassage + 1
.head 4 +  If sPhoto = ''
.head 5 -  Call SalDisableWindow( pbOk )
.head 5 -  Set dfNomUser = ''
.head 5 +  If SalNumberMod( wnPassage , 2 ) != 0
.head 6 -  ! Call SalPicSetFile( picUserPW, gsPathApplic || "EID.jpg" )
.head 6 -  Call SalPicSet( picUserPW, resEID , PIC_FormatBitmap )
.head 5 +  Else
.head 6 -  ! Call SalPicSetFile( picUserPW, gsPathApplic || "EID2.jpg" )
.head 6 -  Call SalPicSet( picUserPW, resEID2 , PIC_FormatBitmap )
.head 5 +  If SalNumberMod( wnPassage , 2 ) = 0
.head 6 -  Call SalShowWindow( dfPlus )
.head 6 -  Call SalShowWindow( dfPlus2 )
.head 5 +  Else
.head 6 -  Call SalHideWindow( dfPlus )
.head 6 -  Call SalHideWindow( dfPlus2 )
.head 4 +  Else
.head 5 -  Call SalHideWindow( dfPlus )
.head 5 -  Call SalHideWindow( dfPlus2 )
.head 4 -  Call PalLectureCarte()
