.head 0 +  Application Description: Interface d'appel avec la dll fdj_base64

Cette dll réalise un encodage/decodage de fichier au format base64

.data CLASSPROPSSIZE
0000: 5A02
.enddata
.data CLASSPROPS
0000: 5761746368566172 7300FD0166726D44 65636F6465586D6C 2E64665061746800
0020: 66726D4465636F64 65586D6C2E666846 696C650066726D44 65636F6465586D6C
0040: 2E6D6C4461746100 66726D4465636F64 65586D6C2E776173 46696C7465727300
0060: 66726D4465636F64 65586D6C2E776C73 446174610066726D 4465636F6465586D
0080: 6C2E776C73446174 61460066726D4465 636F6465586D6C2E 776C734461746150
00A0: 64660066726D4465 636F6465586D6C2E 776E43686F697800 66726D4465636F64
00C0: 65586D6C2E776E45 7272657572006672 6D4465636F646558 6D6C2E776E4E6578
00E0: 74506F736974696F 6E0066726D446563 6F6465586D6C2E77 6E52657475726E00
0100: 66726D4465636F64 65586D6C2E777342 616C697365006672 6D4465636F646558
0120: 6D6C2E7773457272 6575720066726D44 65636F6465586D6C 2E777346696C6500
0140: 66726D4465636F64 65586D6C2E777346 696C654E616D6546 0066726D4465636F
0160: 6465586D6C2E7773 46696C654E616D65 5064660066726D44 65636F6465586D6C
0180: 2E777346696C654F 75740066726D4465 636F6465586D6C2E 7773506174680066
01A0: 726D4465636F6465 586D6C2E77735061 746846696C654F75 74006C6E44656275
01C0: 74006C6E46696E00 6C6E4C6742616C69 7365006C7346696E 42616C6973650070
01E0: 6C73476C6F62616C 00706E506F736974 696F6E0070734261 6C69736500707342
0200: 616C697365526566 0000557365476C6F 62616C5061746800 0400010000000041
0220: 7070506174684C65 6E00040000000000 0041707050617468 0000000057617463
0240: 68566172734C656E 000400FD01000000 0000000000000000 0000
.enddata
.head 1 -  Outline Version - 4.0.31
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000880000 002C000000020000 0003000000FFFFFF FFFFFFFFFFFCFFFF
0040: FFE9FFFFFFFFFFFF FF000000007C0200 004D010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000
.enddata
.data DT_MAKERUNDLG
0000: 030000000030433A 5C504552534F5C64 6C6C5C66646A5F65 6E7669726F6E6E65
0020: 6D656E745C656E76 69726F6E6E656D65 6E742E6578653043 3A5C504552534F5C
0040: 646C6C5C66646A5F 656E7669726F6E6E 656D656E745C656E 7669726F6E6E656D
0060: 656E742E646C6C30 433A5C504552534F 5C646C6C5C66646A 5F656E7669726F6E
0080: 6E656D656E745C65 6E7669726F6E6E65 6D656E742E617063 010001010130433A
00A0: 5C504552534F5C64 6C6C5C66646A5F65 6E7669726F6E6E65 6D656E745C656E76
00C0: 69726F6E6E656D65 6E742E72756E3043 3A5C504552534F5C 646C6C5C66646A5F
00E0: 656E7669726F6E6E 656D656E745C656E 7669726F6E6E656D 656E742E646C6C30
0100: 433A5C504552534F 5C646C6C5C66646A 5F656E7669726F6E 6E656D656E745C65
0120: 6E7669726F6E6E65 6D656E742E617063 000001010130433A 5C504552534F5C64
0140: 6C6C5C66646A5F65 6E7669726F6E6E65 6D656E745C656E76 69726F6E6E656D65
0160: 6E742E6170643043 3A5C504552534F5C 646C6C5C66646A5F 656E7669726F6E6E
0180: 656D656E745C656E 7669726F6E6E656D 656E742E646C6C30 433A5C504552534F
01A0: 5C646C6C5C66646A 5F656E7669726F6E 6E656D656E745C65 6E7669726F6E6E65
01C0: 6D656E742E617063 000001010130433A 5C504552534F5C64 6C6C5C66646A5F65
01E0: 6E7669726F6E6E65 6D656E745C656E76 69726F6E6E656D65 6E742E61706C3043
0200: 3A5C504552534F5C 646C6C5C66646A5F 656E7669726F6E6E 656D656E745C656E
0220: 7669726F6E6E656D 656E742E646C6C30 433A5C504552534F 5C646C6C5C66646A
0240: 5F656E7669726F6E 6E656D656E745C65 6E7669726F6E6E65 6D656E742E617063
0260: 0100010101
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left: -0.013"
.head 3 -  Top: 0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: D4180909B80B1A00
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left: 4.15"
.head 3 -  Top: 1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left: 0.575"
.head 3 -  Top: 0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left: 6.388"
.head 3 -  Top: 0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  File Include: vtfile.apl
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 2 +  External Functions
.head 3 +  Library name: fdj_base64.dll
.head 4 -  ThreadSafe: No
.head 4 +  Function: fdll_base64
.head 5 -  Description: WORD FDJ_BASE64_API fdll_base64( WORD opt, LPSTR infilename, LPSTR outfilename, WORD linesize )
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: WORD
.head 5 +  Parameters
.head 6 -  Number: WORD
.head 6 -  String: LPSTR
.head 6 -  String: LPSTR
.head 6 -  Number: WORD
.head 4 +  Function: fdll_b64RetourneErreur
.head 5 -  Description: LPSTR	FDJ_BASE64_API fdll_b64RetourneErreur( WORD nCode )
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  String: LPSTR
.head 5 +  Parameters
.head 6 -  Number: WORD
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 4 -  ! !		DEB BASE64.APL
.head 4 -  ! 
	Valeur de retour des fonctions de la dll
	Constantes définies dans fdj_base64.dll
.head 4 -  ! !		FIN BASE64.APL
.head 3 +  User
.head 4 -  ! !		DEB BASE64.APL
.head 4 -  Number: B64_DEF_LINE_SIZE	= 72
.head 4 -  Number: B64_DECODE		= 0
.head 4 -  Number: B64_ENCODE		= 1
.head 4 -  ! !		FIN BASE64.APL
.head 4 -  Number: LG_MAX_XML = 5000000
.head 3 -  Enumerations
.head 2 -  Resources
.head 2 -  Variables
.head 2 +  Internal Functions
.head 3 -  ! !		DEB BASE64.APL
.head 3 -  ! 
	Fonction de travail pour l'interfacage avec la Dll fdj_base64.dll
.head 3 +  Function: f_B64Encode
.head 4 -  Description: encode un fichier en base64
strFileIn		nom du fichier d'entrée
strFileOut		nom du fichier de sortie
nLongLigne	longueur de la ligne avant le retour chariot ( par defaut 72 )
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  String: strFileIn
.head 5 -  String: strFileOut
.head 5 -  Number: nLongLigne
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If nLongLigne = NUMBER_Null or nLongLigne = 0
.head 6 -  Set nLongLigne = B64_DEF_LINE_SIZE
.head 5 -  Return fdll_base64( B64_ENCODE, strFileIn, strFileOut, nLongLigne )
.head 3 +  Function: f_B64Decode
.head 4 -  Description: decode un fichier en base64
strFileIn		nom du fichier d'entrée
strFileOut		nom du fichier de sortie
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  String: strFileIn
.head 5 -  String: strFileOut
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return fdll_base64( B64_DECODE, strFileIn, strFileOut, 0 )
.head 3 +  Function: f_B64Erreur
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Number: nErr
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strMsg
.head 4 +  Actions
.head 5 -  Call SalStrSetBufferLength( strMsg, 100 )
.head 5 -  Return fdll_b64RetourneErreur( nErr )
.head 3 +  ! Function: f_EnvEvalueCheminexemple
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  Number: 
.head 4 +  Parameters 
.head 5 -  Receive String: strCheminAbs
.head 5 -  String: strCheminAEvaluer
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: strTmp
.head 5 -  Number: nRet
.head 4 +  Actions 
.head 5 -  Call SalStrSetBufferLength( strTmp, ENV_MAX_PATH )
.head 5 -  Set nRet = fdll_EnvEvalueChemin( strTmp, strCheminAEvaluer )
.head 5 -  Set strCheminAbs = SalStrLeftX( strTmp, SalStrLength( strTmp ) )
.head 5 -  Return nRet
.head 3 -  ! !		FIN BASE64.APL
.head 3 +  Function: PalFinBalise
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: lsBalise
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return '</' || SalStrRightX( lsBalise, SalStrLength( lsBalise)-1 )
.head 3 +  Function: PalFindDataByBalise
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Long String: plsGlobal
.head 5 -  Receive Number: pnPosition
.head 5 -  String: psBaliseRef
.head 5 -  String: psBalise
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: lnDebut
.head 5 -  Number: lnFin
.head 5 -  Number: lnLgBalise
.head 5 -  String: lsFinBalise
.head 4 +  Actions
.head 5 -  Set lnLgBalise=SalStrLength( psBalise )
.head 5 -  Set lsFinBalise=PalFinBalise(psBalise )
.head 5 -  Set lnDebut = SalStrScan( plsGlobal, psBalise )
.head 5 -  Set lnFin = SalStrScan( plsGlobal,lsFinBalise )
.head 5 +  If lnDebut != -1 and lnFin != -1
.head 6 -  Set pnPosition = lnFin + lnLgBalise + 1
.head 6 -  Return SalStrMidX( plsGlobal, lnDebut+lnLgBalise ,lnFin - (lnDebut+lnLgBalise) )
.head 5 +  Else
.head 6 -  Set pnPosition = 0
.head 6 -  Call SalMessageBox( psBalise || ' ou ' || lsFinBalise|| ' pas trouvé ' ,'Erreur', MB_Ok )
.head 6 -  Return ''
.head 3 +  Function: PalPutFile
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: psFileName
.head 5 -  Long String: plsData
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  File Handle: lfhFile
.head 4 +  Actions
.head 5 -  Call SalFileOpen( lfhFile,psFileName,OF_Create | OF_Write )
.head 5 -  Call SalFileWrite( lfhFile, plsData, SalStrLength( plsData ) )
.head 5 -  Call SalFileClose( lfhFile )
.head 2 -  Named Menus
.head 2 -  Class Definitions
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton:
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control:
.head 3 -  ActiveX: MSComctlLib_TabStrip
.head 2 -  Application Actions
.head 1 +  Form Window: frmCodeBase64
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accessories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  Allow Child Docking? No
.head 3 -  Docking Orientation: All
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left: 2.438"
.head 4 -  Top: 0.604"
.head 4 -  Width:  9.033"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.202"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbEnCode
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Code 64
.head 4 -  Window Location and Size
.head 5 -  Left: 0.5"
.head 5 -  Top: 0.571"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set wsPathFileOut =  dfPath || '.64'
.head 6 +  If SalFileOpen( fhFile,dfPath,OF_Exist )
.head 7 -  Call SalFileOpen( fhFile, wsPathFileOut, OF_Create )
.head 7 -  Call SalFileClose( fhFile )
.head 7 -  Set wnReturn =  f_B64Encode( dfPath, wsPathFileOut, 72 )
.head 7 +  If wnReturn = 0
.head 8 -  Set dfPath =wsPathFileOut
.head 7 +  Else
.head 8 -  Set wsErreur = f_B64Erreur(wnReturn)
.head 8 -  Call SalMessageBox( wsErreur,'Erreur', MB_Ok )
.head 6 +  Else
.head 7 -  Call SalMessageBox( 'Fichier inexistant','Erreur', MB_Ok )
.head 3 +  Pushbutton: pbDeCode
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Decode 64
.head 4 -  Window Location and Size
.head 5 -  Left: 0.5"
.head 5 -  Top: 1.036"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalFileOpen( fhFile,dfPath,OF_Exist )
.head 7 +  If SalStrRightX( dfPath, 3 ) = '.64'
.head 8 -  Set wsPathFileOut =  SalStrLeftX( dfPath, SalStrLength( dfPath)-3 )
.head 8 -  Call SalFileOpen( fhFile, wsPathFileOut, OF_Create )
.head 8 -  Call SalFileClose( fhFile )
.head 8 -  Set wnReturn = f_B64Decode( dfPath,wsPathFileOut)
.head 8 +  If wnReturn = 0
.head 9 -  Set dfPath = wsPathFileOut
.head 8 +  Else
.head 9 -  Set wsErreur = f_B64Erreur(wnReturn)
.head 9 -  Call SalMessageBox( wsErreur,'Erreur', MB_Ok )
.head 7 +  Else
.head 8 -  Call SalMessageBox( 'Nom du fichier incorrect', 'Erreur', MB_Ok )
.head 6 +  Else
.head 7 -  Call SalMessageBox( 'Fichier inexistant','Erreur', MB_Ok )
.head 3 +  Data Field: dfPath
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.9"
.head 6 -  Top: 0.821"
.head 6 -  Width:  5.383"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: dfFind
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Fichier
.head 4 -  Window Location and Size
.head 5 -  Left: 7.5"
.head 5 -  Top: 0.786"
.head 5 -  Width:  0.733"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set wasFilters[0]= 'fichier à convertir'
.head 6 -  Set wasFilters[1]= '*.*'
.head 6 +  If SalDlgOpenFile( hWndForm, 'Recherche d\'un fichier', wasFilters, 2,wnChoix, wsFile,wsPath )
.head 7 -  Set dfPath = wsPath
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: wsFile
.head 3 -  File Handle: fhFile
.head 3 -  String: wsPath
.head 3 -  String: wasFilters[*]
.head 3 -  Number: wnChoix
.head 3 -  Number: wnReturn
.head 3 -  String: wsErreur
.head 3 -  String: wsPathFileOut
.head 2 -  Message Actions
.head 1 +  Form Window: frmDecodeXml
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accessories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  Allow Child Docking? No
.head 3 -  Docking Orientation: All
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left: 0.5"
.head 4 -  Top: 3.635"
.head 4 -  Width:  16.35"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.405"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbDeCode
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Decode xml
.head 4 -  Window Location and Size
.head 5 -  Left: 0.4"
.head 5 -  Top: 0.179"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalFileOpen( fhFile,dfPath,OF_Exist )
.head 7 +  If VisFileGetSize(dfPath) <= LG_MAX_XML
.head 8 +  If SalStrRightX( dfPath, 4 ) = '.X7S'
.head 9 -  Call SalFileOpen( fhFile, dfPath, OF_Read )
.head 9 -  Call SalFileRead( fhFile, wlsData, LG_MAX_XML )
.head 9 -  Call SalFileClose( fhFile )
.head 9 -  Set mlData=wlsData
.head 9 -  Set wsFileNamePdf=PalFindDataByBalise(wlsData,wnNextPosition,'<SignedPV>','<OriginialFileName>') || '.64'
.head 9 -  Set wlsData = SalStrMidX( wlsData, wnNextPosition, LG_MAX_XML )
.head 9 -  Set wlsDataPdf=PalFindDataByBalise(wlsData,wnNextPosition,'<SignedPV>','<Data>')
.head 9 -  Set wlsData = SalStrMidX( wlsData, wnNextPosition, LG_MAX_XML )
.head 9 -  !
.head 9 -  Call PalPutFile(wsFileNamePdf ,wlsDataPdf)
.head 9 -  Set wsFileOut = SalStrLeftX(wsFileNamePdf,SalStrLength( wsFileNamePdf )-3)
.head 9 -  Call SalFileOpen( fhFile,wsFileOut , OF_Create )
.head 9 -  Call SalFileClose( fhFile )
.head 9 -  Set wnReturn = f_B64Decode( wsFileNamePdf,wsFileOut)
.head 9 +  If wnReturn != 0
.head 10 -  Set wsErreur = f_B64Erreur(wnReturn)
.head 10 -  Call SalMessageBox( wsErreur,'Erreur', MB_Ok )
.head 9 -  !
.head 9 -  Set wsFileNameF=PalFindDataByBalise(wlsData,wnNextPosition,'<FormatF>','<OriginialFileName>') || '.64'
.head 9 -  Set wlsData = SalStrMidX( wlsData, wnNextPosition, LG_MAX_XML )
.head 9 -  Set wlsDataF=PalFindDataByBalise(wlsData,wnNextPosition,'<FormatF>','<Data>')
.head 9 -  !
.head 9 -  Call PalPutFile(wsFileNameF ,wlsDataF)
.head 9 -  Set wsFileOut = SalStrLeftX(wsFileNameF,SalStrLength( wsFileNameF )-3)
.head 9 -  Call SalFileOpen( fhFile,wsFileOut , OF_Create )
.head 9 -  Call SalFileClose( fhFile )
.head 9 -  Set wnReturn = f_B64Decode( wsFileNameF,wsFileOut)
.head 9 +  If wnReturn != 0
.head 10 -  Set wsErreur = f_B64Erreur(wnReturn)
.head 10 -  Call SalMessageBox( wsErreur,'Erreur', MB_Ok )
.head 8 +  Else
.head 9 -  Call SalMessageBox( 'Nom du fichier incorrect', 'Erreur', MB_Ok )
.head 7 +  Else
.head 8 -  Call SalMessageBox( 'Taille du fichier > ' || SalNumberToStrX( LG_MAX_XML,0), 'Erreur', MB_Ok )
.head 6 +  Else
.head 7 -  Call SalMessageBox( 'Fichier '|| dfPath || ' inexistant','Erreur', MB_Ok )
.head 3 +  Data Field: dfPath
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.9"
.head 6 -  Top: 0.179"
.head 6 -  Width:  5.383"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: dfFind
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Fichier
.head 4 -  Window Location and Size
.head 5 -  Left: 7.5"
.head 5 -  Top: 0.143"
.head 5 -  Width:  0.733"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set wasFilters[0]= 'fichier x7s'
.head 6 -  Set wasFilters[1]= '*.x7s'
.head 6 +  If SalDlgOpenFile( hWndForm, 'Recherche d\'un fichier', wasFilters, 2,wnChoix, wsFile,wsPath )
.head 7 -  Set dfPath = wsPath
.head 3 +  Multiline Field: mlData
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 500000
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? No
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left: 0.2"
.head 6 -  Top: 0.679"
.head 6 -  Width:  15.733"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.381"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: wsFile
.head 3 -  Number: wnNextPosition
.head 3 -  File Handle: fhFile
.head 3 -  String: wsPath
.head 3 -  String: wasFilters[*]
.head 3 -  Number: wnChoix
.head 3 -  Number: wnReturn
.head 3 -  String: wsErreur
.head 3 -  String: wsPathFileOut
.head 3 -  Long String: wlsData
.head 3 -  String: wsBalise
.head 3 -  String: wsFileNamePdf
.head 3 -  String: wsFileNameF
.head 3 -  Long String: wlsDataPdf
.head 3 -  Long String: wlsDataF
.head 3 -  Number: wnErreur
.head 3 -  String: wsFileOut
.head 2 -  Message Actions
.head 1 +  Form Window: frmCodeXml
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accessories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  Allow Child Docking? No
.head 3 -  Docking Orientation: All
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left: 5.275"
.head 4 -  Top: 4.208"
.head 4 -  Width:  9.767"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 1.845"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbCode
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Code xml
.head 4 -  Window Location and Size
.head 5 -  Left: 0.4"
.head 5 -  Top: 0.429"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalFileOpen( fhFile,dfPathF,OF_Exist ) = FALSE
.head 7 -  Call SalMessageBox( 'Fichier '|| dfPathF || ' inexistant','Erreur', MB_Ok )
.head 7 -  Return FALSE
.head 6 +  If SalFileOpen( fhFile,dfPathPv,OF_Exist ) = FALSE
.head 7 -  Call SalMessageBox( 'Fichier '|| dfPathF || ' inexistant','Erreur', MB_Ok )
.head 7 -  Return FALSE
.head 6 -  Call SalFileOpen( fhFileOut, 'c:\\' || wsFileF || '.X7S', OF_Create | OF_Write )
.head 6 -  ! Debut
.head 6 -  Set wsFile='c:\\xml.1'
.head 6 +  If SalFileOpen( fhFile,wsFile,OF_Read ) = FALSE
.head 7 -  Call SalMessageBox( 'Fichier ' || wsFile || ' inexistant','Erreur', MB_Ok )
.head 6 +  Else
.head 7 -  Call SalFileRead( fhFile, wlsData, LG_MAX_XML )
.head 7 -  Call SalFileClose( fhFile )
.head 7 -  Call SalFileWrite( fhFileOut, wlsData, SalStrLength( wlsData ) )
.head 7 -  ! Nom PV
.head 7 -  Set wlsData = wsFilePv
.head 7 -  Call SalFileWrite( fhFileOut, wlsData, SalStrLength( wlsData ) )
.head 7 -  ! Suite 1
.head 7 -  Set wsFile='c:\\xml.2'
.head 7 +  If SalFileOpen( fhFile,wsFile,OF_Read ) = FALSE
.head 8 -  Call SalMessageBox( 'Fichier ' || wsFile || ' inexistant','Erreur', MB_Ok )
.head 7 +  Else
.head 8 -  Call SalFileRead( fhFile, wlsData, LG_MAX_XML )
.head 8 -  Call SalFileClose( fhFile )
.head 8 -  Call SalFileWrite( fhFileOut, wlsData, SalStrLength( wlsData ) )
.head 8 -  ! ENCODE PV
.head 8 -  Set wsPathFileOut =  dfPathPv || '.64'
.head 8 +  If SalFileOpen( fhFile,dfPathPv,OF_Exist ) = FALSE
.head 9 -  Call SalMessageBox( 'Fichier inexistant','Erreur', MB_Ok )
.head 8 +  Else
.head 9 -  Call SalFileOpen( fhFile, wsPathFileOut, OF_Create )
.head 9 -  Call SalFileClose( fhFile )
.head 9 -  Set wnReturn =  f_B64Encode( dfPathPv, wsPathFileOut, 72 )
.head 9 -  ! PV
.head 9 +  If wnReturn != 0
.head 10 -  Set wsErreur = f_B64Erreur(wnReturn)
.head 10 -  Call SalMessageBox( wsErreur,'Erreur', MB_Ok )
.head 9 +  Else
.head 10 -  Set wsFile=wsPathFileOut
.head 10 +  If SalFileOpen( fhFile,wsFile,OF_Read ) = FALSE
.head 11 -  Call SalMessageBox( 'Fichier ' || wsFile || ' inexistant','Erreur', MB_Ok )
.head 10 +  Else
.head 11 -  Call SalFileRead( fhFile, wlsData, LG_MAX_XML )
.head 11 -  Call SalFileClose( fhFile )
.head 11 -  Call SalFileWrite( fhFileOut, wlsData, SalStrLength( wlsData ) )
.head 11 -  !
.head 11 -  ! Suite 2
.head 11 -  Set wsFile='c:\\xml.3'
.head 11 +  If SalFileOpen( fhFile,wsFile,OF_Read ) = FALSE
.head 12 -  Call SalMessageBox( 'Fichier ' || wsFile || ' inexistant','Erreur', MB_Ok )
.head 11 +  Else
.head 12 -  Call SalFileRead( fhFile, wlsData, LG_MAX_XML )
.head 12 -  Call SalFileClose( fhFile )
.head 12 -  Call SalFileWrite( fhFileOut, wlsData, SalStrLength( wlsData ) )
.head 12 -  ! Nom Format F
.head 12 -  Set wlsData = wsFileF
.head 12 -  Call SalFileWrite( fhFileOut, wlsData, SalStrLength( wlsData ) )
.head 12 -  !
.head 12 -  ! Suite 3
.head 12 -  Set wsFile='c:\\xml.4'
.head 12 +  If SalFileOpen( fhFile,wsFile,OF_Read ) = FALSE
.head 13 -  Call SalMessageBox( 'Fichier ' || wsFile || ' inexistant','Erreur', MB_Ok )
.head 12 +  Else
.head 13 -  Call SalFileRead( fhFile, wlsData, LG_MAX_XML )
.head 13 -  Call SalFileClose( fhFile )
.head 13 -  Call SalFileWrite( fhFileOut, wlsData, SalStrLength( wlsData ) )
.head 13 -  ! ENCODE FORMAT F
.head 13 -  Set wsPathFileOut =  dfPathF || '.64'
.head 13 +  If SalFileOpen( fhFile,dfPathF,OF_Exist ) = FALSE
.head 14 -  Call SalMessageBox( 'Fichier inexistant','Erreur', MB_Ok )
.head 13 +  Else
.head 14 -  Call SalFileOpen( fhFile, wsPathFileOut, OF_Create )
.head 14 -  Call SalFileClose( fhFile )
.head 14 -  Set wnReturn =  f_B64Encode( dfPathF, wsPathFileOut, 72 )
.head 14 -  ! PV
.head 14 +  If wnReturn != 0
.head 15 -  Set wsErreur = f_B64Erreur(wnReturn)
.head 15 -  Call SalMessageBox( wsErreur,'Erreur', MB_Ok )
.head 14 +  Else
.head 15 -  Set wsFile=wsPathFileOut
.head 15 +  If SalFileOpen( fhFile,wsFile,OF_Read ) = FALSE
.head 16 -  Call SalMessageBox( 'Fichier ' || wsFile || ' inexistant','Erreur', MB_Ok )
.head 15 +  Else
.head 16 -  Call SalFileRead( fhFile, wlsData, LG_MAX_XML )
.head 16 -  Call SalFileClose( fhFile )
.head 16 -  Call SalFileWrite( fhFileOut, wlsData, SalStrLength( wlsData ) )
.head 16 -  !
.head 16 -  ! FIN
.head 16 -  Set wsFile='c:\\xml.5'
.head 16 +  If SalFileOpen( fhFile,wsFile,OF_Read ) = FALSE
.head 17 -  Call SalMessageBox( 'Fichier ' || wsFile || ' inexistant','Erreur', MB_Ok )
.head 16 +  Else
.head 17 -  Call SalFileRead( fhFile, wlsData, LG_MAX_XML )
.head 17 -  Call SalFileClose( fhFile )
.head 17 -  Call SalFileWrite( fhFileOut, wlsData, SalStrLength( wlsData ) )
.head 8 -  !
.head 6 -  Call SalFileClose( fhFileOut )
.head 3 -  ! PV
.head 3 +  Data Field: dfPathPv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 2.017"
.head 6 -  Top: 0.226"
.head 6 -  Width:  5.383"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: dfFindPv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: PV
.head 4 -  Window Location and Size
.head 5 -  Left: 7.567"
.head 5 -  Top: 0.226"
.head 5 -  Width:  0.933"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set wasFilters[0]= 'Pv (pdf)'
.head 6 -  Set wasFilters[1]= '*.pdf'
.head 6 +  If SalDlgOpenFile( hWndForm, 'Recherche d\'un fichier', wasFilters, 2,wnChoix, wsFilePv,wsPath )
.head 7 -  Set dfPathPv = wsPath
.head 3 -  ! Format F
.head 3 +  Data Field: dfPathF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 2.05"
.head 6 -  Top: 0.679"
.head 6 -  Width:  5.383"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: dfFindF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Fichier F
.head 4 -  Window Location and Size
.head 5 -  Left: 7.6"
.head 5 -  Top: 0.643"
.head 5 -  Width:  0.933"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set wasFilters[0]= 'fichier format F Chambre (.ck)'
.head 6 -  Set wasFilters[1]= '*.ck'
.head 6 -  Set wasFilters[2]= 'fichier format F Sénat (.se)'
.head 6 -  Set wasFilters[3]= '*.se'
.head 6 +  If SalDlgOpenFile( hWndForm, 'Recherche d\'un fichier', wasFilters, 4,wnChoix, wsFileF,wsPath )
.head 7 -  Set dfPathF = wsPath
.head 3 -  !
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: wsFile
.head 3 -  String: wsFileF
.head 3 -  String: wsFilePv
.head 3 -  Number: wnNextPosition
.head 3 -  File Handle: fhFile
.head 3 -  File Handle: fhFileOut
.head 3 -  String: wsPath
.head 3 -  String: wasFilters[*]
.head 3 -  Number: wnChoix
.head 3 -  Number: wnReturn
.head 3 -  String: wsErreur
.head 3 -  String: wsPathFileOut
.head 3 -  Long String: wlsData
.head 3 -  String: wsBalise
.head 3 -  String: wsFileNamePdf
.head 3 -  String: wsFileNameF
.head 3 -  Long String: wlsDataPdf
.head 3 -  Long String: wlsDataF
.head 3 -  Number: wnErreur
.head 3 -  String: wsFileOut
.head 2 -  Message Actions
